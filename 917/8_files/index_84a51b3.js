define("lego_modules/imweb-qjs/2.0.0/index",function(t,e,n){!function(i,s){"object"==typeof e&&"object"==typeof n?n.exports=s(t("jquery")):"function"==typeof define&&define.amd?define(["jquery"],s):"object"==typeof e?e.Q=s(t("jquery")):i.Q=s(i.jQuery)}(this,function(t){return function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var i=n(1),s=n(3),r=n(5);s.extend(i,s),t.exports=r(i)},function(t,e,n){function i(t,e){for(var n,i=0,s=a.length;s>i;i++)if(n="q-"+a[i],t.hasAttribute&&t.hasAttribute(n))return e.push({name:n,value:t.getAttribute(n)}),t.removeAttribute(n),!0}function s(t,e,n){n=n||{};var r,o,a,h,l,u;for(r=0;h=t[r++];){if(1===h.nodeType){if(l=h.attributes,u=[],!i(h,u,n))for(o=0,a=l.length;a>o;o++)0===l[o].name.indexOf("q-")&&u.push({name:l[o].name,value:l[o].value});u.length>0&&e(h,u,n)}h.childNodes.length&&!n.stop&&s(c.call(h.childNodes,0),e,n),n.stop=!1}}var r=function(){},o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||setTimeout,a=(new(n(2))(1e3),["vm","repeat","if"]),h=[].slice,c=function(){try{return h.call(document.body.childNodes),h}catch(t){return function(t){t=t||0;for(var e=[],n=this.length;n>t;t++)e.push(this[t]);return e}}}();t.exports={slice:c,noop:r,addClass:function(t,e){if(t.classList)t.classList.add(e);else{var n=" "+(t.getAttribute("class")||"")+" ";n.indexOf(" "+e+" ")<0&&t.setAttribute("class",(n+e).trim())}},removeClass:function(t,e){if(t.classList)t.classList.remove(e);else{for(var n=" "+(t.getAttribute("class")||"")+" ",i=" "+e+" ";n.indexOf(i)>=0;)n=n.replace(i," ");t.setAttribute("class",n.trim())}},noexist:function(t,e){throw this.warn(t),new Error("Filter "+e+" hasn't implemented.")},warn:function(){return window.console&&console.error?function(){console.error.apply(console,arguments)}:r}(),isObject:function(t){return"object"==typeof t},nextTick:function(t,e){return e?o(function(){t.call(e)},0):o(t,0)},get:function(t,e){var n=[];return t&&n.push(t),e&&n.push(e),n.join(".").replace(/^(.+\.)?\$top\./,"")},walk:s}},function(t){function e(t){this.size=0,this.limit=t,this.head=this.tail=void 0,this._keymap={}}var n=e.prototype;n.put=function(t,e){var n={key:t,value:e};return this._keymap[t]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit?this.shift():void this.size++},n.shift=function(){var t=this.head;return t&&(this.head=this.head.newer,this.head.older=void 0,t.newer=t.older=void 0,this._keymap[t.key]=void 0),t},n.get=function(t,e){var n=this._keymap[t];if(void 0!==n)return n===this.tail?e?n:n.value:(n.newer&&(n===this.head&&(this.head=n.newer),n.newer.older=n.older),n.older&&(n.older.newer=n.newer),n.newer=void 0,n.older=this.tail,this.tail&&(this.tail.newer=n),this.tail=n,e?n:n.value)},t.exports=e},function(t,e,n){var i=n(4);t.exports={find:i.find,contains:i.contains,data:i.data,cleanData:i.cleanData,add:i.event.add,remove:i.event.remove,clone:i.clone,extend:i.extend}},function(e){e.exports=t},function(t,e,n){t.exports=function(t){function e(e){return t.contains(h.documentElement,e)}function i(t){this._init(t)}var s=n(8),r=n(9),o=n(7).mergeOptions,a=n(6),h=document;return i._=t,i.options={directives:n(10),filters:{}},i.get=function(e){var n=t.find(e)[0];return n?t.data(n,"QI"):new this({el:e})},i.all=function(e){var n=this;return t.find(e.el).map(function(i){return new n(t.extend(e,{el:i}))})},t.extend(i,a),t.extend(i.prototype,{_init:function(e){e=e||{},this.$el=e.el&&"string"==typeof e.el?t.find(e.el)[0]:e.el,this.$$={},this.$parent=e._parent,e=this.$options=o(this.constructor.options,e,this),this._isCompiled=!1,this._isAttached=!1,this._isReady=!1,this._events={},this._watchers={},this._children=[],this.$={},s.call(this,e),this._initScope(),this._callHook("created"),this.$el&&(t.data(this.$el,"QI",this),this.$mount(this.$el))},$on:function(t,e){return(this._events[t]||(this._events[t]=[])).push(e),this},$once:function(t,e){function n(){i.$off(t,n),e.apply(this,arguments)}var i=this;return n.fn=e,this.$on(t,n),this},$off:function(t,e){var n,i,s;if(!arguments.length)return this._events={},this;if(n=this._events[t],!n)return this;if(1===arguments.length)return this._events[t]=null,this;for(s=n.length;s--;)if(i=n[s],i===e||i.fn===e){n.splice(s,1);break}return this},$watch:function(t,e,n,i){var s=n?t+"**deep**":t;return(this._watchers[s]||(this._watchers[s]=[])).push(e),i&&e(this.data(t)),this},$emit:function(e){var n=t.slice.call(arguments,1);return r.emit.call(this,e,t.slice.call(n,0)),e.indexOf("data:")||(e=e.substring(5),r.callChange.call(this,e,t.slice.call(n,0))),e.indexOf("deep:")||(e=e.substring(5),r.callDeep.call(this,e,t.slice.call(n,0)),n.unshift(e),r.emit.call(this,"datachange",n)),this},_initScope:function(){this._initMethods()},_initMethods:function(){var t,e=this.$options.methods;if(e)for(t in e)this[t]=e[t].bind(this)},$mount:function(n){return this._isCompiled?t.warn("$mount() should be called only once"):(this._compile(n),this._isCompiled=!0,this._callHook("compiled"),void(e(this.$el)?(this._callHook("attached"),this._ready()):this.$once("hook:attached",this._ready)))},_ready:function(){this._isAttached=!0,this._isReady=!0,this._callHook("ready")},_compile:function(t){this.transclue(t,this.$options)},transclue:function(t,e){this._templateBind(t,e)},_templateBind:n(12),_callHook:function(t){var e=this.$options[t];if(e)for(var n=0,i=e.length;i>n;n++)e[n].call(this);this.$emit("hook:"+t)},_makeReadFilters:function(e,n){if(!e.length)return[];var i=this.$options.filters,s=this;return e.map(function(e){e=t.slice.call(e,0);var r=e.shift(),o=i[r]?i[r].read||i[r]:t.noexist(s,r);return function(t,i){var r=[t].concat(e||[]),a=r.indexOf("$this");return r.push(i),~a&&(r[a]=n),e?o.apply(s,r):o.call(s,t,i)}})},applyFilters:function(t,e,n){if(!e||!e.length)return t;for(var i=0,s=e.length;s>i;i++)t=e[i].call(this,t,n);return t}}),t.extend(i.prototype,s.prototype),i}},function(t,e,n){function i(t,e){if(h[t])return!1;var n=h[t]=this.extend(e||{});return n}function s(t){return h[t]||this}function r(t){function e(){}return e.prototype=t,new e}function o(t){t=t||{};var e=this,n=a(t.name||"QComponent");return n.prototype=r(e.prototype),n.prototype.constructor=n,n.options=c(e.options,t),n["super"]=e,["extend","get","all","require","define"].forEach(function(t){n[t]=e[t]}),n}function a(t){return new Function("return function "+t+" (options) { this._init(options) }")()}var h={},c=n(7).mergeOptions;t.exports={define:i,require:s,extend:o}},function(t,e,n){function i(t,e,n){function i(i){var s=r[i]||o;a[i]=s(t[i],e[i],n,i)}var s,a={};for(s in t)i(s);for(s in e)t.hasOwnProperty(s)||i(s);return a}var s=n(1),r={};r.created=r.ready=r.attached=r.detached=r.compiled=r.beforeDestroy=r.destroyed=r.paramAttributes=function(t,e){return e?t?t.concat(e):Array.isArray(e)?e:[e]:t},r.data=r.filters=r.methods=r.directives=function(t,e){return e?t?s.extend({},t,e):e:t};var o=function(t,e){return void 0===e?t:e};t.exports={strats:r,mergeOptions:i}},function(t,e,n){function i(t,e,n,i){var r=t._top,h=s(n),c={data:n,up:t,top:r,namespace:e+"",trigger:h?!1:i},l=r.data?r.data(t.$namespace(e)):void 0;"object"==typeof n&&null!==n?(t[e]=h?new a(c):new o(c),i&&t.$change(t.$namespace(e),t[e],l)):l!==n&&(t[e]=n,i&&t.$change(t.$namespace(e),n,l)),~t._keys.indexOf(e)||t._keys.push(e)}function s(t){return Array.isArray(t)||t instanceof a}function r(t){return t.filter(function(t){return"number"==typeof t}).length}function o(t){var e=t.data,n=Object.keys(t.data||{}).filter(function(t){return 0!==t.indexOf("_")}).map(function(t){return+t+""===t?+t:t}),o=this;c.extend(this,e),this._keys=n,this._up=t.up,this._top=t.top||this,this._namespace=t.namespace||"",n.forEach(function(n){i(o,n,e[n],t.trigger)}),s(e)&&(this.length=r(n))}function a(t){o.call(this,t)}function h(t){o.call(this,t)}var c=n(1);c.extend(o.prototype,{$namespace:function(t){for(var e=[],n=this;void 0!=n;n=n._up)n._namespace&&e.unshift(n._namespace);return t&&e.push(t),e.join(".")},$key:function(){var t=this._namespace;return+t+""===t?+t:t},$up:function(t){t=t||1;for(var e=this;t--;)e=e._up;return e},$set:function(t,e){if("object"==typeof t){var n=this;Object.keys(t).filter(function(t){return 0!==t.indexOf("_")}).forEach(function(e){i(n,e,t[e],!0)}),this.$change(this.$namespace(t),this,void 0,1)}else{var s=this[t];i(this,t,e,!0),this.$change(this.$namespace(t),this[t],s,void 0,-1)}return this},$get:function(){var t,e=this._keys,n=this;return t=this instanceof o?{}:[],e.forEach(function(e){t[e]=null==n[e]?n[e]:n[e].$get?n[e].$get():n[e]}),t},$change:function(t,e,n,i,s){s=s||0;var r=this._top;r.$emit&&(~s&&this._top.$emit("data:"+t,e,n,i),s&&this._top.$emit("deep:"+t,e,n,i))}}),c.extend(a.prototype,o.prototype,{push:function(t){t=c.slice.call(arguments,0);for(var e=[],n=0,s=t.length;s>n;n++)i(this,this.length,t[n]),this._keys.push(this.length),e.push(this[this.length]),this.length++;return this.$change(this.$namespace(),this,null,{method:"push",res:e,args:t},1),this},pop:function(){var t=this[--this.length];return delete this[this.length],this._keys.pop(),this.$change(this.$namespace(),this,null,void 0,1),t},unshift:function(t){this._keys.push(this.length),this.length++;for(var e=this.length;e--;)this[e]=this[e-1],"object"==typeof this[e]&&(this[e]._namespace=e+"");return i(this,0,t),this.$change(this.$namespace(),this,null,void 0,1),this},shift:function(){this.length--;for(var t=this[0],e=0,n=this.length;n>e;e++)this[e]=this[e+1],"object"==typeof this[e]&&(this[e]._namespace=e+"");return this._keys.pop(),delete this[this.length],this.$change(this.$namespace(),this,null,void 0,1),t},touch:function(t){this.$change(this.$namespace(t),this,null,void 0,1)},indexOf:function(t){if(t._up===this){var e=+t._namespace;if(this[e]===t)return e}else if("object"!=typeof t)for(var e=0,n=this.length;n>e;e++)if(this[e]===t)return e;return-1},splice:function(t,e){for(var n={method:"splice",args:[t,e]},i=0,s=e+t,r=this.length-e;r>t;t++,i++)this[t]=this[s+i],"object"==typeof this[t]&&(this[t]._namespace=t+"");for(;t<this.length;t++)this[t]=null,delete this[t];this.length-=e,this._keys.splice(this.length,e),this.$change(this.$namespace(),this,null,n,1)},forEach:function(t){for(var e=0,n=this.length;n>e;e++)t(this[e],e)},filter:function(t){var e=[];return this.forEach(function(n){t(n)&&e.push(n)}),e}}),c.extend(h,{Data:o,DataArray:a}),c.extend(h.prototype,o.prototype,{data:function(t,e){if(void 0===t)return this;var n,s,r=0,o=this;if(~t.indexOf(".")){var a=t.split(".");for(n=a.length;n-1>r;r++)if(t=a[r],+t+""===t&&(t=+t),o&&t in o&&null!=o[t])o=o[t];else{if(void 0===e)return void 0;s=a[r+1],+s+""==s?i(o,t,[],!0):i(o,t,{},!0)}}return n&&(t=a[r]),void 0===e?o&&t?o[t]:o:(o.$set(t,e),o[t])}}),t.exports=h},function(t,e,n){function i(t,e,n){n=n||this;var s=this._events[t];if(s){var r=0;s=s.length>1?o.slice.call(s,0):s;for(var a=s.length;a>r;r++)s[r].apply(n,e)}t.indexOf("data:")&&t.indexOf("hook:")&&t.indexOf("deep:")&&this.$parent&&i.call(this.$parent,t,e,n)}function s(t,e){var n={_events:this._watchers};i.call(n,t,e),i.call(n,t+"**deep**",e)}function r(t){var e,n=t.split("."),s={_events:this._watchers};for(n.pop();n.length>0;n.pop())t=n.join("."),e=t+"**deep**",i.call(s,e,[this.data(t)]);i.call(s,"**deep**",[this])}var o=(n(8),n(1));t.exports={emit:i,callChange:s,callDeep:r}},function(t,e,n){{var i=n(1);n(7)}t.exports={show:function(t){var e=this.el;if(t){e.style.display="";var n=e.currentStyle?e.currentStyle.display:getComputedStyle(e,null).display;"none"===n&&(e.style.display="block")}else e.style.display="none"},"class":function(t){var e=this.el,n=this.arg;n?t?i.addClass(e,n):i.removeClass(e,n):(this.lastVal&&i.removeClass(e,this.lastVal),t&&(i.addClass(e,t),this.lastVal=t))},value:function(t){var e=this.el;"checkbox"===e.type?e.checked=t:e.value=t},attr:function(t){if(void 0!==t){var e=this.arg,n=this.el;if("style"===e)if("object"==typeof t)for(var i in t)t.hasOwnProperty(i)&&(n.style[i]=t[i]);else n.setAttribute(e,t);else e in n?n[e]=t:n.setAttribute(e,t)}},text:function(t){var e;void 0!==t&&(e="string"==typeof this.el.textContent?"textContent":"innerText")&&(this.el[e]=null==t?"":t.toString())},html:function(t){this.el.innerHTML=t&&t.toString()||""},on:{bind:function(){var t=this,e=this.target,n=this.param,s=this.filters,r=this.vm,o=r.applyFilters(this.vm[e],s),a=n&&~n.indexOf("this")&&t.data();i.add(this.el,this.arg,function(t){if(!o||"function"!=typeof o)return i.warn("You need implement the "+e+" method.");var s=[];n?n.forEach(function(e){"e"===e?s.push(t):"this"===e&&s.push(a)}):s.push(t),o.apply(r,s)})}},model:{bind:function(){var t=((this.namespace||"")+this.target).split("."),e=t.pop(),n=t.join("."),s=this.el,r=this.vm,o=r.data(n),a=!1;i.add(s,"input propertychange change",function(){a||o.$set(e,s.value)}),i.add(s,"compositionstart",function(){a=!0}),i.add(s,"compositionend",function(){a=!1})},update:function(t){this.el.value=t}},vm:{bind:function(){this.setting.stop=!0;var t,e,n=this.target,i=this.vm,s=this.el,r=s.getAttribute("q-ref")||!1,o=i.constructor.require(n),a=o.options.data;t={el:s,data:a,_parent:i},e=new o(t),i._children.push(e),r&&!function(){var t=i.$[r];t?t.length?t.push(e):i.$[r]=[t,e]:i.$[r]=e}()}},"if":{bind:function(){function t(t){!r&&o&&t&&(r=!0,f._templateBind(e,{data:u,namespace:h,immediate:!0}))}if(this.el.parentNode){var e=this.el,n=e.parentNode,s=document.createComment("q-if"),r=!1,o=!0,a=this.target,h=this.namespace,c=i.get(h,a),l=this.filters,u=this.data(),f=this.vm;this.setting.stop=!0,f.$watch(c,function(i,r){i=f.applyFilters(i,l,r),t(i),i!==o&&(i===!0?(11!==n.nodeType&&n.replaceChild(e,s),o=i):i===!1&&(11!==n.nodeType&&n.replaceChild(s,e),o=i),t(i))},!1,!0)}}},el:{bind:function(){this.vm.$$[this.target]=this.el}},repeat:n(11)}},function(t,e,n){function i(t,e,n,i){var s,r,o,a,h=e.length;Object.keys(t).forEach(function(c){~c.indexOf(e)&&(s=c.substring(h+1),r=s.split("."),r.length&&(o=+r.shift(),(o-=i)>=n&&(r.unshift(o),r.unshift(e),a=r.join("."),t[a]=t[c],delete t[c])))})}var s=n(1);methods={"default":{clean:function(t,e){e.length&&(e.forEach(function(e){e.parentNode===t&&t.removeChild(e)}),s.cleanData(e),e.length=0)},insert:function(t,e,n){t.insertBefore(e,n)}},push:{insert:function(t,e,n){t.insertBefore(e,n)},dp:function(t,e){return e.res}},splice:{clean:function(t,e,n,s){var r=n[0],o=n[1],a=n[2].$namespace(),h=e.splice(r,o);return h.forEach(function(e){t.removeChild(e)}),n.done||(i(s,a,r,o),n.done=!0),!0},dp:function(t,e){return e.args.push(t),e.args}}},e.bind=function(){var t,e,n,i,r,o,a,h=this.el,c=this.setting,l=h.parentNode;l&&!c.stop&&(c.stop=!0,t=this.target,e=this.namespace,n=s.get(e,t),i=this.filters,r=[],o=document.createComment("q-repeat"),a=this.vm,l.replaceChild(o,h),a.$watch(n,function(t,e,c){if(t=a.applyFilters(t,i),null!=t){var u=!i.length&&c?c.method:"default",f=(methods[u]||{}).dp,p=(methods[u]||{}).clean,d=(methods[u]||{}).insert;if(f&&(t=f(t,c)),!p||p(l,r,t,a._watchers,n)!==!0){var v,m=document.createDocumentFragment();t.forEach(function(t){v=s.clone(h),a._templateBind(v,{data:t,namespace:t.$namespace(),immediate:!0}),r.push(v),m.appendChild(v)}),d&&d(l,m,o),a.$emit("repeat-render")}}},!1,!0))}},function(t,e,n){var i=n(13),s=n(1);t.exports=function(t,e){e=e||{};var n=this,r=n.$options.directives,o=(e.index,e.data||n,e.namespace);s.walk([t],function(t,a,h){a.forEach(function(a){var c=a.name.substring(2),l=r[c],u=i(a.value);l&&u.forEach(function(i){var r=n._makeReadFilters(i.filters,n.data(o)),a=i.target,c=s.get(o,a),u=s.isObject(l)?l.update:l,f=s.extend({el:t,vm:n,data:function(t){return n.data(s.get(o,t))},namespace:o,setting:h},i,{filters:r}),p=f.data(a);u&&n.$watch(c,function(t,e){t=n.applyFilters(t,r,e),u.call(f,t,e)},"object"==typeof p,"boolean"==typeof e.immediate?e.immediate:void 0!==p),s.isObject(l)&&l.bind&&l.bind.call(f)})})})}},function(t,e,n){function i(t){var e=t,n=r.get(e);if(n)return n;for(var i,h,c,l=[],u=o.length,f=!1,p={filter:!1,token:{filters:[]}};t.length;){for(h=0;u>h;h++)if(i=o[h][0].exec(t)){f=!0,c=o[h][1],c&&c(i,p,l),t=t.replace(o[h][0],""),p.filter&&(i=a.exec(t),s(i[0].trim(),p.token),t=t.replace(a,""),p.filter=!1);break}if(!f)throw new Error("Syntax error at: "+t);f=!1}return l.push(p.token),r.put(e,l),l}function s(t,e){for(var n,i=h.length,s=!1;t.length;){for(n=0;i>n;n++)if(captures=h[n][0].exec(t)){s=!0,foo=h[n][1],foo&&foo(captures,e.filters),t=t.replace(h[n][0],"");break}if(!s)throw new Error("Syntax error at: "+t);s=!1}}var r=new(n(2))(1e3),o=[[/^ +/],[/^([\w\-]+):/,function(t,e){e.token.arg=t[1]}],[/^([\w]+)\((.+?)\)/,function(t,e){e.token.target=t[1],e.token.param=t[2].split(/ *, */)}],[/^([\w\-\.\$]+)/,function(t,e){e.token.target=t[1]}],[/^(?=\|)/,function(t,e){e.filter=!0}],[/^,/,function(t,e,n){n.push(e.token),e.token={filters:[]}}]],a=/^(.+?)(?=,|$)/,h=[[/^ +/],[/^\| *([\w\-\!]+)/,function(t,e){e.push([t[1]])}],[/^(['"])(((\\['"])?([^\1])*)+)\1/,function(t,e){e[e.length-1].push(t[3])}],[/^([\w\-\$]+)/,function(t,e){e[e.length-1].push(t[1])}]];t.exports=i}])})});
define("lego_modules/imweb-base-qjs/0.1.1/src/controller",function(t,n,i){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var o=t("lego_modules/imweb-qjs/2.0.0/index"),r=o._,s=function(){var n=!1;return{_initSingle:function(t,n){return n.el=t,o.all(n)},init:function(){var i=this;if(!n){n=!0;var e,r=window._components||{};for(var s in r)r.hasOwnProperty(s)&&(e=r[s],e.module=t(e.js),o.define(s,e.module));for(var s in r)r.hasOwnProperty(s)&&(e=r[s],e.child&&(e.module.init?e.module.init():i._initSingle(".component-"+e.uid,e.module)))}}}}(),f=function(){function t(t,n){return void 0===n?e[t]:void(e[t]=n)}function n(t,n){return t="string"==typeof t?r.find(t)[0]:t,r.data(t,"third-inst",n)}function i(t,i,e){t="string"==typeof t?r.find(t)[0]:t,this.el=t,this.vm=e||new o,r.extend(this,i),n(t,this),this.bind()}var e={};return r.extend(i,{key:t,get:n}),i}(),h=function(){function t(){e(this,t)}return t.prototype._init=function(t){this.COMPONENTREG=/([^.]*)(\.([^.]*))*/,this.REFREG=/^[A-Za-z]+$/,this.model=t,s.init(),this._refreshComponents(),this._refreshThirdComponents(),this._bindEvent&&this._bindEvent(),this.report&&r.nextTick(function(){this.report._init(this)},this)},t.prototype._bindEvent=function(){},t.prototype._refreshComponents=function(){var t=this,n=this.components;n&&Object.keys(n).forEach(function(i){var e=n[i].match(t.REFREG);if(e)t[i]=t.model.$[e[0]];else if(e=n[i].match(t.COMPONENTREG)){var r=o.get(e[1]);t[i]=e[3]?r.$[e[3]]:r}})},t.prototype._refreshThirdComponents=function(){var t=this,n=this.thirdComponents;n&&Object.keys(n).forEach(function(i){var e=n[i].match(t.COMPONENTREG);if(e){var o=f.get(e[1]);t[i]=e[3]?o.$[e[3]]:o}})},t.prototype.init=function(){},t}();i.exports=h});
define("modules/lib/util",function(e,t,n){n.exports={query:function(e){var t=window.location.search.match(new RegExp("(\\?|&)"+e+"=([^&]*)(&|$)"));return t?decodeURIComponent(t[2]):""},getHash:function(e){var t=window.location.hash.match(new RegExp("(#|&)"+e+"=([^&]*)(&|$)"));return t?decodeURIComponent(t[2]):""},formatNumber:function(e){return e},htmlEncode:function(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML},htmlDecode:function(e){var t=document.createElement("span");return t.innerHTML=e,t.innerText||t.textContent},getUrlParam:function(e){return this.query(e)||this.getHash(e)},getLength:function(e){var t,n;for(n=0,t=0;t<e.length;t++)n+=e.charCodeAt(t)>=0&&e.charCodeAt(t)<=255?1:2;return n},saveUrlParamToObj:function(e){e=e?e:"?";var t=location.href,n={},r=t.split(e);return r.length<2?n:(r[1].split("&").forEach(function(e){var t,r;e&&(r=e.split("="),t=r.length>1?r[1]:"",n[r[0]]=t)}),n)},serializeUrlParameFromObj:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+"="+e[n]);return t.join("&")},replaceUrl:function(e){return e.replace(/[-a-zA-Z0-9:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?/g,function(e){return/(p\.qpic\.cn|7\.url\.cn)/.test(e)?e:-1===e.indexOf("http")?'<a data-reg="true" href="//'+e+'" target="_blank">'+e+"</a>":'<a data-reg="true" href="'+e+'" target="_blank">'+e+"</a>"}).replace(/([Tt]encent:\/\/[A-Za-z0-9-_]+\/\??[A-Za-z0-9-_%&@\?\/.=]+)([\s]*[^\w]*)/g,'<a href="$1" target="_blank">$1</a>$2')},formatDate:function(e,t,n){function r(e,t){return parseInt(0===c?e:parseInt(e)+c*(t?1:-1))}function a(e,t){return t=t.length,e=e||0,1===t?e:String(Math.pow(10,t)+e).slice(-t)}if(!t)return"";"number"==typeof t&&(t=new Date(t));var u=480,o=(new Date).getTimezoneOffset(),c=60*(u+o);return!n&&(t=new Date(r(parseInt(t.valueOf(),10),!0))),e.replace(/([YMDhsm])\1*/g,function(e){switch(e.charAt()){case"Y":return a(t.getFullYear(),e);case"M":return a(t.getMonth()+1,e);case"D":return a(t.getDate(),e);case"w":return t.getDay()+1;case"h":return a(t.getHours(),e);case"m":return a(t.getMinutes(),e);case"s":return a(t.getSeconds(),e)}})},throttleV2:function(e,t,n){var r,a=null;return function(){var u=this,o=arguments,c=+new Date;clearTimeout(a),r||(r=c),c-r>=n?(e.apply(u,o),r=c):a=setTimeout(function(){e.apply(u,o)},t)}}}});
define("modules/lib/db.core",function(e,n,t){function r(e){this._init(e)}var a=e("jquery"),i=function(){},s=function(e,n){if(1===arguments.length)return s(this,e);n=[].slice.call(arguments,1);for(var t,r,a=0,i=n.length;i>a;a++){t=n[a];for(r in t)e[r]=t[r]}return e},c=function(e){return e.method=e.method||e.type,a.ajax(e)},o=function(n){var t,r=n.url,a=n.success||i,s=n.error||i,c=n.data;if(r+=~r.indexOf("?")?"&jsoncallback=define&callback=define":"?jsoncallback=define&callback=define",r+="&_t="+ +new Date,c)for(t in c)r+="&"+t+"="+c[t];e([r],function(e){a(e),l(r)},function(e){s(e),l(r)})},l=function(e){var n,t=window.require;for(n in t.cache)if(~n.indexOf(e)){delete t.cache[n];break}};s(r.prototype,{_init:function(e){this.errHandles=e.errHandles||[],this.succHandles=e.succHandles||[],this.errHandles.unshift.apply(this.errHandles,r.options.errHandles||[]),this.succHandles.unshift.apply(this.succHandles,r.options.succHandles||[]),e=s({},r.options||{},e),this.options=e},_wrap:function(e){var n=this;return e.success=function(t){t=t||{msg:"Please check the 'Access-Control-Allow-Origin' header has a value."},a.isPlainObject(t)&&"retcode"in t?0===t.retcode?n._apply(n.succHandles,t,e,e.succ):n._apply(n.errHandles,t,e,e.err):n._apply(n.succHandles,t,e,e.succ)},e.error=function(t){n._apply(n.errHandles,t,e,e.err)},e},_apply:function(e,n,t,r){var a=0,i=e.length,s=n;for(a;i>a;a++)if(s=e[a].call(this,s,t),s===!1)return;r&&r(s)},ajax:function(e){e=this._wrap(s({},this.options,e)),!e.data&&(e.data=e.param),e.beforeAjax&&e.beforeAjax.call(this,e)||("jsonp"===e.type?o(e):c(e))}}),s(r,{httpMethod:function(e){var n=new r(e);return function(e){return n.ajax(e),this}},extend:s,options:{}}),t.exports=r});
define("modules/lib/cookie",function(e,n,o){o.exports={get:function(e){var n=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return n?decodeURIComponent(n[2]):""},set:function(e,n,o,t,i){var u=new Date;u.setTime(u.getTime()+(i?36e5*i:2592e6)),document.cookie=e+"="+n+"; expires="+u.toGMTString()+"; path="+(t?t:"/")+"; "+(o?"domain="+o+";":"")},del:function(e,n,o){document.cookie=e+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; path="+(o?o:"/")+"; "+(n?"domain="+n+";":"")},clear:function(){var e=document.cookie.match(new RegExp("([^ ;][^;]*)(?=(=[^;]*)(;|$))","gi"));for(var n in e)document.cookie=e[n]+"=;expires=Mon, 26 Jul 1997 05:00:00 GMT; path=/; "},uin:function(){var e=this.get("uin"),n=e?parseInt(e.substring(1,e.length),10):null,o=this.get("uid_uin");return n||o}}});
define("modules/lib/login",function(require,exports,module){function $(e){return"string"==typeof e?document.getElementById(e):e}function extend(e,o){if(arguments.length<2)return extend(this,e);e=e||{};for(var i in o)e[i]=o[i];return e}function getCookie(e){var o=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return o?decodeURIComponent(o[2]):""}function uin(){var e;return"2"===getCookie("uid_type")?e=getCookie("uid_uin")||getCookie("uin"):(e=getCookie("uin")||getCookie("uid_uin"),e?parseInt(e.substring(1,e.length),10):null)}function skey(){return getCookie("skey")}function delCookie(e,o,i){document.cookie=e+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; path="+(i?i:"/")+"; "+(o?"domain="+o+";":"")}function addEvent(e,o,i){e.attachEvent?e.attachEvent("on"+o,i):e.addEventListener(o,i,!1)}function removeEvent(e,o,i){e.detachEvent?e.detachEvent("on"+o,i):e.removeEventListener(o,i,!1)}function str2JSON(str){var __pt_json=eval("("+str+")");return __pt_json}function isWeixinUser(){var e=getCookie("uid_type");return"2"===e}function showMask(){mask=document.createElement("div"),mask.className="ptlogin-mask",mask.style.cssText="position:fixed;_position:absolute;width:100%;height:100%;padding:0;margin:0;left:0;top:0; z-index:999;filter:alpha(opacity=80);opacity:0.8;background-color:gray;",document.body.appendChild(mask)}function showFrame(e){outer=document.createElement("div"),outer.footerHeight=52,outer.className="ptlogin-wrap",outer.wrapHeight=414+outer.footerHeight,outer.marginTop=-(outer.wrapHeight/2),outer.style.cssText="position:fixed;_position:absolute;visibility:hidden;width:490px;height:"+outer.wrapHeight+"px;padding:0;margin-left:-245px; margin-top:"+outer.marginTop+"px; left:50%; top: 50%; z-index:1000;",outer.innerHTML='<iframe  name="login_frame" src="'+e+' "frameborder="0" scrolling="no" width="100%" height="100%"></iframe><div class="ptlogin-toolbar"><span class="toolbar-span"><p class="other-way">其他登录方式：</p><i class="btn-weixin js-login-weixin" id="js-login-weixin">微信登录</i></span></div>',loginFrame=outer.firstChild,document.body.appendChild(outer)}function weixinHandle(){var e=location.protocol,o=e+"//ke.qq.com/weixinCallBack.html",i="//open.weixin.qq.com/connect/qrconnect?appid=wxa1fd810b3796f1a4&redirect_uri="+encodeURIComponent(e+"//ke.qq.com/cgi-bin/uidaccount/login?ttype=4&account_type=2&appid=wxa1fd810b3796f1a4&buz_id=122052647&redirect_uri="+encodeURIComponent(o))+"&response_type=code&scope=snsapi_login#wechat_redirect",t="location=yes,left=755,top=225,width=400,height=570,resizable=yes",n=window.open(i,"wechat",t);n.focus(),longpoll.init()}function makeLoginUrl(e){var o={target:ptConfig.target,appid:ptConfig.appid,hide_close_icon:1-!!ptConfig.closeIcon,s_url:ptConfig.succUrl},i=[],t="/login_proxy.html"+(e.domain?"#domain="+e.domain:"");if(ptConfig.daid&&(o.daid=ptConfig.daid),"xui"===ptConfig.mode){i.push("//xui.ptlogin2"+hostDomain+"/cgi-bin/xlogin?");var n=location.href.split(/#|\?/)[0],a=n.indexOf("/",n.indexOf("//")+2),s=encodeURIComponent((-1!==a?n.substring(0,a):n)+t);o.proxy_url=ptConfig.proxyUrl||s,o.s_url=ptConfig.succUrl||s}else o.s_url=ptConfig.succUrl||encodeURIComponent("//ui.ptlogin2."+hostDomain+t),i.push("//ui.ptlogin2"+hostDomain+"/cgi-bin/login?");ptConfig.style&&(o.style=ptConfig.style);for(var u in o)i.push(u+"="+o[u]);return i.join("&")}function onmessage(e){var o=e||global.event;if(-1!==(e.origin||"").indexOf("ptlogin2")){var i;switch(i="undefined"!=typeof JSON?JSON.parse(o.data):str2JSON(o.data),i.action){case"close":global.ptlogin2_onClose();break;case"resize":global.ptlogin2_onResize(i.width,i.height)}}}function bindMessageAPI(){"undefined"!=typeof global.postMessage&&addEvent(global,"message",onmessage)}function unbindMessageAPI(){"undefined"!=typeof global.postMessage&&removeEvent(global,"message",onmessage)}function execTasks(e){for(var o=0,i=(e||[]).length;i>o;o++)try{e[o]()}catch(t){}}function setUin(e){status.uin=e}function isUinChanged(){return status.uin!=uin()}function setOpt(e){if(e){e.succ&&__cbSucc.push(e.succ),e.close&&__cbClose.push(e.close);for(var o in e)"undefined"!=typeof e[o]&&(userConfig[o]=e[o])}}function init(e){return e&&e.onStatusChanged&&(onStatusChanged=e.onStatusChanged),outer?void(e&&setOpt({succ:e.succ,close:e.close})):void setOpt(e)}function show(e){return e=e||{},outer?void(e&&setOpt({succ:e.succ,close:e.close})):(setOpt(e),void(isShowFrame||(isShowFrame=!0,extend(extend(ptConfig,config),userConfig),ptConfig.needMask&&showMask(ptConfig),showFrame(makeLoginUrl({domain:e.domain||""})),"xui"===ptConfig.mode&&bindMessageAPI())))}function hide(){isShowFrame=!1,outer&&(document.body.removeChild(outer),outer=loginFrame=undefined),mask&&(document.body.removeChild(mask),mask=undefined),__cbSucc=[],__cbClose=[],"xui"===ptConfig.mode&&unbindMessageAPI()}function loadScript(e,o){o=o||function(){};var i=document.createElement("script");i.type="text/javascript",i.readyState?i.onreadystatechange=function(){("loaded"==i.readyState||"complete"==i.readyState)&&(i.onreadystatechange=null,o())}:i.onload=function(){o()},i.src=e,document.body.appendChild(i)}function logout(){loadScript("https://ui.ptlogin2.qq.com/js/ptloginout.js",function(){pt_logout.logout(function(){for(var e=0,o=weixinCookie.length;o>e;e++)delCookie(weixinCookie[e],hostDomain),delCookie(weixinCookie[e],eduDomain);onStatusChanged&&onStatusChanged(),location.reload()})})}function delAllCookie(){loadScript("https://ui.ptlogin2.qq.com/js/ptloginout.js",function(){pt_logout.logout(function(){for(var e=0,o=weixinCookie.length;o>e;e++)delCookie(weixinCookie[e],hostDomain),delCookie(weixinCookie[e],eduDomain);onStatusChanged&&onStatusChanged()})})}function isLogin(){return!!getCookie("p_uin")&&!!getCookie("p_skey")||!!getCookie("uin")&&!!getCookie("skey")||!!getCookie("uid_uin")&&!!getCookie("uid_a2")}var global=window,status={curUin:0},weixinCookie=["uid_a2","uid_type","uid_uin"];if(global.Login)return global.Login;var longpoll={timeout:null,timespace:2e3,handle:function(){var e=this;isWeixinUser()&&(clearTimeout(e.timeout),execTasks(__cbSucc),hide(),onStatusChanged&&onStatusChanged())},init:function(){var e=this;clearTimeout(e.timeout),e.timeout=setInterval(function(){e.handle()},e.timespace)},destroy:function(){clearTimeout(self.timeout)}},config={needMask:!0,mode:"xui",closeIcon:!0,target:"self",appid:715030901,daid:233},hostDomain=(location.hostname.match(/(\.\w+){2}$/)||["."+location.hostname])[0],eduDomain=(location.hostname.match(/(\.\w+){3}$/)||["."+location.hostname])[0],userConfig={},ptConfig={},__cbSucc=[],__cbClose=[],onStatusChanged,undefined,outer,loginFrame,mask,isShowFrame=!1;global.ptlogin2_onClose=function(){execTasks(__cbClose),hide(),clearTimeout(longpoll.timeout)},global.ptlogin2_onResize=function(e,o){outer&&(outer.wrapHeight=o+outer.footerHeight,outer.marginTop=-(outer.wrapHeight/2),outer.style.width=e+"px",outer.style.height=outer.wrapHeight+"px",outer.style.marginLeft=-e/2+"px",outer.style.marginTop=outer.marginTop+"px",outer.style.visibility="visible",document.getElementById("js-login-weixin").onclick=weixinHandle)},global.ptlogin2_login_ok=function(){if(!status.uin)for(var e=0,o=weixinCookie.length;o>e;e++)delCookie(weixinCookie[e],hostDomain),delCookie(weixinCookie[e],eduDomain);execTasks(__cbSucc),onStatusChanged&&onStatusChanged(),hide()},module.exports={init:init,show:show,hide:hide,logout:logout,isLogin:isLogin,uin:uin,skey:skey,setUin:setUin,isUinChanged:isUinChanged,isWeixinUser:isWeixinUser,delAllCookie:delAllCookie}});
define("modules/lib/mmReport",function(e,n,o){function t(){var e=u.length;e>10&&(e=10);var n=u.splice(0,e);if(0!==n.length){var o=n[0].uin,t="https://huatuocode.huatuo.qq.com/code.cgi?domain="+l.domain+"&uin="+o+"&apn="+n[0].apn;t+="&key=cgi,type,code,time";for(var r=["cgi","type","code","time"],a=0;a<r.length;a++)for(var i=0;i<n.length;i++){var c=n[i];t+="&"+(i+1)+"_"+(a+1)+"="+c[r[a]]}t+="&ignoreRandom="+Math.random();var m=new Image;m.src=t}}function r(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];if(o)for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t])}return e}function a(e,n,o,a,d){m&&clearTimeout(m);var p=r({},l,d);p.cgi=encodeURIComponent(e),p.type=0===n?1:2,p.code=n,p.time=o,p.releaseversion=i||"unknown",p.uin=a,p.type=0===n?1:/^[4|5][0-9]{2}$/.test(n)?2:3,u.push(p),m=setTimeout(t,c)}var i,u=[],c=1e3,m=null,l={domain:document.domain||"ke.qq.com",code:null,uin:null,time:null,rate:1,apn:"pc"};o.exports={report:a}});
define("modules/lib/db",function(e,t,n){function r(e){var t=document.getElementById(e);t&&(t.outerHTML="",delete t)}function o(e){return function(t){e.call(this,t,!0)}}function c(e,t){var n=new Date-y[t.url];delete y[t.url],w.report(t.url,e.retcode,n,v.uin(),{})}function a(e,t){var n=e;if("object"!=typeof e)try{n=JSON.parse(e)}catch(o){}switch(n.retcode){case 111:case 1e5:case 100021:case 100023:return _.flesh(function(){self.ajax(t)}),!1;case 180400:return window.onbeforeunload=null,r("ke-vplayer"),r("player-container"),void v.logout()}}function u(e,t){return c(e,t),a(e,t),e}function i(e){var t=[m,e.url].join("@"),n=localStorage[t],r=this;e.localOnce&&(this.options.useLocal=!1),n&&setTimeout(function(){try{r._apply(r.succHandles.slice(p.options.succHandles.length),JSON.parse(n),e,o(e.succ))}catch(t){}},0)}function l(e,t,n){var r=[m,t.url].join("@");try{localStorage[r]=JSON.stringify(e)}catch(o){localStorage.clear(),n||l(e,t,!0)}}function s(e,t){return c(e,t),_.reset(),t.useLocal&&l(e,t),a(e,t),e}function d(e){if(!("__PRELOAD__"in window))throw new Error("please use <diy-preload> first!");var t=window.__PRELOAD__;if(t[e.url])e.success(t[e.url]);else{var n=setTimeout(function(){e.error({retcode:404})},1e4);t[e.url]=function(t){clearTimeout(n),e.success(t)}}}function f(e){if(!e)return"";for(var t=5381,n=0,r=e.length;r>n;++n)t+=(t<<5)+e.charAt(n).charCodeAt();return 2147483647&t}function h(){return v.isWeixinUser()?g.get("uid_a2")||"":g.get("skey")||""}var p=e("modules/lib/db.core"),m="qqclient",g=e("modules/lib/cookie"),v=e("modules/lib/login"),w=e("modules/lib/mmReport"),y={},_=function(){var e=0;return{flesh:function(e){v.show({succ:e})},reset:function(){e>0&&(e=0)}}}();p.options={errHandles:[u],succHandles:[s],xhrFields:{withCredentials:!0},dataType:"JSON",type:"POST",cache:!1,beforeAjax:function(e){if(e.data=e.data||{},e.data.bkn=f(h()),y[e.url]=new Date-0,e.useImg||e.data.__useImg){delete e.data.__useImg;var t=new Image,n=e.data;return t.src=e.url+"?"+Object.keys(n).map(function(e){return e+"="+n[e]}).join("&"),!0}return e.preload?(d.call(this,e),!0):void(e.useLocal&&i.call(this,e))}},n.exports=p});
define("modules/lib/faceReplace",function(){var e=function(){var e=[5199,5186,5187,5188,5189,5190,5191,5192,5193,5194,5195,5196,5197,5198,5185,5235,5236,5281,5238,5239,5258,5259,5260,5261,5262,5263,5240,5241,5242,5243,5264,5265,5266,5267,5268,5269,5270,5271,5272,5273,5282,5283,5284,5285,5286,5287,5288,5289,5290,5291,5292,5293,5294,5295,5296,5297,5217,5298,5299,5300,5248,5249,5244,5218,5219,5301,5221,5222,5223,5276,5277,5278,5214,5302,5257,5230,5227,5224,5247,5231,5232,5256,5280,5303,5304,5305,5306,5307,5308,5309,5212,5206,5208,5210,5211,5310,5311,5312,5313,5314,5315,5316,5317,5318,5319],n=["微笑","撇嘴","色","发呆","得意","流泪","害羞","闭嘴","睡","大哭","尴尬","发怒","调皮","呲牙","惊讶","难过","酷","冷汗","抓狂","吐","偷笑","可爱","白眼","傲慢","饥饿","困","惊恐","流汗","憨笑","大兵","奋斗","咒骂","疑问","嘘","晕","折磨","衰","骷髅","敲打","再见","擦汗","抠鼻","鼓掌","糗大了","坏笑","左哼哼","右哼哼","哈欠","鄙视","委屈","快哭了","阴险","亲亲","吓","可怜","菜刀","西瓜","啤酒","篮球","乒乓","咖啡","饭","猪头","玫瑰","凋谢","示爱","爱心","心碎","蛋糕","闪电","炸弹","刀","足球","瓢虫","便便","月亮","太阳","礼物","拥抱","强","弱","握手","胜利","抱拳","勾引","拳头","差劲","爱你","NO","OK","爱情","飞吻","跳跳","发抖","怄火","转圈","磕头","回头","跳绳","挥手","激动","街舞","献吻","左太极","右太极"],r={};return{faceWord:n,getWebFaceCode:function(n){if(void 0===r[n]){for(var t=0,u=e.length;u>t;t++)if(n===e[t])return r[n]=t,t;return 63}return r[n]},getClientFaceCode:function(n){return e[n]}}}();return e});
define("modules/lib/format",function(e,t,i){function n(){"use strict";var e=this,t=[];this._class2type={},"Boolean Number String Function Array Date RegExp Object Error".replace(/[^, ]+/g,function(t){e._class2type["[object "+t+"]"]=t.toLowerCase()}),this.rule={fileSize:function(e){return Math.ceil(e/1024)+"K"},timestamp:function(t){return"number"===e.type(t)?1e3*t:0}},this.formatMap={notice:{keyMap:{msg:{key:"msg_subcmd0x2_rsp",fn:function(t){return t.string_notice?e.format("noticeMsg",t):[]}}}},noticeMsg:{keyMap:{info:"string_addition_info",content:{key:"string_notice",fn:function(e){return e?(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&quot;").replace(/"/g,"&#39;"),s.replaceUrl(e)):""}},type:"uint32_notice_type"}},recommend:{keyMap:{cid:"cid",coverUrl:"cover_url",des:"des",name:"name"}},liveInfo:{keyMap:{offlineStatus:"offline_status",serverTime:{key:"server_time",fn:"timestamp"},startTime:{key:"bg_time",fn:"timestamp"},endTime:{key:"end_time",fn:"timestamp"},leaveTime:{key:"leave_ts",fn:"timestamp"}}},term:{keyMap:{$init:function(e){return e.term_id.toString()===s.getUrlParam("term_id")?!0:!1},name:"name",cid:"cid",termId:"term_id",price:"price",roomId:"room_id",roomUrl:"room_url",chapterInfo:{key:"chapter_info",fn:function(t){return e.format("chapterInfo",t)}}}},subInfo:{keyMap:{name:"name",cid:"cid",subId:"sub_id",taskInfo:{key:"task_info",fn:function(t){return e.format("taskInfo",t)}}}},chapterInfo:{keyMap:{name:"name",cid:"cid",chapterId:"ch_id",startTime:{key:"sub_bgtime",fn:"timestamp"},endTime:{key:"sub_endtime",fn:"timestamp"},subInfo:{key:"sub_info",fn:function(t){return e.format("subInfo",t)}}}},taskInfo:{keyMap:{subTask:{key:"resid_ext",fn:function(t){var i=[];if("object"!==e.type(t))return t;var n=t.list;if("array"===e.type(n)&&n.length>0){for(var s=0,r=n.length;r>s;s++){var a=n[s]||{};i.push({vid:a.id,timelen:a.times,index:s+1,type:5})}return i}return n}},name:"name",cid:"cid",taid:"taid",aid:"aid",tid:"term_id",streamBitFlag:"task_bit_flag",type:"type",exam:"exam",file:"file",status:"status",tryListenType:"expr_flag",tryListenTime:"expr_range",timelen:"timelen",resid_ext:"resid_ext",isToggle:{key:"resid_list",fn:function(e){var t=s.getHash("vid")||s.query("vid");e="string"==typeof e?[e]:e;for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i+1;return 0}},vid:{key:"resid_list",fn:function(e){return"string"==typeof e?e:e[0]}},techContact:{key:"te_list",fn:function(t){if("array"!==e.type(t))return{};for(var i={},n=0,s=t.length;s>n;n++)i[n]=t[n];return i}},startTime:{key:"bgtime",fn:"timestamp"},endTime:{key:"endtime",fn:"timestamp"}}},termInstallment:{keyMap:{price:"price",orderState:"order_state",orderId:"order_id",installmentBegin:"installment_begin",installmentEnd:"installment_end",installmentSeq:"installment_seq",payBeginTime:"pay_begin_time",payExpireTime:"pay_expire_time"}},member:{keyMap:{$init:function(){},list:{key:"cmd0x6_get_page_member_list",fn:function(t){return e.format("userInfo",t)}}}},userInfo:{keyMap:{$init:function(){this.teacherList=[],this.userList=[],this.teacherMap={}},countPerPage:"uint32_count_per_page",curPage:"uint32_curpage",isFirstPage:"uint32_is_first_page",total:"uint32_total",roleType:"role_type",teacherList:{key:"special_user_list",fn:function(e){var t=[];if(e)for(var i=0,n=e.user_info.length;n>i;i++){var s=e.user_info[i];if(s.role_id){switch(this.teacherMap[s.uid]=!0,s.role_id){case 1:s.__sort=4;break;case 2:s.__sort=3;break;case 7:s.__sort=2;break;case 8:s.__sort=1;break;case 9:s.__sort=5}t.push(s)}}return t.sort(function(e,t){return e.__sort>t.__sort})}},userList:{key:"user_list",fn:function(e){var t=[];if(e)for(var i=0,n=e.user_info.length;n>i;i++){var s=e.user_info[i];this.teacherMap[s.uid]||t.push(s)}return t}}}},termApplyInfo:{keyMap:{payStatus:"pay_status",roleType:"role_type",installmentState:"installment_state",installmentType:"installment_type",termInstallment:{key:"term_installment",fn:function(t){if(t){var i=[];return t.forEach(function(t){i.push(e.format("termInstallment",t))}),i}return[]}}}},creditsInfo:{keyMap:{$init:function(){},credits_day_limit:"credits_day_limit",exchange_rate:"exchange_rate",rank:"rank",today_study_credits:"today_study_credits",today_study_duration:"today_study_duration",total_study_credits:"total_study_credits"}},courseInfo:{keyMap:{$init:function(t){this.course=e.format("course",t.course_detail)}}},termsDetail:{keyMap:{terms:{key:"terms",fn:function(t){return e.format("term",t)}}}},course:{keyMap:{$init:function(e){var t=e.sg_list?e.sg_list[0]:!1;t&&(this.groupName=t.name,this.groupId=t.groupid)},agencytype:"agency_type",courseBitFlag:"course_bit_flag",cid:"cid",tencent:"agency_tencent",title:"name",name:{key:"name",fn:function(e){return s.htmlDecode("《"+e+"》")}},pics:"cover_url",desc:{key:"name",fn:function(e){return'我在腾讯课堂学习"'+e+'"课程呦，也来看看吧~。好好学习，Day Day Up!'}},summary:"summary",roleType:"role_type",url:{key:"name",fn:function(){return"//ke.qq.com/course/"+s.getHash("course_id")}},serviceqq:{key:"service_qq",fn:function(t){if("array"!==e.type(t))return{};var i={},n=t[0];return n&&(i.url=n.url,i.uin=n.uin,i.nick=n.nick||""),i}},serverTime:{key:"sys_time",fn:"timestamp"},endTime:{key:"endtime",fn:"timestamp"}}},flashInfo:{keyMap:{key:"key",tcpList:"tcp_list"}},roomConfig:{keyMap:{retcode:"retcode",forbidSpeech:{key:"msg_subcmd0x1_rsp_get_info",fn:function(e){var t=!1;if(e.uint32_type&&(this.allForbidSpeech=!0,t=!0),e&&e.rpt_msg_speech_info_list){this.forbidSpeechList=[];for(var i=0,n=e.rpt_msg_speech_info_list.length;n>i;i++)this.forbidSpeechList.push({uin:e.rpt_msg_speech_info_list[i].uint64_uin});t=!0}return t}},forbidPicture:{key:"msg_subcmd0x2_rsp_get_pic",fn:function(e){return e&&!!e.uint32_type}},forbidFlower:{key:"msg_subcmd0x3_rsp_get_flower",fn:function(e){return e&&!!e.uint32_type}},speechFrequency:{key:"msg_subcmd0x4_rsp_get_freq",fn:function(e){return e?1e3*e.uint32_second:-1}}}},speechLimit:{keyMap:{retcode:"retcode",limit:{key:"uint32_limit_time",fn:function(e){return e||0}}}},comment:{keyMap:{retcode:"retcode",info:{key:"msg_subcmd0x1_rsp_auth",fn:function(t){var i={};return t&&"array"===e.type(t.rpt_msg_auth_result)&&(i.isJoin=t.rpt_msg_auth_result[0].uint32_status||0,i.isStudent=t.rpt_msg_auth_result[1].uint32_status||0,i.isVip=t.rpt_msg_auth_result[2].uint32_status||0),i}},list:{key:"msg_subcmd0x1_rsp_auth",fn:function(t){var i=[];return t&&"array"===e.type(t.rpt_msg_auth_result)?t.rpt_msg_auth_result:i}}}},commentNew:{keyMap:{retcode:"retcode",$init:function(e){this.list=[{str_title:"报名该课程",uint32_status:e.isApplied},{str_title:"进行了学习任务",uint32_status:e.isTaskDone},{str_title:"只有学员可以评论",uint32_status:e.isStudent}],this.isApplied=e.isApplied,a.isWeixinUser()||this.list.push({str_title:"QQ等级达到一个太阳以上",uint32_status:e.isLevelHigh})}}},subCourse:{keyMap:{vid:"vid",name:"sub_name"}},token:{keyMap:{token:"Token"}},pushData:{keyMap:{$init:function(t){try{var i=JSON.parse(t).result}catch(n){return}for(var s=i.data||[],r=[],a=[],u=0,o=0,_=s.length;_>o;o++){switch(s[o].head.cmd){case 4:case 82:case 86:r.push(s[o]);break;default:a.push(s[o])}u<s[o].head.seq&&(u=s[o].head.seq),s[o].body&&s[o].body.msg_subcmd0x1_push_attendclass&&(this.teacherUin=s[o].body.msg_subcmd0x1_push_attendclass.uint64_uin)}this.seq=u,this.msgList=e.format("pushDataMsg",r),this.sysMsgList=e.format("pushDataMsg",a),this.getToken=i.gettoken,this.nextHeart=i.next_heart||0}}},pushDataMsg:{keyMap:{$init:function(e){for(var i={4:"flower",76:"attendRoom",77:"userChange",79:"kick",82:"chatMsg",86:"warningMsg",88:"speakMode",89:"attendClass",94:"roomConfigChange",98:"updateNotice",108:"updateRemark",109:"flashStatus"},n=!1,s=0,r=t.length;r>s;s++)~~t[s]===~~e.head.seq&&(n=!0);return t.length>=100&&t.shift(),n?!1:(t.push(e.head.seq),this.cmd=i[e.head.cmd],void(this.flag=e.head.flag))},seq:{key:"head",fn:function(e){return e.seq}},__data:{key:"body",fn:function(t){return e.extend(this,e.format(this.cmd,t)),""}}}},flower:{keyMap:{$init:function(e){this.type=2,this.name=e.str_from_uin_nick,this.to=e.str_dest_uin_nick},fromUin:"uint64_from_uin",destUin:"uint64_dest_uin",fromNick:"str_from_uin_nick",destNick:"str_dest_uin_nick"}},userChange:{keyMap:{subcmd:"uint32_sub_cmd",__data:{key:"msg_subcmd0x2_member_update_list",fn:function(){this.isChange=!0}}}},kick:{keyMap:{__data:{key:"msg_subcmd0x1_kick_user",fn:function(e){this.msg=e.str_wording}}}},chatMsg:{keyMap:{__data:{key:"rpt_msg_entry",fn:function(e){var t=e[0],i=t.msg_body.msg_rich_text.rpt_msg_elems;this.type=1,this.content="";for(var n,a=0,u=i.length-1;u>a;a++)switch(n=i[a],n.uint32_elem_type){case 1:this.content+=s.replaceUrl(n.msg_text.bytes_str);break;case 2:var o=r.getWebFaceCode(n.msg_face.uint32_index);o=o||1,this.content+='<img class="face-zoom" src="//7.url.cn/edu/webcourse/modules/img/emoji/'+o+'@2x.gif">';break;case 3:var _=n.msg_not_online_image.bytes_pic_md5;_=_.replace(/http(s?):/,""),this.content+='<img src="'+_+'" onerror="_imgerror(this, \''+_+"')\">"}return this.uin=t.msg_msg_head.uint64_from_uin,this.name=i[i.length-1].msg_add_info?i[i.length-1].msg_add_info.str_nick_name:this.uin,""}}}},warningMsg:{keyMap:{$init:function(){this.type=3},content:"str_msg"}},updateNotice:{keyMap:{$init:function(t){this.msgType=2,t&&2===t.uint32_sub_cmd&&(this.coupon=e.format("updateCoupon",t.msg_subcmd0x2_sub_notice_update))},subcmd:"uint32_sub_cmd",operType:"uint32_operType"}},updateCoupon:{keyMap:{$init:function(e){if(e&&e.str_url){var t=e.str_url.match(/tid=([0-9]+)&cid=([0-9]+)/);this.cid=t[2],this.tid=t[1]}},remainTime:"int32_remain_time"}},couponStatus:{keyMap:{$init:function(e){var t={1:{prefix:"机构",title:"满减券",color:"orange"},2:{prefix:"课程",title:"现金券",color:"red"}};this.kind=e.limit||e.is_suit_all||e.elem&&e.elem.is_suit_all?1:2,e.elem?(this.cid=e.elem.cl[0].cid,this.cname=e.elem.cl[0].cname):(e.cl=e.cl||[],this.cid=e.cl.length?e.cl[0].cid:0,this.cname=e.cl.length?e.cl[0].cname:"全部课程"),this.couponTitle=t[this.kind].title,this.prefix=t[this.kind].prefix,this.color=t[this.kind].color,e.a_info&&(this.aname=e.a_info.name,this.domain=e.a_info.domain)},cl:"cl",limit:"limit",aid:"aid",beginTime:{key:"begin_time",fn:"timestamp"},endTime:{key:"end_time",fn:"timestamp"},couponId:"cou_id",mode:"mode",price:"price",state:"state",type:"type",ret:"ret",appliedOver:"applied_over",isSuitAll:"is_suit_all"}},attendClass:{keyMap:{subcmd:"uint32_subcmd",__data:{key:"msg_subcmd0x1_push_attendclass",fn:function(e){e&&(this.uin=e.uint64_uin)}},___data:{key:"msg_subcmd0x2_push_classover",fn:function(e){e&&(this.uin=e.uint64_uin)}}}},roomConfigChange:{keyMap:{changeType:"uint32_subcmd",speechChange:{key:"msg_subcmd0x1_push_info_change",fn:function(t){return e.format("speechChange",t)}},uploadImgChange:{key:"msg_subcmd0x2_push_pic_change",fn:function(t){return e.format("uploadImgChange",t)}},flowerChange:{key:"msg_subcmd0x3_push_flower_change",fn:function(t){return e.format("flowerChange",t)}},speechRateChange:{key:"msg_subcmd0x4_push_frequency_change",fn:function(t){return e.format("speechRateChange",t)}},speechLimit:{key:"msg_subcmd0x5_push_enterlimit_chage",fn:function(e){return e&&e.uint32_second}}}},speechChange:{keyMap:{uin:"uint64_uin",flag:"uint32_flag",type:"uint32_type",uinType:"uint32_uin_type"}},uploadImgChange:{keyMap:{uin:"uint64_uin",flag:"uint32_flag",type:"uint32_type",uinType:"uint32_uin_type"}},flowerChange:{keyMap:{uin:"uint64_uin",flag:"uint32_flag",type:"uint32_type",uinType:"uint32_uin_type"}},speechRateChange:{keyMap:{uin:"uint64_uin",flag:"uint32_flag",type:"uint32_type",uinType:"uint32_uin_type",second:"uint32_second"}},isGroupMember:{keyMap:{isMember:"isMember",url:"url"}},speakMode:{keyMap:{__data:{key:"msg_subcmd0x1_speak_mode_switch",fn:function(e){this.mode=e.uint32_type}}}},flashStatus:{keyMap:{status:"uint32_status"}},attend:{keyMap:{attendts:{key:"attend_ts",fn:"timestamp"}}},updateRemark:{keyMap:{items:"items"}},idkey:{keyMap:{url:"url"}}}}var s=e("modules/lib/util"),r=e("modules/lib/faceReplace"),a=e("modules/lib/login");n.prototype={constructor:n,extend:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},each:function(e,t){for(var i in e)if(e.hasOwnProperty(i)&&t(i,e[i])===!1)return},type:function(e){var t=this;return null===e?e+"":"object"==typeof e||"function"==typeof e?t._class2type[Object.prototype.toString.call(e)]||"object":typeof e},addMap:function(e,t){this.formatMap[e]=t},addRule:function(e,t){this.rule[e]=t},format:function(e,t){var i=this,n=this.formatMap[e];if(n){var s=[],r=this.type(t);if("array"===r)this.each(t,function(e,t){var r=i.formatData(n,t);Object.keys(r).length&&s.push(r)});else if("object"===r||"string"===r)return i.formatData(n,t);return s}return t},formatData:function(e,t){var i=this,n={},s=e.keyMap;return this.each(s,function(e,s){if("object"===i.type(s))s.fn&&(n[e]="string"===i.type(s.fn)?i.rule[s.fn].call(n,t[s.key]):s.fn.call(n,t[s.key]));else if("$init"===e&&"function"===i.type(s)){var r=s.call(n,t);if(r===!1)return!1}else n[e]=t[s]}),n}},i.exports=new n});
define("pages/index/db.index",function(e,t,r){"use strict";var a=e("modules/lib/db"),n=e("jquery"),i=e("modules/lib/format"),o=e("modules/lib/util"),c=o.getHash("term_id"),g=function(){var e={getNotice:{type:"get",param:{tkn:c},url:"/cgi-bin/web_ke/get_notice",_formatKey:"notice"},getRecommend:{type:"get",url:"/cgi-bin/get_course_marketing_des",_formatKey:"recommend"},get_coupon_status_marketing:{type:"get",url:"/cgi-bin/coupon/get_coupon_status_marketing",_formatKey:"couponStatus"},get_coupon_marketing:{type:"post",url:"/cgi-bin/coupon/get_coupon_marketing"},sendMessage:{type:"post",param:{tkn:c},url:"/cgi-bin/web_ke/sendmsg",_formatKey:"message"},getTerm:{type:"get",url:"/cgi-bin/cs/recmmd_course_forqqlive",_formatKey:"term"},getCommentAuth:{type:"get",param:{tkn:c},url:"/cgi-bin/web_ke/comment_auth",_formatKey:"comment"},getCommentAuthNew:{type:"get",param:{tkn:c},url:"/cgi-bin/comment_new/course_auth",_formatKey:"commentNew"},getTeacherId:{type:"get",param:{tkn:c},url:"/cgi-bin/video/teacherId"},getLiveInfo:{type:"get",url:"/cgi-bin/pubAccount/getLiveInfo",cache:!1,_formatKey:"liveInfo"},getJubaoItem:{type:"GET",url:"/cgi-bin/course/get_report_item",xhrFields:{withCredentials:!0}},postJubao:{type:"POST",url:"/cgi-bin/course/report",xhrFields:{withCredentials:!0}},getCourseInfo:{type:"get",url:"/cgi-bin/course/basic_info",_formatKey:"courseInfo"},getTermsDetail:{type:"get",url:"/cgi-bin/course/get_terms_detail",_formatKey:"termsDetail"},getTermApplyInfo:{type:"get",url:"/cgi-bin/course/get_term_apply_info",_formatKey:"termApplyInfo"},getCreditsInfo:{type:"get",url:"/cgi-bin/user/get_user_study_stats",_formatKey:"creditsInfo"},check_join_group:{type:"get",url:"/cgi-bin/user/check_join_group"},getPushData:{type:"get",dataType:"text",url:"/cgi-bin/push-msg/long-poll/",cache:!1,_formatKey:"pushData"},getFlashInfo:{type:"get",param:{tkn:c},url:"/cgi-bin/web_ke/flash_video_joint",cache:!1,_formatKey:"flashInfo"},getRoomConfig:{type:"get",param:{tkn:c},url:"/cgi-bin/web_ke/get_roomconfig",cache:!1,_formatKey:"roomConfig"},sendFlower:{type:"get",param:{tkn:c},url:"/cgi-bin/web_ke/sendflower",_formatKey:"sendFlower"},getSpeechLimit:{type:"get",param:{tkn:c},url:"/cgi-bin/web_ke/get_speech_limit",cache:!1,_formatKey:"speechLimit"},getMemberSearch:{type:"get",param:{tkn:c},url:"/cgi-bin/web_ke/search"},getToken:{type:"get",param:{tkn:c},url:"/cgi-bin/web_ke/gettoken",cache:!1,_formatKey:"token"},getMemberList:{type:"get",param:{tkn:c},url:"/cgi-bin/web_ke/get_userlist",_formatKey:"member"},leaveRoom:{type:"get",async:!1,param:{tkn:c},cache:!1,url:"/cgi-bin/web_ke/leave_classroom"},isGroupMember:{type:"get",param:{tkn:c},url:"/cgi-bin/web_ke/is_qunmember",_formatKey:"isGroupMember"},getIdKey:{type:"get",url:"/cgi-bin/encoder",_formatKey:"idkey"},searchUser:{type:"get",param:{tkn:c},url:"/cgi-bin/web_ke/search_user",cache:!1,_formatKey:"userList"},getAttend:{type:"get",param:{tkn:c},url:"/cgi-bin/web_ke/get_attend_ts",cache:!1,_formatKey:"attend"},getRemark:{type:"post",param:{tkn:c},url:"/cgi-bin/web_ke/get_remark",_formatKey:"remark"},postFeedback:{type:"post",url:"/cgi-bin/exam/add_web_course_feedback"},rtmpAuthentication:{type:"get",url:"/cgi-bin/web_ke/live_auth"},getRtmpStreamStatus:{type:"get",url:"/cgi-bin/web_ke/get_live_status"}},t={};return{send:function(r,i){var o=e[r],c={param:n.extend(o.param,i)},g=this._addDefer(r,c),m=t[r];return m||(m=t[r]=a.httpMethod(o)),m(c),g},_addDefer:function(t,r){var a=n.Deferred();return r.succ=function(r){var n,o=e[t],c=r;if("text"!==o.dataType)c=r.result||r.data||{};else{try{n=JSON.parse(c)}catch(g){return void a.reject({retcode:1,result:{data:c}})}if(0!==n.retcode)return void a.reject(n)}a.resolve(i.format(e[t]._formatKey,c),c.retcode||0)},r.err=function(e){a.reject(e)},a},_get:function(){var t=this,r={};return Object.keys(e).forEach(function(e){r[e]=function(r){return t.send(e,r)}}),r}}}();a.extend(g._get()),r.exports=a});
define("lego_modules/observer/0.0.1/observer",function(){var r=function(){var r={};return{listen:function(t,e){return r[t]=r[t]||[],r[t].push(e),this},remove:function(t){var e=r[t];return e?e.length=0:r[t]=void 0,this},one:function(r,t){return this.remove(r),this.listen(r,t)},trigger:function(){var t,e,n;n=Array.prototype.shift.call(arguments),e=r[n]?r[n]:r[n]=[];for(var i=0,u=e.length;u>i;i++)if(t=e[i],t.apply(this,arguments)===!1)return this;return this}}},t={},e=r();return e.get=function(e){return t[e]||(t[e]=r()),t[e]},e});
define("lego_modules/local.data/0.0.1/local.data",function(){var e,t=function(){var e,t,n=document.getElementsByTagName("head")[0],r=window.location.hostname||"edu_database",a=new Date;if(n.addBehavior){try{t=new ActiveXObject("htmlfile"),t.open(),t.write('<script>document.w=window;</script><iframe src="/favicon.ico"></frame>'),t.close(),e=t.w.frames[0].document}catch(i){e=document}n=e.createElement("head"),e.appendChild(n),a.setDate(a.getDate()+30),n.addBehavior("#default#userData"),n.expires=a.toUTCString(),n.load(r);var o=n.XMLDocument.documentElement,c=o.attributes,u="prefix_____hack__",l=/^[-\d]/,s=new RegExp("^"+u),f=function(e){return l.test(e)?u+e:e},h=function(e){return e.replace(s,"")},d={length:c.length,notNativeCode:!0,getItem:function(e){return(c.getNamedItem(f(e))||{nodeValue:null}).nodeValue||o.getAttribute(f(e))},setItem:function(e,t){o.setAttribute(f(e),t),n.save(r),this.length=c.length},removeItem:function(e){o.removeAttribute(f(e)),n.save(r),this.length=c.length},clear:function(){for(;c.length;)this.removeItem(c[0].nodeName);this.length=0},key:function(e){return c[e]?h(c[e].nodeName):void 0}};return d}};try{e=window.localStorage,e||(e=t())}catch(n){e=t()}var r=function(e){var t=function(){return null};return e?{set:function(t,n){void 0!==this.get(t)&&this.remove(t);try{e.setItem(t,n)}catch(r){this.clear()}},get:function(t){var n=e.getItem(t);return null===n?void 0:n},remove:function(t){e.removeItem(t)},clear:function(){e.clear()},each:function(e){var t,n=this.obj(),r=e||function(){};for(t in n)if(r.call(this,t,this.get(t))===!1)break},obj:function(){var t,n,r={},a=0;if(e.isVirtualObject)r=e.key(-1);else for(t=e.length;t>a;a++)n=e.key(a),r[n]=this.get(n);return r},filter:function(t){var n,r,a=[],i=0;if(e.isVirtualObject)a=[];else for(n=e.length;n>i;i++)r=e.key(i),t.test(r)&&a.push({key:r,value:this.get(r)});return a}}:{set:t,get:t,remove:t,clear:t,each:t,obj:t,filter:t}}(e);return r});
define("lego_modules/edu-wrap-https-proxy/0.0.2/src/index",function(t,o,e){var p="https://proxy.ke.qq.com/tx_tls_gate=",r=function(t,o){var e="http:"!==window.location.protocol;return"string"==typeof t&&t?/^https:/i.test(t)?t:e?o?o:t.replace(/^(http:)?(\/\/)?/i,p):t:""};e.exports=r});
define("lego_modules/edu-wrap-https-proxy/0.0.2/index",function(e,o,d){var p=e("lego_modules/edu-wrap-https-proxy/0.0.2/src/index");d.exports=p});
define("modules/lib/timing",function(t){function n(t,n){var t=t.split("-"),e=[];o(t).each(function(t,n){e.push("flagid=".replace("id",t+1)+n)});for(var d in n)e.push(d+"="+n[d]);var i=new Image;r.push(i),i.src=a("http://isdspeed.qq.com/cgi-bin/r.cgi?"+e.join("&"))}function e(t){if(window.performance){var e=performance.timing,a=e.navigationStart,r={},d=["unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"],i=1;o(d).each(function(t,n){r[i++]=Math.max(e[n]-a,1)}),r[20]=Math.max((new Date).getTime()-a,1),n(t,r)}}var o=t("jquery"),a=t("lego_modules/edu-wrap-https-proxy/0.0.2/index"),r=[];return{report:function(t){setTimeout(function(){e(t)},0)}}});
define("lego_modules/util.bom/0.0.1/util.bom",function(e,n,o){var r=e("jquery"),t=navigator.platform,a=!t||"Win32"===t||"Win64"===t||"Windows"===t;o.exports=r.bom={query:function(e){var n=window.location.search.match(new RegExp("(\\?|&)"+e+"=([^&]*)(&|$)"));return n?decodeURIComponent(n[2]):""},getHash:function(e){var n=window.location.hash.match(new RegExp("(#|&)"+e+"=([^&]*)(&|$)"));return n?decodeURIComponent(n[2]):""},checkPlatform:function(){var e=navigator.platform,n=!e||"Win32"===e||"Win64"===e||"Windows"===e;return n||(r.Dialog.alert("请通过电脑登录Windows系统，再访问该页面。"),Badjs("非windows pc, ua="+navigator.userAgent+", platform="+navigator.platform,location.href,0,410018,2)),n},parseHref:function(e){var n=document.createElement("a");return n.href=e,{domain:n.hostname,pathname:n.pathname,search:n.search,hash:n.hash}},isWindows:function(){return a},parseQuery:function(e){var n,o,r={};if(!e)return r;n=e.indexOf("?"),o=0===n?1:0;for(var t=e.substr(o).split("&"),a=0;a<t.length;a++){var i=t[a].split("=");r[decodeURIComponent(i[0])]=decodeURIComponent(i[1]||"")}return r},htmlEncode:function(e){return(""+e).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\'/g,"&#39;").replace(/\"/g,"&quot;")}}});
define("lego_modules/tdw/0.1.0/tdw",function(t,e,n){function r(t){var e;return i(t),e=o(t),{fields:d,datas:e}}function i(t){t&&(s.isPlainObject(t)&&(t=[t]),s.isArray(t)&&s.each(t,function(t,e){s.each(e,function(t){p[t]||(p[t]=1,d.push(t))})}))}function o(t){var e,n=[];return t&&(s.isPlainObject(t)&&(t=[t]),s.isArray(t))?(s.each(t,function(t,r){e=[],r=s.extend({},l,r),s.each(d,function(t,n){e.push(r[n]||"")}),n.push(e)}),n):void 0}function a(t,e){var n={};e=e||f,s.each(["table","pr_ip","pr_t"],function(t,r){n[r]=e[r]||""}),n.fields=JSON.stringify(t.fields),n.datas=JSON.stringify(t.datas),n.retype=2,f.beforeRequest(t)!==!1&&e.url&&(s.ajax({url:e.url,data:n,dataType:"jsonp"}).done(function(e){f[0===e.ret?"success":"error"](e,t)}).fail(function(e,n,r){f.fail(t,e,n,r)}),u(t.fields,t.datas))}function c(){var t=[],e=y.read();e.length<=f.slicer?a(r(e)):(s.each(e,function(e,n){t.push(n),e>0&&e%f.slicer===f.slicer-1&&(a(r(t)),t=[])}),t.length&&a(r(t)))}function u(t,e){if(g.table)try{if(window.localStorage&&1===parseInt(window.localStorage.getItem("tdwFlag"),10))for(var n=0,r=e.length;r>n;n++){for(var i={},o=0,a=t.length;a>o;o++)""!==e[n][o]&&(i[t[o]]=e[n][o]);g.table([i])}}catch(c){}}var s=t("jquery"),f={url:"//cgi.pub.qq.com/report/tdw/report",timer:300,beforeRequest:function(){},success:function(){},error:function(){},fail:function(){},slicer:8,table:"",pr_ip:"",pr_t:""},l={},p={},d=[],h=0,g=console||{},y={pool:[],write:function(t){s.isPlainObject(t)?this.pool.push(t):s.isArray(t)&&Array.prototype.push.apply(this.pool,t)},read:function(){var t=this.pool;return this.pool=[],t}};n.exports={config:function(t,e){s.extend(l,t),s.extend(f,e),i(l)},report:function(t){y.write(t),h||(h=setTimeout(function(){c(),h=0},f.timer))},reportSync:function(t,e){e=s.extend({},f,e),a(r(t),e)},composer:r,request:a,getCommonData:function(t){return t?l[t]:l}}});
define("lego_modules/local.data/0.0.1/cross.local",function(){function e(e,n){var i,t=n||{};for(i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function n(e){f[e.id]&&(f[e.id](e),delete f[e.id])}function i(e){var i;try{i=JSON.parse(e.data)}catch(t){}i&&i.namespace===l&&("iframe-ready"===i.id?(s=!0,c.initCallback()):n(i))}function t(e,n,i,t){d++,f[d]=t;var o={namespace:l,id:d,action:e,key:n,value:i};r.contentWindow.postMessage(JSON.stringify(o),"*")}function o(n){c=e(n,c);var t=document.createElement("div");window.addEventListener?window.addEventListener("message",i,!1):window.attachEvent("onmessage",i),t.innerHTML='<iframe id="'+c.iframeId+'" src='+c.iframeUrl+' style="display: none;"></iframe>',document.body.appendChild(t),r=document.getElementById(c.iframeId)}function a(){return u?s?!0:(console.log("需要等iframe ready后才能进行操作."),!1):(console.log("需要先执行 init() 方法再使用."),!1)}var r,l="cross-domain-local-message",c={iframeId:"cross-domain-iframe",iframeUrl:void 0,initCallback:function(){}},d=-1,f={},u=!1,s=!0;return{init:function(e){if(!e.iframeUrl)throw"必须指定iframe的url";return u?void console.log("已经初始化过了"):(u=!0,void("complete"===document.readyState?o(e):window.onload=function(){o(e)}))},set:function(e,n,i){a()&&t("set",e,n,i)},get:function(e,n){a()&&t("get",e,null,n)},remove:function(e,n){a()&&t("remove",e,null,n)},clear:function(e){a()&&t("clear",null,null,e)},filter:function(e,n){if(a()){var i=e.toString().replace(/(^\/)|(\/$)/g,"");t("filter",i,null,n)}},wasInit:function(){return u}}});
define("lego_modules/local.data/0.0.1/power.local",function(e,n,o){function t(e,n){var o,t=n||{};for(o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t}function r(){var e=document.domain,n=u.whiteDomain,o=!1;if(!u.crossDomain)return!1;if(0===n.length)return!1;for(var t=0;t<n.length&&e!==n[t];t++);return t===n.length&&(o=!0),o}function i(e,n){return{get:function(o,t){n?e.get(o,function(e){t&&t(e&&e.value)}):t&&t(e.get(o))},set:function(o,t,r){try{n?e.set(o,t,r):(e.set(o,t),r&&r())}catch(i){"QuotaExceededError"===i.name&&window.BJ_REPORT&&BJ_REPORT.debug({msg:"local-write-overflow",ext:{msid:2514080}})}},remove:function(o,t){n?e.remove(o,t):(e.remove(o),t&&t())},filter:function(o,t){n?e.filter(o,function(e){t&&t(e&&e.value)}):t&&t(e.filter(o))},clear:function(o){n?e.clear(o):(e.clear(),o&&o())},wasInit:function(){return n?e.wasInit():!0},isCross:function(){return n}}}function a(e,n){t(e,u),r()?(l=c,l.init({iframeUrl:u.iframeUrl,initCallback:function(){console.log("iframe inited"),n&&n(i(l,!0))}})):n&&n(i(l))}var l=e("lego_modules/local.data/0.0.1/local.data"),c=e("lego_modules/local.data/0.0.1/cross.local"),u={whiteDomain:[],iframeUrl:"",crossDomain:!1};o.exports={getLocal:a}});
define("lego_modules/tdw-local/0.1.0/tdw-local",function(e,o,n){function t(e,o){if(q.wasInit&&q.wasInit()){var n=o.fields,t=o.datas,a=d.inArray(_.seqName,n);d.each(t,function(e,o){var n=_.localPrefix+o[a];q.remove(n)})}}function a(e,o){d.isPlainObject(e)?o&&o(e):d.isArray(e)&&d.each(e,function(e,n){o&&o(n)})}function i(){return(new Date).getTime()+Math.random().toFixed(17).toString().replace(".","")}function r(){q.filter(v,function(e){for(var o,n=0;n<e.length;n++)o=JSON.parse(e[n].value||"{}"),o.seq_number?(o.datas&&o.datas[0].push("local"),o.fields&&o.fields.push("source_from"),h.request(o)):q.remove(e[n].key)})}function c(){p.getLocal({whiteDomain:_.whiteDomain,iframeUrl:_.crossProxy,crossDomain:_.crossDomain},function(e){q=e,r()})}function s(e){a(e,function(e){e[_.seqName]=i()})}function l(){return g&&g.obj&&null!==g.obj()}function u(e,o){a(e,function(e){o.push(d.extend({seq_number:e[_.seqName]},h.composer(e)))})}function f(e){q.wasInit&&q.wasInit()&&d.each(e,function(e,o){var n=_.localPrefix+o[_.seqName];q.set(n,JSON.stringify(o))})}function m(e){var o=[];s(e),u(e,o),f(o)}var d=e("jquery"),w=e("lego_modules/tdw/0.1.0/tdw"),g=e("lego_modules/local.data/0.0.1/local.data"),p=e("lego_modules/local.data/0.0.1/power.local"),q={},h={},x=l(),_={whiteDomain:[],crossProxy:"",crossDomain:!1,localPrefix:"tdw_seq",seqName:"seq_number"},v=/^tdw_seq/;h.composer=w.composer,h.getCommonData=w.getCommonData,h.config=w.config,h.request=w.request,h.config({},{success:t}),h.report=function(e){m(e),w.report(e)},h.reportSync=function(e,o){m(e),w.reportSync(e,o)},h.initLocal=function(e){d.extend(_,e),v=new RegExp("^"+_.localPrefix),x&&c()},n.exports=h});
define("lego_modules/util.cookie/0.0.3/util.cookie",function(e,o,n){function i(e){var o=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return o?decodeURIComponent(o[2]):""}var t=e("jquery"),o={get:i,set:function(e,o,n,i,t){var u=new Date;u.setTime(u.getTime()+(t?36e5*t:2592e6)),document.cookie=e+"="+o+"; expires="+u.toGMTString()+"; path="+(i?i:"/")+"; "+(n?"domain="+n+";":"")},setSession:function(e,o,n,i){document.cookie=e+"="+o+"; path="+(i?i:"/")+"; "+(n?"domain="+n+";":"")},del:function(e,o,n){document.cookie=e+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; path="+(n?n:"/")+"; "+(o?"domain="+o+";":"")},clear:function(){var e=document.cookie.match(new RegExp("([^ ;][^;]*)(?=(=[^;]*)(;|$))","gi"));for(var o in e)document.cookie=e[o]+"=;expires=Mon, 26 Jul 1997 05:00:00 GMT; path=/; "},uin:function(){var e;return 2==i("uid_type")?i("uid_uin")||null:(e=i("p_uin")||i("uin")||i("pt2gguin")||i("adid"),e=e?parseInt(e.substring(1,e.length),10):null,e=e||parseInt(i("uin_cookie"),10)||null)}};t.cookie=o,t.reset_own_cookie=function(){t.cookie=o},n.exports=o});
define("lego_modules/report.cookie/0.0.2/report.from",function(e,o,t){function i(e){var o=!a.get(n.name);setTimeout(function(){console.log(e.getReportData());var t={action:"From"};o&&(t.ver7=e.getReportData().ver4||"4"),e.tdw(t),a.setSession(n.name,1,n.domain,n.path)},0)}var a=e("lego_modules/util.cookie/0.0.3/util.cookie"),n={name:"tdw_first_visited",domain:"ke.qq.com",path:"/"};t.exports=i});
define("lego_modules/edu-report/0.0.3/edu-report",function(o,e,t){var r=o("lego_modules/tdw-local/0.1.0/tdw-local"),n=o("jquery"),c=o("lego_modules/report.cookie/0.0.2/report.from"),i={};r.config({opername:"Edu"},{table:"dc00149",pr_ip:"obj3",pr_t:"ts",slicer:3}),r.initLocal&&r.initLocal({whiteDomain:["ke.qq.com"],crossProxy:"//ke.qq.com/storage_proxy.html",crossDomain:!0}),i.tdw=function(o,e){r[e?"reportSync":"report"](o)},i.toreport=function(){},i.config=function(o){r.config(n.extend({},o||{}))},i.getReportData=r.getCommonData,c(i),t.exports=i});
define("modules/lib/report.tdw",function(e,o,r){var d=e("lego_modules/edu-report/0.0.3/edu-report");r.exports=d});
define("pages/index/credits",function(t,e,o){"use strict";function n(){}function i(t){var e=y.getHash("taid"),o=y.getHash("vid"),n=(5===t.type?1:2,["vplayer","history",u.cookie.uin(),o,e,5===t.type?1:2].join("_"));return parseInt(p.get(n),10)}function a(t,e){var o="",n=i(t),a=Math.floor(t.timelen/60),r=0;return Math.floor(e.today_study_duration/60)>=e.credits_day_limit?"太棒啦，已获得今日全部积分奖励。":(a>0&&(n>0?(a=Math.floor((t.timelen-n)/60),r=Math.min(e.credits_day_limit-e.today_study_credits,a)||0,o=["本节剩余",a,"分钟，完成可获得",r,"积分奖励。"].join("")):(r=Math.min(e.credits_day_limit-e.today_study_credits,a)||0,o=["本节时长",a,"分钟，完成可获得",r,"积分奖励。"].join(""))),o)}function r(t,e){var o="";return o=e.today_study_credits===e.credits_day_limit?"太棒啦，已获得今日全部积分奖励。":"加油，完成本节学习可获得积分奖励哦。"}function s(t,e){var o=0,n=0;window.onbeforeunload=function(i){i=i||window.event;var a=Math.min(e.credits_day_limit-e.today_study_credits,Math.floor(o/60)),r=Math.floor((t.timelen-n)/60),s=Math.min(e.credits_day_limit-e.today_study_credits-a,r);if(o>60&&t.timelen-n>60&&s>0){_.tdw({action:"expo_leave"});var d=["已完成学习",Math.floor(o/60),"分钟，获得",a,"积分，坚持完成学习可额外获得",s,"积分哦~是否再坚持一会？"].join("");return i&&(i.returnValue=d),d}},m.on("vplayer.play_data",function(t,e){o+=e.duration,n=e.watch_pos})}function d(t){l?c(t):f.getCreditsInfo({platform:3}).done(function(e){l=e,c(t)}).fail(function(){})}function c(t){var e="";2===t.type||5===t.type?(e=a(t,l),s(t,l)):1===t.type&&(e=r(t,l)),e&&h.show({content:e})}var l,u=t("jquery"),p=t("lego_modules/local.data/0.0.1/local.data"),y=t("lego_modules/util.bom/0.0.1/util.bom"),f=t("pages/index/db.index"),_=(t("modules/lib/login"),t("modules/lib/report.tdw")),m=u(document),v={type:"success",content:"",tpl:'<div class="js-cus-toast cus-toast"><i class="icon-font i-{type}" style="font-size:24px;"></i><span style="margin-left: 7px;color: #000;font-size: 14px;">{content}</span></div>',tplFn:function(t,e){return t.replace("{type}",e.type).replace("{content}",e.content)},$container:u("body"),duration:3e3,position:{left:20,bottom:70}};u.extend(n.prototype,{show:function(t){t=u.extend({},v,t),this.remove(t);var e=this,o=t.$container,n=t.tplFn(t.tpl,t),i=o.append(n);i.find(".js-cus-toast").css(t.position).show(),setTimeout(function(){e.remove.call(e,t)},t.duration)},remove:function(){u(".js-cus-toast").remove()}});var h=new n;o.exports={init:d}});
define("lego_modules/report.cookie/0.0.2/report.common",function(e,r,o){var n,t,i,m,a,d=e("jquery"),f=e("lego_modules/util.bom/0.0.1/util.bom"),u=document,_=window.location,p=["28","63","64","17"],c=f.parseQuery(_.search),g={origin:u.referrer};if(g.origin&&(g=d.extend(g,f.parseHref(g.origin))),c.from=c.from||f.getHash("from")||"",c.tuin=f.getHash("tuin")||"",c.qz_gdt&&(c.from="17",c._pos&&c._landpage)){c.keyword="gdt={qz_gdt}&".replace("{qz_gdt}",c.qz_gdt);var l=["_pos","_landpage","_cate","_type1","_type2","_type3"],s=[];d.each(l,function(e,r){var o=c[r];o&&s.push(r+"="+o)}),c.keyword+=s.join("&")}d.inArray(c.from,p)>-1?n=c.from:(/ke\.qq\.com$/.test(g.domain)?i=c.from:g.domain?(n=g.domain,a=g.domain):c.from?n=c.from:c.tuin&&(n=146),"undefined"==typeof i&&(m=c.from)),o.exports=function(e){return t=c.keyword?c.keyword:n===e.ver4?e.ver5:"",n=n||e.ver4||"4",i=i||e.ver6||"",a=a||e.refer||"",m=m||e.from_channel||"",{ver4:n,ver5:t,ver6:i,refer:a,from_channel:m}}});
define("lego_modules/report.cookie/0.0.2/report.path",function(e,n,t){function i(e){var n=Q.parseHref(e).domain;return!!/(\.|^)ke\.qq\.com$/.test(n)}function r(e){var n,t;if(n=e.match(W),t=n&&n.length&&n[1],J===e||t){if(t&&!b("label_filter"))return nn.word;for(var i in nn)if(b(i))return nn[i];return"b"}}function o(e){var n,t,i,r=e;return"B"===en[r]?(n=b("sid"),t={plan:"B",feeds:"C",signup:"D",fav:"E",coupon:"F"},i=t[n],i?i:"B"):void 0}function a(e,n){return N.test(n)?"m":void 0}function c(e){return S.test(e)?"o":T.test(e)?"p":void 0}function u(e){var n;return M==G&&(e=e.replace(/\d/g,""),n=Z[e])?E._isApply?n+tn:n:void 0}function s(e){var n;return M==G&&(e=e.replace(/\d/g,""),n=Y[e])?n:void 0}function f(){for(var e,n=[s,u,r,a,c,o],t=0,i=n.length;i>t&&!(e=n[t].call(this,R,M));t++);return e||X}function l(){return E._pageCode}function d(e,n){return n.length>100?n=n.substring(0,100):v(e,n),n}function p(){var e=x(F);return e||h(),x(F)}function h(){v(F,Math.random(),P,I,2)}function m(){var e=l()+f()+tn;return E._isApply=1,y(z,E._isApply),y(U,e),[e,p()].join("-")}function b(e){return L.bom.query(e)||L.bom.getHash(e)}function g(e,n){"string"==typeof n&&(n=[n]);for(var t=Q.parseHref(e).search,i=Q.parseQuery(t),r=0,o=n.length;o>r;++r)n[r]&&delete i[n[r]];return L.param(i)}function v(e,n,t,i,r){e&&(t=t||P,i=i||I,r=r||K,D.set($+e,n,t,i,r))}function x(e){return D.get($+e)}function _(e,n,t){e&&(n=n||P,t=t||I,D.del($+e,n,t))}function y(e,n){var t=window.name,i=Q.parseQuery(t);i[e]=encodeURIComponent(n),window.name=L.param(i)}function j(e){var n=window.name,t=Q.parseQuery(n);return Q.htmlEncode(decodeURIComponent(t[e]||""))}function k(){E._pageCode="",E._isApply=0;var e=U+q();i(V)&&(E._pageCode=x(e)),E._pageCode?y(U,E._pageCode):(E._pageCode=j(U),E._isApply=j(z)),_(e)}function w(e){return e&&e.replace(/[()\\\/?.$&:=#;]/g,"")||""}function q(){return w([M,R,g(location.search,"from"),location.hash].join(""))}function C(e){var n=document.createElement("a");return n.href=e,e=n.href,e.replace(/^https?:/,"")}function A(e,n,t){var i=e[n]||"";return i+g(t,[n,"from"])}function O(e){e=C(e);var n=Q.parseHref(e),t=n.domain,i=n.pathname,r=n.hash;if(t!==G)return w([t,i,g(e,"from"),r].join(""));var o,a=Q.parseQuery(n.search),c="";return 0===i.indexOf("/cgi-bin/courseDetail")?(o=A(a,"course_id",e),c=["/course/",o].join("")):0===i.indexOf("/cgi-bin/teacher")?(o=A(a,"tid",e),c=["/teacher/",o].join("")):0===i.indexOf("/cgi-bin/bbs/xbar_info")?(o=A(a,"bid",e),c=["/bbs/tuan/",o].join("")):0===i.indexOf("/cgi-bin/bbs/posts/post_detail")?(o=A(a,"pid",e),c=["/bbs/topic/",o].join("")):0===i.indexOf("/cgi-bin/courseList")?(o=A(a,"word",e),c=["/course/list/",o].join("")):c=[i,g(e,"from")].join(""),w([t,c,r].join(""))}function H(e){var n=U+O(e);d(n,E._pageCode+f())}function B(){L(document).on("click","a[href]",function(){var e=L(this),n=e.attr("href");n&&0!==n.indexOf("javascript")&&0!==n.indexOf("#")&&H(n)})}var L=e("jquery"),Q=e("lego_modules/util.bom/0.0.1/util.bom"),D=e("lego_modules/util.cookie/0.0.3/util.cookie"),E={},$="_",I="",K=.05,M=location.host,R=location.pathname,U=(location.href,"path"),z="isapply",F="pathcode",P="ke.qq.com",V=document.referrer,G="ke.qq.com",J="/course/list",N=/^([a-z])+\.ke\.qq\.com/,S=/^\/huodong\//,T=/^\/activity\//,W=/^\/course\/list\/([^\/]*)\/*$/,X="r",Y={"/":"a","/index.html":"a","/cgi-bin/index":"a","/activity/list/index.html":"i","/bbs/":"j","/bbs/index.html":"j","/cgi-bin/bbs/xbar_info":"k","/cgi-bin/agency":"m","/cgi-bin/bbs/posts/post_detail":"l","/cgi-bin/teacher":"n","/user/tasks/index.html":"u","/exam/index.html":"w","/cgi-bin/ke_graph":"K","/cgi-bin/ke_graph/courseList":"L","/webcourse/index.html":"v","/course/package/":"M","/teacher/":"n","/bbs/tuan/":"k","/bbs/topic/-":"l","/tupu/":"K","/tupu//course":"L","/agency/index/":"t","/exam/web.html":"w","/cates/kaoyanVplan/index.html":"q","/cates/ielts_v2/index.html":"x","/cates/fltrp/index.html":"y"},Z={"/cgi-bin/courseDetail":"h","/course/":"h"},en={"/user/index/index.html":"B"},nn={label_filter:"c",word:"d",tt:"g",st:"f",mt:"e"},tn="A";L(document).on("logout",function(){_(U),_(F)}),k(),B();var rn=function(){var e=l()+f(),n=p();return{path:[e,n].join("-")}}();t.exports={path:rn,injectHrefAction:H,getApplyPath:m}});
define("lego_modules/report.cookie/0.0.2/report.cookie",function(e,o,t){function r(e){u.isPlainObject(e)&&(e=JSON.stringify(e)),p.setSession(m.name,e,m.domain,m.path)}function i(){var e=p.get(m.name);return e?JSON.parse(e):{}}var n,a,u=e("jquery"),d=e("lego_modules/edu-report/0.0.3/edu-report"),p=e("lego_modules/util.cookie/0.0.3/util.cookie"),l=e("lego_modules/report.cookie/0.0.2/report.common"),c=e("lego_modules/report.cookie/0.0.2/report.path"),m={name:"tdw_data",domain:"ke.qq.com",path:"/"};a=i(),n=u.extend({},l(a||{}),c.path),n.uin=p.uin(),d.config(n),r(n),delete c.path,u.extend(d,c),t.exports=d});
define("modules/lib/util.cookie",function(e,n){var t=e("jquery"),n={get:function(e){var n=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return n?decodeURIComponent(n[2]):""},set:function(e,n,t,o,i){var u=new Date;u.setTime(u.getTime()+(i?36e5*i:2592e6)),document.cookie=e+"="+n+"; expires="+u.toGMTString()+"; path="+(o?o:"/")+"; "+(t?"domain="+t+";":"")},del:function(e,n,t){document.cookie=e+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; path="+(t?t:"/")+"; "+(n?"domain="+n+";":"")},clear:function(){var e=document.cookie.match(new RegExp("([^ ;][^;]*)(?=(=[^;]*)(;|$))","gi"));for(var n in e)document.cookie=e[n]+"=;expires=Mon, 26 Jul 1997 05:00:00 GMT; path=/; "},uin:function(){var e;return 2==this.get("uid_type")?this.get("uid_uin")||null:(e=this.get("p_uin")||this.get("uin"),e?parseInt(e.substring(1,e.length),10):null)}};return t.cookie=n,t.reset_own_cookie=function(){t.cookie=n},n});
define("modules/lib/promise",function(t,e,n){function o(){}function r(t,e){return function(){t.apply(e,arguments)}}function i(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function f(t,e){for(;3===t._state;)t=t._value;return 0===t._state?void t._deferreds.push(e):(t._handled=!0,void h(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._state?u:c)(e.promise,t._value);var o;try{o=n(t._value)}catch(r){return void c(e.promise,r)}u(e.promise,o)}))}function u(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void s(t);if("function"==typeof n)return void l(r(n,e),t)}t._state=1,t._value=e,s(t)}catch(o){c(t,o)}}function c(t,e){t._state=2,t._value=e,s(t)}function s(t){2===t._state&&0===t._deferreds.length&&h(function(){t._handled||p(t._value)});for(var e=0,n=t._deferreds.length;n>e;e++)f(t,t._deferreds[e]);t._deferreds=null}function a(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function l(t,e){var n=!1;try{t(function(t){n||(n=!0,u(e,t))},function(t){n||(n=!0,c(e,t))})}catch(o){if(n)return;n=!0,c(e,o)}}var d=setTimeout,h="function"==typeof setImmediate&&setImmediate||function(t){d(t,0)},p=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t,t.stack)};i.prototype["catch"]=function(t){return this.then(null,t)},i.prototype.then=function(t,e){var n=new this.constructor(o);return f(this,new a(t,e,n)),n},i.all=function(t){var e=Array.prototype.slice.call(t);return new i(function(t,n){function o(i,f){try{if(f&&("object"==typeof f||"function"==typeof f)){var u=f.then;if("function"==typeof u)return void u.call(f,function(t){o(i,t)},n)}e[i]=f,0===--r&&t(e)}catch(c){n(c)}}if(0===e.length)return t([]);for(var r=e.length,i=0;i<e.length;i++)o(i,e[i])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(t){return new i(function(e,n){n(t)})},i.race=function(t){return new i(function(e,n){for(var o=0,r=t.length;r>o;o++)t[o].then(e,n)})},i._setImmediateFn=function(t){h=t},i._setUnhandledRejectionFn=function(t){p=t},n.exports=i});
define("lego_modules/tx-monitor/0.0.4/index",function(t,o,n){!function(t,o){var e=o();"object"==typeof n&&n&&n.exports?n.exports=e||n.exports:(t.Q=t.Q||{},t.Q.monitor=e.monitor)}(window,function(){var t={url:"http://cgi.connect.qq.com/report/report_vm",delay:30},o=[],n=function(t){return t&&"[object Array]"===Object.prototype.toString.call(t)},e=function(){o.length&&((new Image).src=t.url+"?monitors=["+o.join(",")+"]&_t="+(new Date).getTime(),o=[])},r=function(r){if(r){if(n(r))for(var i in r)r[i]&&o.push(r[i]);else o.push(r);setTimeout(function(){e()},t.delay)}};return{cfg:t,monitor:r}})});
define("pages/index/report.index",function(e,o,t){"use strict";function n(){this.keHeader.$on("MenuClick.report",function(e){i.tdw(c.extend(e,{action:"MenuClick"}))}).$on("ContactClick.report",function(e){i.tdw(c.extend(e,{action:"ContactClick"}))}).$on("ReportClick.report",function(e){i.tdw(c.extend(e,{action:"ReportClick"}))}).$on("CommentClick.report",function(e){i.tdw(c.extend(e,{action:"CommentClick"}))}).$on("TitleClick.report",function(e){i.tdw(c.extend(e,{action:"TitleClick"}))}).$on("CourseShare.report",function(e){i.tdw(c.extend(e,{action:"CourseShare"}))}).$on("CaptureClick.report",function(e){i.tdw(c.extend(e,{action:"CaptureClick"}))}).$on("ReplayClickHoldLauch.report",function(e){i.tdw(c.extend(e,{action:"ReplayClickHoldLauch"}))}).$on("MissionClick.report",function(e){i.tdw(c.extend(e,{action:"MissionClick"})),b.notLive=!0}).$on("playerheader.feedback",function(){i.tdw({action:"SuggestionClick"})}).$on("playerheader.enterRoom",function(){i.tdw({action:"ReturnToOldClick"})}).$on("SignClick.report",function(){var e=this.taskInfo||{};i.tdw({action:"sign_after_try",ver1:e.cid,ver2:e.tid,ver3:e.taid,ver5:e.type,ver7:e.status,obj1:this.tryBeginTime,obj2:+new Date})}.bind(this)),this.kePagelive.keChat.$on("chat.fail",function(){i.tdw({action:"chatSocketDisconnect"})}).$on("chat.firstConnect",function(){i.tdw({action:"chatEnter"})}).$on("chat.selectTab",function(e){0===e?i.tdw({action:"DiscussClick"}):1===e&&i.tdw({action:"MenberlistClick"})}).$on("face.show",function(){i.tdw({action:"ExpressionClick",obj1:1})}).$on("face.hide",function(){i.tdw({action:"ExpressionClick",obj1:2})}).$on("chattoolbar.upload",function(){i.tdw({action:"ImageClick"})}).$on("chattoolbar.flower",function(){i.tdw({action:"FlowerClick"})}).$on("chattoolbar.onlyTeacher",function(e){i.tdw(e?{action:"TeacheronlyClick",obj1:1}:{action:"TeacheronlyClick",obj1:2})}).$on("chattoolbar.addGroup",function(){i.tdw({action:"AddgroupiconClick"})}).$on("editor.submit",function(){i.tdw({action:"SendmessageClick"})}).$on("notice.click",function(){i.tdw({action:"PublicmessageClick"})}).$on("enterRoom.before",function(){k({action:"request_interface_before",obj1:window._Tlive?new Date-window._Tlive:1}),b.notLive=!1,u.exitFlag="request_interface_before"}).$on("enterRoom.succ",function(e){k({action:"request_interface_ips",obj1:window._Tlive?new Date-window._Tlive:1,ver5:e.retcode}),u.exitFlag="request_interface_ips"}).$on("enterRoom.fail",function(e){k({action:"request_interface_fail",obj1:window._Tlive?new Date-window._Tlive:1,ver5:e.retcode}),u.exitFlag="request_interface_fail"}).$on("getAttend.before",function(){k({action:"get_attend_ts_before",obj1:window._Tlive?new Date-window._Tlive:1})}).$on("getAttend.succ",function(){k({action:"get_attend_ts_succ",obj1:window._Tlive?new Date-window._Tlive:1})}).$on("getAttend.fail",function(){k({action:"get_attend_ts_fail",obj1:window._Tlive?new Date-window._Tlive:1})}).$on("saveTcpList",function(e){u.ver5=e.tcpList instanceof Array?e.tcpList.join(","):""}).$on("liveClass.start",function(){k({action:"liveClass_start",obj1:window._Tlive?new Date-window._Tlive:1}),u.exitFlag="liveClass_start"}).$on("chat.attendClass",function(e){_.subcmd=e}).$on("chatlist.imgviewer_click",function(){k({action:"imgviewer_click",obj1:f.cid})}).$on("notice.recom_course_expo",function(e){k({action:"recom_course_expo",obj1:e.recommendcid})}).$on("notice.recom_course_click",function(e){k({action:"recom_course_click",obj1:e.recommendcid})}).$on("notice.coupon_expo",function(e){i.tdw({action:"coupon_expo",obj1:e})}).$on("notice.coupon_click",function(e){i.tdw({action:"coupon_click",obj1:e})}).$on("notice.coupon_claim_expo",function(e){i.tdw({action:"coupon_claim_expo",obj1:e})}).$on("notice.coupon_claim_succ",function(e){i.tdw({action:"coupon_claim_succ",obj1:e})}).$on("notice.coupon_claim_fail",function(e){i.tdw({action:"coupon_claim_fail",obj1:e})}).$on("notice.coupon_expo_time",function(e){console.log("notice.coupon_expo_time2"),i.tdw({action:"coupon_expo_time",obj1:e.couponId,obj2:e.time})}),this.kePagelive.kePlayer.$on("flash.log",function(e,o){if(!(window._Tlive&&new Date-window._Tlive>864e5)){var t=e&&e.obj&&e.obj.network,n=e&&e.obj&&e.obj.videoType,a=e&&e.msg;switch(e.code){case 601:1===_.subcmd&&f&&1===f.type&&(i.tdw({action:"flashSocketDisconnect",obj1:a}),u.exitFlag="flashSocketDisconnect",window.BJ_REPORT.info("socketDisconnect|"+a));break;case 602:i.tdw({action:"flashVersion",obj1:a});break;case 604:i.tdw({action:"FullscreenClick",obj1:a});break;case 605:i.tdw({action:"VideoSettingClick"});break;case 606:i.tdw({action:"ChooseVideoClick",obj1:a});break;case 607:i.tdw({action:"VolumeClick",obj1:a});break;case 608:i.tdw({action:"SignalHover"});break;case 609:i.tdw({action:"TimeHover"});break;case 610:k({action:"canPlay",obj1:window._Tlive?new Date-window._Tlive-Number(a):1}),b.firstFrame=2;break;case 611:k({action:"flashEnter",obj1:window._Tlive?new Date-window._Tlive:1}),u.exitFlag="flashEnter";break;case 612:k({action:"getStream",obj1:window._Tlive?new Date-window._Tlive:1}),u.exitFlag="getStream";break;case 613:i.tdw({action:"StreamQulity",obj1:a});break;case 614:k({action:"beforeSocketConnect",obj1:window._Tlive?new Date-window._Tlive:1}),u.exitFlag="beforeSocketConnect";break;case 615:i.tdw({action:"flashEnterError"});break;case 616:k({action:"loaderSwfFinish",obj1:window._Tlive?new Date-window._Tlive:1});break;case 617:k({action:"keplayerSwfFinish",obj1:window._Tlive?new Date-window._Tlive:1});break;case 618:var c=h()-g;c=c>20?20:c,i.tdw({module:"WebLive",action:"time_duration",obj1:l.agencytype,ver9:r.getUrlParam("taid"),ver3:Math.round(c),ver7:o?"0":"1"}),g+=c;break;case 619:k({action:"sdkSwfFinish",obj1:window._Tlive?new Date-window._Tlive:1});break;case 620:i.tdw({action:"multiFlashPlayer"});break;case 621:k({action:"sleepMode",obj1:window._Tlive?new Date-window._Tlive:1});break;case 622:k({action:"hasHeartBeat",obj1:window._Tlive?new Date-window._Tlive:1});break;case 623:i.tdw({action:"pip_exposure"});break;case 624:i.tdw({action:"pip_click_close"});break;case 625:i.tdw({action:"pip_click_open"});break;case 626:i.tdw({action:"pip_click_switch"});break;case 701:p(e.msg,2520478);break;case 702:window.BJ_REPORT.info(e.msg);break;case 801:p(e.meg,2563445),k({action:"connect_interface_fail",ver4:t,ver6:n,obj1:window._Tlive?new Date-window._Tlive:1,ver5:u.obj2}),u.exitFlag="connect_interface_fail";break;case 802:i.tdw({action:"av_room_disconnect",ver4:t,ver6:n,ver5:u.obj2});break;case 803:k({action:"request_video",ver4:t,ver6:n,obj1:window._Tlive?new Date-window._Tlive:1,ver5:u.obj2}),u.exitFlag="request_video";break;case 804:k({action:"request_video_success",ver4:t,ver6:n,obj1:window._Tlive?new Date-window._Tlive:1,ver5:u.obj2}),u.exitFlag="request_video_success";break;case 805:k({action:"enter_av_room_success",ver4:t,ver6:n,obj1:window._Tlive?new Date-window._Tlive:1,ver5:u.obj2}),u.exitFlag="enter_av_room_success";break;case 806:i.tdw({action:"lost_frame_rate",ver4:t,ver5:e.obj.rate,ver6:n,obj2:u.obj2});break;case 807:i.tdw({action:"repeat_pack_rate",ver4:t,ver5:e.obj.rate,ver6:n,obj2:u.obj2});break;case 808:i.tdw({action:"lost_package_rate",ver4:t,ver5:e.obj.rate,ver6:n,obj2:u.obj2});break;case 809:i.tdw({action:"maxSpanInjitter",ver4:t,ver5:e.obj.value,ver6:n,obj2:u.obj2});break;case 810:k({action:"socketConnectSucc",obj1:window._Tlive?new Date-window._Tlive:1,ver5:u.obj2}),u.exitFlag="socketConnectSucc";break;case 811:k({action:"sdkFirstHead",obj1:window._Tlive?new Date-window._Tlive:1}),u.exitFlag="sdkFirstHead";break;case 812:k({action:"sdkSecondHead",obj1:window._Tlive?new Date-window._Tlive-Number(a):1}),u.exitFlag="sdkSecondHead";break;case 814:i.tdw({action:"droppedRate",obj1:a});break;case 816:i.tdw({action:"seqNo",obj1:a});break;case 818:i.tdw({action:"ping",obj1:a});break;case 819:i.tdw({action:"socketConnectUseTime",obj1:a});break;case 820:i.tdw({action:"changeStatusUseTime",obj1:a});break;case 821:i.tdw({action:"changeStatusToFirstVideoPakUseTime",obj1:a});break;case 822:i.tdw({action:"changeStatusToFirstAudioPakUseTime",obj1:a});break;case 823:i.tdw({action:"firstKeyFramePkg",obj1:window._Tlive?new Date-window._Tlive:1});break;case 824:k({action:"enter_av_room_error",obj1:window._Tlive?new Date-window._Tlive:1});break;case 901:case 902:b.firstFrame=a;break;case 903:k({action:"firstVideoPak",obj1:window._Tlive?new Date-window._Tlive:1});break;case 904:k({action:"firstAudioPak",obj1:window._Tlive?new Date-window._Tlive:1});break;case 905:i.tdw({action:"firstFrameType",obj1:a})}}}),this.kePagelive.kePlayer.$on("flash.flashChecker",function(e){i.tdw({action:"flashChecker",obj1:e.f?"是":"否",ver5:e.v})}).$on("flash.offlineStatus",function(e){j({action:"offlineStatus",obj1:e})}).$on("player.flashLoaded",function(){k({action:"flashLoaded",obj1:window._Tlive?new Date-window._Tlive:1})}).$on("flash.taskInfo.live",function(e){f=e}).$on("flash.web2liveTime",function(){var e=new Date-window._T[0];e>1e4||j({action:"web2LiveTime",obj1:e})}),this.kePageRecorded.keVplayer.$on("vplayer.web2ReplayTime",function(){var e=new Date-window._T[0];e>1e4||j({action:"web2ReplayTime",obj1:e})}),this.kePageRecorded.kePaused.$on("paused.show",function(){i.tdw({action:"paused_appQRcode_show"})}).$on("paused.close",function(){i.tdw({action:"paused_appQRcode_close"})}).$on("noMoreShow.enable",function(){i.tdw({action:"paused_noMoreShow"})}),this.keCover.$on("cover.payButtonClick",function(){i.tdw({action:"buy2-clk"})}),c(window).on("beforeunload",function(e,o){if((!+b.notLive||o)&&2!==+b.firstFrame){var t=window._Tlive?new Date-window._Tlive:1;2e3>t&&i.tdw({action:"close_in_2second",obj1:t,ver6:u.exitFlag},!0),i.tdw({action:"close_before_i_frame",obj1:t,ver5:u.obj2,ver6:u.exitFlag},!0)}}),window._T&&i.tdw({action:"pagespeed",obj1:window._T[3]-window._T[0]}),i.tdw({action:"Exposure",obj1:navigator.userAgent})}var i=e("modules/lib/report.tdw");e("lego_modules/report.cookie/0.0.2/report.cookie");var a=e("modules/lib/util.cookie"),c=e("jquery"),r=e("modules/lib/util"),s=e("modules/lib/promise"),w=e("badjs"),d=e("lego_modules/tx-monitor/0.0.4/index"),l=null,b={firstFrame:0,notLive:!0},u={browserType:"",browserVersion:"",exitFlag:"newPage"},_={subcmd:0},f=null,v=function(){return new s(function(e){var o=function t(){null!==f?e(f):setTimeout(t,20)};o()})},k=function(e){return v().then(function(o){o.type&&1===o.type&&i.tdw(e)})},p=function(e,o){w(e,location.href,0,o,1)},m=function(e){d.monitor(e)},T=function(){var e={};return function(o){e[o.action]||(e[o.action]=!0,i.tdw(o))}},j=T();!function(){var e=navigator.userAgent;/chrome/.test(e.toLowerCase())?(u.browserType="chrome",u.browserVersion=e.match(/chrome\/(.*?)\s/i)&&e.match(/chrome\/(.*?)\s/i)[1]):/trident/.test(e.toLowerCase())?(u.browserType="ie",u.browserVersion=/like Gecko/i.test(e)?"11.0":e.match(/msie\s*(.*?);/i)&&e.match(/msie\s*(.*?);/i)[1]):/firefox/.test(e.toLowerCase())?(u.browserType="firefox",u.browserVersion=e.match(/firefox\/(.*)$/i)&&e.match(/firefox\/(.*)$/i)[1]):/safari/.test(e.toLowerCase())?(u.browserType="safari",u.browserVersion=e.match(/safari\/(.*?)$/i)&&e.match(/safari\/(.*?)$/i)[1]):u.browserType=e}(),i.config({module:"WebClass",opername:"Edu",obj2:(new Date).getTime()+Math.random().toString().replace(".",""),ver1:r.getUrlParam("course_id"),ver2:r.getUrlParam("term_id"),ver3:navigator.platform,uin:a.uin(),ver8:u.browserType+u.browserVersion,ver9:"https:"===location.protocol?"1":"0"});var h=function(){return parseInt((new Date).getTime()/1e3,10)},g=h();n.beforeunload=function(){i.tdw({action:"beforeunload",obj1:navigator.userAgent})},n.beforeSetFlashvars=function(){i.tdw({action:"beforeSetFlashvars",obj1:window._Tlive?new Date-window._Tlive:1,ver3:new Date-0,ver4:window._Tlive||new Date,ver5:window._T[4]},!0)},n.flashLoaded=function(){+b.notLive||i.tdw({action:"flashLoaded",obj1:new Date-window._T[4]},!0)},n.exprReport=function(e,o){i.tdw({action:"audition-count",ver5:o}),i.tdw({action:"audition-exposure"})},n.showPayCover=function(e){i.tdw({action:"showPayCover",obj1:e.term.payStatus,ver5:e.courseInfo.passcard_status,ver6:e.taskInfo.type})},n.setCourseData=function(e){l=e},n.reportGetTermApplyInfo=function(e){i.tdw({action:"getTermApplyInfo",obj1:e})},n.reportMonitor=p,n.monitor=m,t.exports=n});
define("pages/index/report.edulog",function(e,r,o){"use strict";function i(){function e(e,r,o,i){d({action:"liveErr",ver3:e,ver4:r,ver5:o,ver6:i})}this.kePageRecorded.keVplayer.$on("vplayer.videoOK",function(){d({action:"videoOK",ver3:0,ver5:4,ver6:""})}).$on("vplayer.videoErr",function(e){d({action:"videoErr",ver3:Math.abs(e.code),ver4:Math.abs(JSON.stringify(e)),ver5:1,ver6:"vplayer.config.onerror"})}),this.kePagelive.kePlayer.$on("flash.log",function(r){switch(r.code){case 610:d({action:"liveOK",ver3:0,ver5:4,ver6:"canPlay"});break;case 601:e(601,"flashSocketDisconnect",2,"");break;case 801:e(801,"connect_interface_fail",1,"");break;case 802:e(802,"av_room_disconnect",2,"")}})}var n=e("modules/lib/report.tdw").tdw,t=e("jquery"),a=e("modules/lib/util.cookie"),c=e("modules/lib/util"),v=c.getHash("course_id")||c.query("course_id"),s=c.getHash("term_id")||c.query("term_id"),d=function(e){return n(t.extend(e,{opername:"EduLog",module:"WebClass",ver1:v,ver2:s,uin:a.uin()}))};o.exports=i});
define("modules/lib/third",function(i,t,n){function e(i,t){return void 0===t?f[i]:void(f[i]=t)}function d(i,t){return i="string"==typeof i?r.find(i)[0]:i,r.data(i,"third-inst",t)}function o(i,t,n){i="string"==typeof i?r.find(i)[0]:i,this.el=i,this.vm=n||new s,r.extend(this,t),d(i,this),this.bind()}var s=i("lego_modules/imweb-qjs/2.0.0/index"),r=s._,f={};r.extend(o,{key:e,get:d}),n.exports=o});
define("modules/lib/Q",function(t){var e=t("lego_modules/imweb-qjs/2.0.0/index"),i=t("modules/lib/third"),n=e.options.directives,r=e.options.filters;return window.console=window.console||function(){var t={};return t.log=t.warn=t.debug=t.info=t.error=t.time=t.dir=t.profile=t.clear=t.exception=t.tract=t.assert=function(){},t}(),n.third={bind:function(){var t=i.key(this.target);if(!t)throw new Error("third party component: "+this.target+" is not defined");var e=this.el.getAttribute("q-ref");t=new i(this.el,t,this.vm),e&&(this.vm.$[e]=t),this.setting.stop=!0}},r["!"]=function(t){return!t},r.sendParam=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){t.apply(this,e)}},r.notEmpty=function(t){return!!t},e});
define("pages/index/main",function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}{var s=e("lego_modules/imweb-base-qjs/0.1.1/src/controller"),c=i(s),d=e("modules/lib/util"),l=e("jquery"),u=e("pages/index/db.index"),h=e("modules/lib/login"),f=e("lego_modules/observer/0.0.1/observer"),p=e("lego_modules/local.data/0.0.1/local.data"),g=e("modules/lib/timing"),m=e("pages/index/credits"),k=e("pages/index/report.index"),y=e("pages/index/report.edulog"),v=e("modules/lib/promise"),I=e("lego_modules/util.bom/0.0.1/util.bom");e("modules/lib/Q")}g.report("7832-75-1");var P=function(e){function t(){n(this,t);var o=r(this,e.call(this));return o.webFlagBit=1,o.clientFlagBit=0,o.components={keHeader:"#ke-header",dialogMsg:"#dialog-msg",keFeedbackBox:"#ke-feedbacktip",kePagelive:"#ke-pagelive",kePageRecorded:"#ke-pagerecorded",kePageExam:"#ke-pageexam",kePageMaterial:"#ke-pagematerial",keGuide:"#ke-guide",keCover:"#ke-cover",keLoading:"#ke-loading"},o.reportIndex=k,o.reportEduLog=y,o}return a(t,e),t.prototype.init=function(e){this._init(e),this._authUrlParam(),this.serverTime=0,this._clientFix(),this._initInfo(),h.init({closeIcon:!1})},t.prototype._authUrlParam=function(){this._patchUrl(),this.courseId=~~d.getUrlParam("course_id"),this.termId=~~d.getUrlParam("term_id"),this.taid=~~d.getUrlParam("taid")||p.get(h.uin())&&JSON.parse(p.get(h.uin())).taid,!(this.courseId&&this.termId&&this.taid||!this._fail(1))},t.prototype._patchUrl=function(){var e=p.get(h.uin())&&JSON.parse(p.get(h.uin()));e&&(d.getUrlParam("taid")||d.getUrlParam("vid")||(location.href+="&taid="+e.taid,location.href+="&vid="+e.vid))},t.prototype.getCourseInfoPromise=function(e){return new v(function(t,o){u.getCourseInfo({cid:e}).done(function(e){t(e)}).fail(function(){o()})})},t.prototype.getTermsDetailPromise=function(e,t){return new v(function(o,i){u.getTermsDetail({cid:e,term_id_list:JSON.stringify([t])}).done(function(e){o(e)}).fail(function(){i()})})},t.prototype.getTermApplyInfoPromise=function(e){var t=new Date,o=this;return new v(function(i,n){u.getTermApplyInfo({term_id:e}).done(function(e){o.reportIndex.reportGetTermApplyInfo(new Date-t),i(e)}).fail(function(){n()})})},t.prototype.isRtmp=function(e){var t=this,o="number"==typeof e?e:t.taskInfo.streamBitFlag,i="number"==typeof o?o.toString(2).split(""):null;return i&&"1"===i[t.webFlagBit]&&"1"===i[t.clientFlagBit]?!0:!1},t.prototype._initInfo=function(){var e=this;window._T[4]=(new Date).getTime(),v.all([e.getCourseInfoPromise(e.courseId),e.getTermsDetailPromise(e.courseId,e.termId),e.getTermApplyInfoPromise(e.termId)]).then(function(t){var o=t[0].course;return o.terms=t[1].terms,e.term=o.terms[0],l.extend(e.term,t[2]),e.course_data=l.extend(!0,{},o),e.reportIndex.setCourseData(e.course_data),e.getCourseSucc(o),e._setHeaderSign(),o},function(){e._fail(2)}),setTimeout(function(){h.isLogin()&&e.userInfo&&e.userInfo.logined&&u.getCommentAuthNew({uint32_tid:e.termId,cid:e.courseId}).done(function(t){e.getCommentAuth(t)}).fail(function(t){e.getCommentAuth(t)})},5e3)},t.prototype._clientFix=function(){var e=1===parseInt(I.query("client")),t=l(".live-container"),o=l("#ke-header");e&&t.css({top:0}),o.show()},t.prototype._isShowTips=function(e){var t=e.type;return 2===t||5===t?!0:1===t&&2===e.status?!0:!1},t.prototype._bindEvent=function(){var e=this;this.keHeader.$on("playlist.vidChange",function(t,o,i){e.playlistChangeHandler(t,o,i),h.isLogin()&&e.userInfo&&e.userInfo.logined&&e._isShowTips(i)&&m.init(i)}).$on("login.login",function(){location.reload()}).$on("playerheader.leaveRoom",function(){e.kePagelive.isPlayerShow()&&e.leaveRoom(!0,!0)}).$on("feedbackBox.show",function(){e.keFeedbackBox.showWindow()}).$on("feedbackBox.backToOld",function(){e.keHeader.enterRoom()}).$on("cover.hide",function(){e.keCover.setShowNext(!1)}).$on("check.deal.tips",function(){e.keHeader.checkDealTips()}).$on("exam.show",function(t){e.kePageExam.keExam.setUrl(t),e.kePageExam.keExam.show(),e.kePageExam.show()}).$on("exam.hide",function(){e.kePageExam.keExam.hide(),e.kePageExam.hide()}).$on("exam.close",function(){""!==e.kePageExam.keExam.url&&e.kePageExam.keExam.setUrl("")}).$on("vplayer.play",function(t,o,i,n){e.checkIsShowNotPay()||e.checkIsForbidden()||1===n.type||(e.kePageRecorded.keVplayer.show(),e.kePageRecorded.keVplayer.play(t,o,i,e.course_data,n),e.kePageRecorded._storagePlayInfo(t,o,e.course_data))}).$on("vplayer.unplay",function(){e.kePageRecorded.keVplayer.unplay()}).$on("vplayer.pause",function(){e.kePageRecorded.keVplayer.pause()}).$on("material.show",function(t,o){e.kePageMaterial.keMaterial.setFile(t,o),e.kePageMaterial.keMaterial.show(),e.kePageMaterial.show()}).$on("material.hide",function(){e.kePageMaterial.keMaterial.hide(),e.kePageMaterial.hide()}),this.keHeader.$on("cover.changeCountDownTaid",function(){clearTimeout(e.keCover.countDownPointer)}),this.keCover.$on("doReplay",function(){e.keCover.setShowNext(!1),e.kePageRecorded.keVplayer.show(),e.kePageRecorded.keVplayer.replay()}).$on("cover.onlineContract",function(){e.keHeader.doContact()}).$on("cover.getChatInfo",function(){e.CoverGetChatInfo()}),this.kePagelive.keChat.$on("enterRoomFail",function(t){e.enterRoomFail(t)}),f.get("login").listen("statusChanged",function(t){e.userInfo=t}),l(window).bind("beforeunload",function(){!e.kePagelive.keChat.isKicked&&e.kePagelive.isPlayerShow()&&e.leaveRoom(!0,!0),e.reportIndex.beforeunload()}),this.reportIndex(),this.reportEduLog()},t.prototype.leaveRoom=function(e,t,o){var i=this,n=t||!1;return i.termId&&this.kePagelive.keChat.isInRoom()||e?u.leaveRoom({__useImg:n,msg_subcmd0x3_req_leaveclassroom:JSON.stringify({str_course_abs_id:i.termId+""})}).always(function(){o&&o()}):!1},t.prototype._getCommentAuth=function(){var e=this;u.getCommentAuth({uint32_tid:e.termId}).done(function(t){e.getCommentAuth(t)}).fail(function(){})},t.prototype.CoverGetChatInfo=function(){var e=this;e.taskInfo&&1===e.taskInfo.type&&u.getLiveInfo({course_id:e.courseId,term_id:e.termId}).done(function(t){e.keCover.setLiveInfo(t)}).fail(function(){})},t.prototype._setHeaderSign=function(){var e=this.getNeedSign(),t=this.checkIsForbidden();e&&(this.tryBeginTime=+new Date),this.keHeader.setSignInfo(e&&!t),this.kePagelive.kePlayer.$set("needSign",e)},t.prototype.playlistChangeHandler=function(e,t,o){function i(){n.taskInfo=o,n.kePagelive.kePlayer.$emit("flash.taskInfo.live",n.taskInfo),n.updateContainer(),n.keLoading.hide(),n.keHeader.setTurnBack(o.type,n.term.roomUrl),n.keHeader.setFeedBack(o.type,n.term.roomUrl)}var n=this,r=!1;o.type!==this.taskInfoType?(this.taskInfoType=o.type,r=!0):1===o.type&&this.taid!==t?(this.taid=t,r=!0):1!==o.type&&this.vid!==e?(this.vid=e,r=!0):5===o.type&&(r=!0),r&&(this._initContainer&&this.kePagelive.keChat.isInRoom()?n.leaveRoom(!1,!1,i):(this._initContainer=!0,i())),n.kePagelive.keTcPlayer.isPlaying&&n.isRtmp(o.streamBitFlag)&&n.keCover.hide()},t.prototype.getCourseSucc=function(e){this.courseInfo=e,this.serverTime=e.serverTime,this.keHeader.setHeaderInfo(e)},t.prototype.updateContainer=function(){this.keLoading.show(),this.setCover();var e=this.checkIsForbidden();if(!e)switch(this.taskInfo.type){case 1:var t=this.isRtmp();this.kePagelive.show(this,t),this.keGuide.show(),this.kePageRecorded.hide(),this.kePageExam.hide(),0==this.term.price&&this.keHeader.checkDealTips();break;case 2:case 5:this.kePageRecorded.show(this),this.kePagelive.hide(),this.kePageExam.hide();break;case 4:this.kePageExam.show(),this.kePageRecorded.hide(),this.kePagelive.hide()}},t.prototype.setCover=function(e){var t=this.keCover;t.setPrice(this.term.price),t.setNotPay(this.checkIsShowNotPay()),t.setName(this.courseInfo.name),t.setTaskInfo(this.taskInfo),t.setCourseId(this.courseId),t.setForbidden(this.checkIsForbidden(),e)},t.prototype.updateTaskData=function(){for(var e,t,o=this.term.chapterInfo,i=0,n=o.length;n>i;i++){e=o[i].subInfo;for(var r=0,a=e.length;a>r;r++){t=e[r].taskInfo;for(var s=0,c=t.length;c>s;s++)if(t[s].isToggle){this.taskInfo=t[s];break}}}this.taskInfo||this._fail(4)},t.prototype.getNeedSign=function(){var e=this.term&&4!==this.term.payStatus&&5!==this.term.payStatus&&4!==this.courseInfo.passcard_status&&5!==this.courseInfo.passcard_status;return e},t.prototype.checkIsForbidden=function(){var e=256==(256&this.courseInfo.courseBitFlag),t=!this.getNeedSign();return e&&!t},t.prototype.checkIsShowNotPay=function(){var e=this,t=this.term&&this.term.price&&4!==this.term.payStatus&&5!==this.term.payStatus&&!this.taskInfo.tryListenType&&4!==this.courseInfo.passcard_status&&5!==this.courseInfo.passcard_status&&!(5===this.taskInfo.type&&this.taskInfo.$up().$up().tryListenType);return t&&e.reportIndex.showPayCover(e),t},t.prototype.getCommentAuth=function(e){var t=this;u.getTeacherId({cid:t.courseId,term_id:t.termId}).done(function(o){t.keHeader.setCommentInfo(e,o.tid)}).fail(function(){})},t.prototype.enterRoomFail=function(e){console.log("进入房间失败",e);var t=this,o="",i={10100:"未购买此课程，请购买后听课。",10500:"该课程已经开始，且是付费课程，您无法进入。",10700:"该课程已被下架，去看看其他同类课程吧！",11e3:"老师已将你踢出课堂，即将关闭课堂。",11100:"老师已将你拉入黑名单，即将关闭课堂。",11200:"由于你的行为记录，已被腾讯课堂列入黑名单，即将关闭课堂。",11500:"您正在进入Web课堂，Web课堂无法进行授课，请使用QQ客户端",12e3:"您正在在其他端上课，请退出其他端后刷新页面。",122:"进入房间失败，请联系机构管理员安装并登陆独立版老师客户端"};if(o=i[e.retcode]?i[e.retcode]:"由于网络原因，进入课堂失败。请稍后再次进入",10500===e.retcode)return this.setCover(),this.keCover.show(),void this.kePagelive.hidePlayer();if(o){switch(11500===e.retcode?(this.dialogMsg.setMsg("失败","进入房间失败",o,"启动客户端",function(){t._fail(6),window.location.href=t.term.roomUrl}),this.dialogMsg.showCancelBtn()):(this.dialogMsg.setMsg("失败","进入房间失败",o),this.dialogMsg.hideCancelBtn()),this.dialogMsg.show(),e.retcode){case 11e3:case 11100:case 11200:case 11500:this._timer=setTimeout(function(){t._fail(7)},5e3)}this.kePagelive.hidePlayer(),this.kePagelive.keChat.hide()}},t.prototype._fail=function(e){this.leaveRoom(!0),window.BJ_REPORT.info({msg:"enterWebcourseLiveFail: "+e,ext:{msid:2146572}}),window.location.href="//ke.qq.com/user/index/index.html"},t}(c["default"]),w=new P;w.init(),o.exports=w});
define("components/browsertip/main",function(i,t,s){"use strict";s.exports={data:{isShow:!1},filters:{},directives:{},methods:{hide:function(){this.$set("isShow",!1)}},ready:function(){var i=navigator.userAgent,t=i.match(/msie\s*(\d+)/i);if(t){var s=t[1]<8;this.$set("isShow",s)}}}});
define("lego_modules/qrcode/0.0.2/qrcode",function(){var t;return function(){function e(t){this.mode=l.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,r=this.data.length;r>e;e++){var o=[],n=this.data.charCodeAt(e);n>65536?(o[0]=240|(1835008&n)>>>18,o[1]=128|(258048&n)>>>12,o[2]=128|(4032&n)>>>6,o[3]=128|63&n):n>2048?(o[0]=224|(61440&n)>>>12,o[1]=128|(4032&n)>>>6,o[2]=128|63&n):n>128?(o[0]=192|(1984&n)>>>6,o[1]=128|63&n):o[0]=n,this.parsedData.push(o)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function r(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function o(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var r=0;r<t.length&&0==t[r];)r++;this.num=new Array(t.length-r+e);for(var o=0;o<t.length-r;o++)this.num[o]=t[o+r]}function n(t,e){this.totalCount=t,this.dataCount=e}function i(){this.buffer=[],this.length=0}function a(){return"undefined"!=typeof CanvasRenderingContext2D}function s(){var t=!1,e=navigator.userAgent;return/android/i.test(e)&&(t=!0,aMat=e.toString().match(/android ([0-9]\.[0-9])/i),aMat&&aMat[1]&&(t=parseFloat(aMat[1]))),t}function h(t,e){for(var r=1,o=u(t),n=0,i=m.length;i>=n;n++){var a=0;switch(e){case g.L:a=m[n][0];break;case g.M:a=m[n][1];break;case g.Q:a=m[n][2];break;case g.H:a=m[n][3]}if(a>=o)break;r++}if(r>m.length)throw new Error("Too long data");return r}function u(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)}e.prototype={getLength:function(){return this.parsedData.length},write:function(t){for(var e=0,r=this.parsedData.length;r>e;e++)t.put(this.parsedData[e],8)}},r.prototype={addData:function(t){var r=new e(t);this.dataList.push(r),this.dataCache=null},isDark:function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++){this.modules[o]=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[o][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=r.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(t,e){for(var r=-1;7>=r;r++)if(!(-1>=t+r||this.moduleCount<=t+r))for(var o=-1;7>=o;o++)-1>=e+o||this.moduleCount<=e+o||(this.modules[t+r][e+o]=r>=0&&6>=r&&(0==o||6==o)||o>=0&&6>=o&&(0==r||6==r)||r>=2&&4>=r&&o>=2&&4>=o?!0:!1)},getBestMaskPattern:function(){for(var t=0,e=0,r=0;8>r;r++){this.makeImpl(!0,r);var o=d.getLostPoint(this);(0==r||t>o)&&(t=o,e=r)}return e},createMovieClip:function(t,e,r){var o=t.createEmptyMovieClip(e,r),n=1;this.make();for(var i=0;i<this.modules.length;i++)for(var a=i*n,s=0;s<this.modules[i].length;s++){var h=s*n,u=this.modules[i][s];u&&(o.beginFill(0,100),o.moveTo(h,a),o.lineTo(h+n,a),o.lineTo(h+n,a+n),o.lineTo(h,a+n),o.endFill())}return o},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=d.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var r=0;r<t.length;r++){var o=t[e],n=t[r];if(null==this.modules[o][n])for(var i=-2;2>=i;i++)for(var a=-2;2>=a;a++)this.modules[o+i][n+a]=-2==i||2==i||-2==a||2==a||0==i&&0==a?!0:!1}},setupTypeNumber:function(t){for(var e=d.getBCHTypeNumber(this.typeNumber),r=0;18>r;r++){var o=!t&&1==(e>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=o}for(var r=0;18>r;r++){var o=!t&&1==(e>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=o}},setupTypeInfo:function(t,e){for(var r=this.errorCorrectLevel<<3|e,o=d.getBCHTypeInfo(r),n=0;15>n;n++){var i=!t&&1==(o>>n&1);6>n?this.modules[n][8]=i:8>n?this.modules[n+1][8]=i:this.modules[this.moduleCount-15+n][8]=i}for(var n=0;15>n;n++){var i=!t&&1==(o>>n&1);8>n?this.modules[8][this.moduleCount-n-1]=i:9>n?this.modules[8][15-n-1+1]=i:this.modules[8][15-n-1]=i}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var r=-1,o=this.moduleCount-1,n=7,i=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var s=0;2>s;s++)if(null==this.modules[o][a-s]){var h=!1;i<t.length&&(h=1==(t[i]>>>n&1));var u=d.getMask(e,o,a-s);u&&(h=!h),this.modules[o][a-s]=h,n--,-1==n&&(i++,n=7)}if(o+=r,0>o||this.moduleCount<=o){o-=r,r=-r;break}}}},r.PAD0=236,r.PAD1=17,r.createData=function(t,e,o){for(var a=n.getRSBlocks(t,e),s=new i,h=0;h<o.length;h++){var u=o[h];s.put(u.mode,4),s.put(u.getLength(),d.getLengthInBits(u.mode,t)),u.write(s)}for(var l=0,h=0;h<a.length;h++)l+=a[h].dataCount;if(s.getLengthInBits()>8*l)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*l+")");for(s.getLengthInBits()+4<=8*l&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;;){if(s.getLengthInBits()>=8*l)break;if(s.put(r.PAD0,8),s.getLengthInBits()>=8*l)break;s.put(r.PAD1,8)}return r.createBytes(s,a)},r.createBytes=function(t,e){for(var r=0,n=0,i=0,a=new Array(e.length),s=new Array(e.length),h=0;h<e.length;h++){var u=e[h].dataCount,l=e[h].totalCount-u;n=Math.max(n,u),i=Math.max(i,l),a[h]=new Array(u);for(var g=0;g<a[h].length;g++)a[h][g]=255&t.buffer[g+r];r+=u;var f=d.getErrorCorrectPolynomial(l),c=new o(a[h],f.getLength()-1),p=c.mod(f);s[h]=new Array(f.getLength()-1);for(var g=0;g<s[h].length;g++){var m=g+p.getLength()-s[h].length;s[h][g]=m>=0?p.get(m):0}}for(var v=0,g=0;g<e.length;g++)v+=e[g].totalCount;for(var _=new Array(v),C=0,g=0;n>g;g++)for(var h=0;h<e.length;h++)g<a[h].length&&(_[C++]=a[h][g]);for(var g=0;i>g;g++)for(var h=0;h<e.length;h++)g<s[h].length&&(_[C++]=s[h][g]);return _};for(var l={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},g={L:1,M:0,Q:3,H:2},f={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},d={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;d.getBCHDigit(e)-d.getBCHDigit(d.G15)>=0;)e^=d.G15<<d.getBCHDigit(e)-d.getBCHDigit(d.G15);return(t<<10|e)^d.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;d.getBCHDigit(e)-d.getBCHDigit(d.G18)>=0;)e^=d.G18<<d.getBCHDigit(e)-d.getBCHDigit(d.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return d.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,r){switch(t){case f.PATTERN000:return(e+r)%2==0;case f.PATTERN001:return e%2==0;case f.PATTERN010:return r%3==0;case f.PATTERN011:return(e+r)%3==0;case f.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case f.PATTERN101:return e*r%2+e*r%3==0;case f.PATTERN110:return(e*r%2+e*r%3)%2==0;case f.PATTERN111:return(e*r%3+(e+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new o([1],0),r=0;t>r;r++)e=e.multiply(new o([1,c.gexp(r)],0));return e},getLengthInBits:function(t,e){if(e>=1&&10>e)switch(t){case l.MODE_NUMBER:return 10;case l.MODE_ALPHA_NUM:return 9;case l.MODE_8BIT_BYTE:return 8;case l.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(27>e)switch(t){case l.MODE_NUMBER:return 12;case l.MODE_ALPHA_NUM:return 11;case l.MODE_8BIT_BYTE:return 16;case l.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(41>e))throw new Error("type:"+e);switch(t){case l.MODE_NUMBER:return 14;case l.MODE_ALPHA_NUM:return 13;case l.MODE_8BIT_BYTE:return 16;case l.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),r=0,o=0;e>o;o++)for(var n=0;e>n;n++){for(var i=0,a=t.isDark(o,n),s=-1;1>=s;s++)if(!(0>o+s||o+s>=e))for(var h=-1;1>=h;h++)0>n+h||n+h>=e||(0!=s||0!=h)&&a==t.isDark(o+s,n+h)&&i++;i>5&&(r+=3+i-5)}for(var o=0;e-1>o;o++)for(var n=0;e-1>n;n++){var u=0;t.isDark(o,n)&&u++,t.isDark(o+1,n)&&u++,t.isDark(o,n+1)&&u++,t.isDark(o+1,n+1)&&u++,(0==u||4==u)&&(r+=3)}for(var o=0;e>o;o++)for(var n=0;e-6>n;n++)t.isDark(o,n)&&!t.isDark(o,n+1)&&t.isDark(o,n+2)&&t.isDark(o,n+3)&&t.isDark(o,n+4)&&!t.isDark(o,n+5)&&t.isDark(o,n+6)&&(r+=40);for(var n=0;e>n;n++)for(var o=0;e-6>o;o++)t.isDark(o,n)&&!t.isDark(o+1,n)&&t.isDark(o+2,n)&&t.isDark(o+3,n)&&t.isDark(o+4,n)&&!t.isDark(o+5,n)&&t.isDark(o+6,n)&&(r+=40);for(var l=0,n=0;e>n;n++)for(var o=0;e>o;o++)t.isDark(o,n)&&l++;var g=Math.abs(100*l/e/e-50)/5;return r+=10*g}},c={glog:function(t){if(1>t)throw new Error("glog("+t+")");return c.LOG_TABLE[t]},gexp:function(t){for(;0>t;)t+=255;for(;t>=256;)t-=255;return c.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},p=0;8>p;p++)c.EXP_TABLE[p]=1<<p;for(var p=8;256>p;p++)c.EXP_TABLE[p]=c.EXP_TABLE[p-4]^c.EXP_TABLE[p-5]^c.EXP_TABLE[p-6]^c.EXP_TABLE[p-8];for(var p=0;255>p;p++)c.LOG_TABLE[c.EXP_TABLE[p]]=p;o.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),r=0;r<this.getLength();r++)for(var n=0;n<t.getLength();n++)e[r+n]^=c.gexp(c.glog(this.get(r))+c.glog(t.get(n)));return new o(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=c.glog(this.get(0))-c.glog(t.get(0)),r=new Array(this.getLength()),n=0;n<this.getLength();n++)r[n]=this.get(n);for(var n=0;n<t.getLength();n++)r[n]^=c.gexp(c.glog(t.get(n))+e);return new o(r,0).mod(t)}},n.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],n.getRSBlocks=function(t,e){var r=n.getRsBlockTable(t,e);if(void 0==r)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var o=r.length/3,i=[],a=0;o>a;a++)for(var s=r[3*a+0],h=r[3*a+1],u=r[3*a+2],l=0;s>l;l++)i.push(new n(h,u));return i},n.getRsBlockTable=function(t,e){switch(e){case g.L:return n.RS_BLOCK_TABLE[4*(t-1)+0];case g.M:return n.RS_BLOCK_TABLE[4*(t-1)+1];case g.Q:return n.RS_BLOCK_TABLE[4*(t-1)+2];case g.H:return n.RS_BLOCK_TABLE[4*(t-1)+3];default:return void 0}},i.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var r=0;e>r;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var m=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],v=function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){function e(t,e){var r=document.createElementNS("http://www.w3.org/2000/svg",t);for(var o in e)e.hasOwnProperty(o)&&r.setAttribute(o,e[o]);return r}{var r=this._htOption,o=this._el,n=t.getModuleCount();Math.floor(r.width/n),Math.floor(r.height/n)}this.clear();var i=e("svg",{viewBox:"0 0 "+String(n)+" "+String(n),width:"100%",height:"100%",fill:r.colorLight});i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),o.appendChild(i),i.appendChild(e("rect",{fill:r.colorDark,width:"1",height:"1",id:"template"}));for(var a=0;n>a;a++)for(var s=0;n>s;s++)if(t.isDark(a,s)){var h=e("use",{x:String(a),y:String(s)});h.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),i.appendChild(h)}},t.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},t}(),_="svg"===document.documentElement.tagName.toLowerCase(),C=_?v:a()?function(){function t(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function e(t,e){var r=this;if(r._fFail=e,r._fSuccess=t,null===r._bSupportDataURI){var o=document.createElement("img"),n=function(){r._bSupportDataURI=!1,r._fFail&&_fFail.call(r)},i=function(){r._bSupportDataURI=!0,r._fSuccess&&r._fSuccess.call(r)};return o.onabort=n,o.onerror=n,o.onload=i,void(o.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}r._bSupportDataURI===!0&&r._fSuccess?r._fSuccess.call(r):r._bSupportDataURI===!1&&r._fFail&&r._fFail.call(r)}if(this._android&&this._android<=2.1){var r=1/window.devicePixelRatio,o=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(t,e,n,i,a,s,h,u){if("nodeName"in t&&/img/i.test(t.nodeName))for(var l=arguments.length-1;l>=1;l--)arguments[l]=arguments[l]*r;else"undefined"==typeof u&&(arguments[1]*=r,arguments[2]*=r,arguments[3]*=r,arguments[4]*=r);o.apply(this,arguments)}}var n=function(t,e){this._bIsPainted=!1,this._android=s(),this._htOption=e,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=e.width,this._elCanvas.height=e.height,t.appendChild(this._elCanvas),this._el=t,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return n.prototype.draw=function(t){var e=this._elImage,r=this._oContext,o=this._htOption,n=t.getModuleCount(),i=o.width/n,a=o.height/n,s=Math.round(i),h=Math.round(a);e.style.display="none",this.clear();for(var u=0;n>u;u++)for(var l=0;n>l;l++){var g=t.isDark(u,l),f=l*i,d=u*a;r.strokeStyle=g?o.colorDark:o.colorLight,r.lineWidth=1,r.fillStyle=g?o.colorDark:o.colorLight,r.fillRect(f,d,i,a),r.strokeRect(Math.floor(f)+.5,Math.floor(d)+.5,s,h),r.strokeRect(Math.ceil(f)-.5,Math.ceil(d)-.5,s,h)}this._bIsPainted=!0},n.prototype.makeImage=function(){this._bIsPainted&&e.call(this,t)},n.prototype.isPainted=function(){return this._bIsPainted},n.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},n.prototype.round=function(t){return t?Math.floor(1e3*t)/1e3:t},n}():function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){for(var e=this._htOption,r=this._el,o=t.getModuleCount(),n=Math.floor(e.width/o),i=Math.floor(e.height/o),a=['<table style="border:0;border-collapse:collapse;">'],s=0;o>s;s++){a.push("<tr>");for(var h=0;o>h;h++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+n+"px;height:"+i+"px;background-color:"+(t.isDark(s,h)?e.colorDark:e.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),r.innerHTML=a.join("");var u=r.childNodes[0],l=(e.width-u.offsetWidth)/2,g=(e.height-u.offsetHeight)/2;l>0&&g>0&&(u.style.margin=g+"px "+l+"px")},t.prototype.clear=function(){this._el.innerHTML=""},t}();t=function(t,e){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:g.H},"string"==typeof e&&(e={text:e}),e)for(var r in e)this._htOption[r]=e[r];"string"==typeof t&&(t=document.getElementById(t)),this._android=s(),this._el=t,this._oQRCode=null,this._oDrawing=new C(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},t.prototype.makeCode=function(t){this._oQRCode=new r(h(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._el.title=t,this._oDrawing.draw(this._oQRCode),this.makeImage()},t.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},t.prototype.clear=function(){this._oDrawing.clear()},t.CorrectLevel=g}(),t});
define("modules/lib/share",function(e,o,n){var t=e("lego_modules/qrcode/0.0.2/qrcode"),i=window;n.exports={x:i.screen.width,y:i.screen.height,qzone:function(e,o,n,t,c){var d="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey",s=d+"?to=qzone&url="+encodeURIComponent(n)+"&title="+encodeURIComponent(e)+"&desc="+encodeURIComponent(c)+"&pics="+encodeURIComponent(o)+"&summary="+encodeURIComponent(t);i.open(s,"qzone","height=540, width=580, top="+(this.y-540)/2+", left="+(this.x-580)/2+", toolbar=no, menubar=no, resizable=yes, location=yes,status=no")},qq:function(e,o,n,t,c){var d="http://connect.qq.com/widget/shareqq/index.html",s=d+"?title="+encodeURIComponent(e)+"&summary="+encodeURIComponent(t)+"&url="+encodeURIComponent(n)+"&width=32&height=32&desc="+encodeURIComponent(c)+"&pics="+encodeURIComponent(o);i.open(s,"qq","height=600, width=780, top="+(this.y-600)/2+", left="+(this.x-780)/2+", toolbar=no, menubar=no, resizable=yes, location=yes,status=no")},weixin:function(e){var o='<div class="share__mask"></div><div class="qrcode-container"><div class="qrcode-top"></div><div class="qrcode-center"><div class="qc-center"><div id="rqcode"></div><div class="qc-logo"></div></div><div class="qc-bottom">打开微信，通过点击底部“发现”按钮，“扫一扫”二维码后，点击弹出页面右上角的分享按钮，就可以分享给你的朋友们啦！</div></div><div class="qrcode-bottom"></div></div>',n=document.createElement("div");n.id="qrcodeWrap",n.innerHTML=o,document.body.appendChild(n);var i=function(){return new t("rqcode",{text:e,width:190,height:190,colorDark:"#000000",colorLight:"#ffffff",correctLevel:t.CorrectLevel.H})};n.onclick=function(){document.body.removeChild(this)},i()}}});
define("pages/index/share/main",function(e,t,i){"use strict";function r(e){return["title","pics","url","summary","desc"].map(function(t){return e[t]})}function n(e){return a("<div></div>").html(e).text()}var o=e("modules/lib/share"),a=e("jquery");i.exports={data:{},filters:{},directives:{},methods:{hideShare:function(){this.$emit("share.hide")},doQQShare:function(){var e=this;o.qq.apply(o,r(e.config)),e.$emit("share.report",{obj1:"1"})},doQzoneShare:function(){var e=this;o.qzone.apply(o,r(e.config)),e.$emit("share.report",{obj1:"2"})},doWeixinShare:function(){var e=this;o.weixin.call(o,r(e.config)[2]),e.$emit("share.report",{obj1:"3"})},setData:function(e){e.desc=n(e.desc),e.title=n(e.title),e.url=e.url.replace(/.*(\/\/.*)/,"http:$1"),this.$set("config",e)}},ready:function(){}}});
define("components/mlogin/db.user",function(e,i,n){"use strict";var o=e("modules/lib/db");n.exports=o.httpMethod({url:"/cgi-bin/login/userinfo",type:"POST"})});
define("components/mlogin/main",function(n,e,i){"use strict";function o(){var n=this;l({succ:function(e){e=e.result,e.is_login?n.setUserInfo({nick:e.nick_name,uin:s.uin(),role:parseInt(e.role_type)||0,logined:!0,face:s.isWeixinUser()?e.face_url:void 0}):(n.setUserInfo({role:0,logined:!1}),s.isLogin()&&s.delAllCookie()),c(document.body).data("loginInfo",e),c(window).trigger("header.getInfo",e)},err:function(){n.setUserInfo({role:0,logined:!1})}})}function t(n){return 3===n||2===n?"//ke.qq.com/myCourse/index.html":1===n||4===n||5===n?"//ke.qq.com/agency/index/index.html":void 0}function r(){s.isWeixinUser()?(g.set("main_login","wx",".qq.com"),g.set("vuserid",s.uin(),".qq.com")):(g.del("main_login",".qq.com"),g.del("vuserid",".qq.com"))}var s=n("modules/lib/login"),l=n("components/mlogin/db.user"),u=n("lego_modules/observer/0.0.1/observer"),c=n("jquery"),g=n("modules/lib/cookie"),d=function(n){n()};i.exports={data:{role:0,logined:s.isLogin(),uin:s.uin()},filters:{getAvatar:function(n){if(n&&s.isWeixinUser())return n;var e=s.uin();return e?"//q.qlogo.cn/g?b=qq&nk="+e+"&s=100":""},isOrg:function(n){return 1===n||4===n||5===n},getUrl:t,getTitle:function(n){return 3===n||2===n?"个人中心":1===n||4===n?"机构管理":5===n?"老师管理":void 0}},directives:{},methods:{clickLogin:function(){s.show()},clickLogout:function(){d(function(){s.logout()})},setBeforeLogout:function(n){d=n},setUserInfo:function(n){this.$set(n),u.get("login").trigger("statusChanged",n)},toMe:function(){window.open(t(this.role))}},ready:function(){var n=this;s.init({onStatusChanged:function(){var e=s.isLogin();n.setUserInfo({logined:e}),r(),e?(n.setUserInfo({uin:s.uin()}),n.$emit("login.login"),o.call(n)):(n.setUserInfo({role:0}),n.$emit("login.logout"))}}),o.call(this),r()}}});
define("lego_modules/modal/0.0.2/modal",function(require,exports,module){var $=require("jquery"),Observer=require("lego_modules/observer/0.0.1/observer"),isDebug=!0,modalIndex=0;$.template=function(tmpl,data){var evalExp=function(exp,scope){return function(){var __res;try{with(scope)__res=eval(exp)}catch(e){isDebug&&console.info('expression:"'+exp+'" undefined.')}return"undefined"==typeof __res?"":__res}.call(scope)},position=0,stacks=[!0],regexp=/\{if ([^\}]+)\}|\{\/if\}|\{else\}|\{else if ([^\}]+)\}/gi,res="";return tmpl.replace(regexp,function(t,e,s,n){var o=stacks.pop();return o&&(res+=tmpl.substr(position,n-position)),position=n+t.length,e?(stacks.push(o),stacks.push(o&&evalExp(e,data)?!0:!1),stacks.push(stacks[stacks.length-1])):s?stacks.push(stacks[stacks.length-1]?!1:evalExp(s,data)?!0:!1):/\{else\}/i.test(t)?stacks.push(stacks[stacks.length-1]?!1:!0):stacks.pop(),""}),stacks.pop()&&(res+=tmpl.substr(position)),tmpl=res,tmpl=tmpl.replace(/\{\$([^\{\}]+)\}/g,function(t,e){return evalExp(e,data)})};var templateBg='<div tabindex="-1" class="overlay js-modal-bg"></div>',templateModal='<div class="js-modal modal  {$className} {if icon}modal--msg{/if} {if scroll}modal--scroll{/if}" style="{if width}width:{$width}px;{/if}{if style}{$style}{/if}" >';templateModal+="{if !nohead}",templateModal+='  <div class="modal-hd"><h3 class="hd-tt js-modal-title">{$title}</h3><a href="javascript:void(0);" class="js-modal-close btn-close" {if !isClose}style="display:none;"{/if} title="关闭">×</a></div>',templateModal+="{/if}",templateModal+="{if !body}",templateModal+='  <div class="modal-bd {if padding}modal-bd--padding{/if}" style="{if height}height:{$height}px;{/if}">',templateModal+="  {if icon}",templateModal+='      <div class="bd-msg"><i class="icon-font icon-msg-large i-{$icon}"></i>',templateModal+='      <p class="msg-text">{$content}</p></div>',templateModal+="  {else}",templateModal+="      {$content}",templateModal+="  {/if}",templateModal+="  </div>",templateModal+='  <div class="modal-ft">',templateModal+='  <a href="javascript:void(0);" title="{$txtYes}" class="js-modal-yes btn-default {if !enableYes} btn-disabled{/if}" {if !isYes}style="display:none;"{/if}>{$txtYes}</a>',templateModal+="  ",templateModal+='  <a href="javascript:void(0);" title="{$txtNo}" class="js-modal-no btn-weak {if !enableNo} btn-disabled{/if}" {if !isNo}style="display:none;"{/if}>{$txtNo}</a>',templateModal+="  </div>",templateModal+="{else}",templateModal+="  {$body}",templateModal+="{/if}",templateModal+="",templateModal+="</div>";var addDrag=function(t,e,s){var n=!1,o=0,i=0,a=$(t),l=$(e),c=$.extend({opacity:.6,duration:.3},s),d=function(t){n&&l.css({left:t.pageX-o+"px",top:t.pageY-i+"px"})},r=function(){n=!1,l.css({transition:"none",opacity:"1"}),$(document.body).off("mousemove",d)};a.mousedown(function(t){n=!0,o=t.pageX-parseInt(l.css("left")),i=t.pageY-parseInt(l.css("top")),l.css({transition:"opacity "+c.duration+"s ease-in",opacity:c.opacity}),$(document.body).mousemove(d).one("mouseup",r)})};$.fn.drag=function(t,e){t||(t=this),addDrag(this,t,e)};var Modal=function(t){this._index=modalIndex++;var e={title:"提示",className:"",style:"",content:"hello world.",txtYes:"确定",txtNo:"取消",icon:"",nohead:!1,body:"",hotkey:!0,isYes:!0,isNo:!0,isClose:!0,enableYes:!0,enableNo:!0,enableClose:!0,buttonsAlign:"right",enableDrag:!0,enableBgClose:!1,width:500,height:"",padding:!0,scroll:!1,yes:function(){},no:function(){},onClose:function(){Observer.trigger("dialog.close")},onOpen:function(){Observer.trigger("dialog.show")}};this.opts=$.extend(e,t),this._buttonState={};var s={submit:"txtYes",isDisabled:"enableYes",globalClass:"className",onAccept:"yes",onCancel:"no"};$.each(s,function(t,s){"undefined"!=typeof e[t]&&(e[s]=e[t])}),this.onAccept=this.yes,this.onCancel=this.no,this.async(this.opts.onOpen,this.$,function(){this._update().update()})};Modal.prototype={$:null,$bg:null,$btnYes:null,$btnNo:null,_index:0,_buttons:["enableYes","enableNo","enableClose"],_buttonState:null,opts:null,hotkeyCallback:function(t){if(this.opts.enableBgClose&&t.target===this.$bg[0])return this.closeAsync(this.opts.no,t);if(this.opts.hotkey)return 27===t.which&&this.opts.enableNo?this.closeAsync(this.opts.no,t):13===t.which&&this.opts.enableYes?this.closeAsync(this.opts.yes,t):void 0},async:function(t,e,s){var n=this;if(t.length<2){var o=t.call(n,e);s.call(n,"undefined"==typeof o||o?!0:!1)}else t.call(n,e,function(t){s.call(n,"undefined"==typeof t||t?!0:!1)})},closeAsync:function(t,e){var s=this;this.saveButtonsState(),this.disableButtons(),this.async(t,e,function(t){return t?void(s.opts.enableClose&&s.async(s.opts.onClose,e,function(t){return t?void s.remove():s.recoverButtons()})):s.recoverButtons()})},title:function(t){return this.$.find(".js-modal-title").html(t),this},content:function(t){var e=this.$.find(".msg-text");return 0===e.length&&(e=this.$.find(".modal-bd")),e.html(t),this},remove:function(){this.$.remove(),removeHotkeyCallback(this._hotkeyCallback);var t=$(".js-modal");return 0===t.length?this.$bg.remove():void this.$bg.after(t.eq(t.length-1))},update:function(){return this.$.css({marginTop:"-"+parseInt(this.$.height()/2)+"px",marginLeft:"-"+parseInt(this.$.width()/2)+"px"}),this.$.show(),this},recoverButtons:function(){var t=this;return $.each(t._buttons,function(e,s){t[s](t._buttonState[s])}),this},saveButtonsState:function(){var t=this;return $.each(t._buttons,function(e,s){t._buttonState[s]=t.opts[s]}),this},disableButtons:function(){var t=this;return $.each(["enableYes","enableNo"],function(e,s){t[s](!1)}),this},_update:function(){var t=this;return this.$?this.$.show():(this.$bg=$(".js-modal-bg"),0===this.$bg.length&&(this.$bg=$(templateBg).appendTo($(document.body))),this.$=$($.template(templateModal,this.opts)),this.$.appendTo($(document.body)).before(this.$bg),this._hotkeyCallback=function(){t.hotkeyCallback.apply(t,arguments)},addHotkeyCallback(this._hotkeyCallback),this.opts.enableDrag&&this.$.find(".modal-hd").drag(this.$),this.bindEvents(),this)},bindBtnYesEvent:function(){var t=this;return this.$btnYes=this.$.find(".js-modal-yes").click(function(e){$(this).hasClass("btn-disabled")||t.closeAsync(t.opts.yes,e)}),this},bindBtnNoEvent:function(){var t=this;return this.$btnNo=this.$.find(".js-modal-no").click(function(e){$(this).hasClass("btn-disabled")||(e=e||{},e.btnName="cancel",t.closeAsync(t.opts.no,e))}),this},bindBtnCloseEvent:function(){var t=this;return this.$.find(".js-modal-close").click(function(e){t.$btnNo.hasClass("btn-disabled")||(e=e||{},e.btnName="close",t.closeAsync(t.opts.no,e))}),this},bindEvents:function(){return this.bindBtnYesEvent().bindBtnCloseEvent().bindBtnNoEvent()}},$.each(["enableYes","enableNo","enableClose"],function(t,e){Modal.prototype[e]=function(t){this.opts[e]=t;var s=t?"removeClass":"addClass";return"enableYes"===e&&this.$btnYes[s]("btn-disabled"),"enableNo"===e&&this.$btnNo[s]("btn-disabled"),this}}),$.each(["yes","no","onClose","onOpen"],function(t,e){Modal.prototype[e]=function(t){return this.opts[e]=t,this}}),$.each(["width","height"],function(t,e){Modal.prototype[e]=function(t){return"undefined"==typeof t?this.opts[e]:(this.opts[e]=t,this.$[e](t),this.update())}}),$(document.body).keydown(function(t){triggerHotkey(t)}).delegate(".js-modal-bg","click",function(t){triggerHotkey(t)});var hotKeyCallbacks=[],addHotkeyCallback=function(t){hotKeyCallbacks.push(t)},removeHotkeyCallback=function(t){$.each(hotKeyCallbacks,function(e,s){return s===t?(hotKeyCallbacks.splice(e,1),!1):void 0})},triggerHotkey=function(t){hotKeyCallbacks.length<1||hotKeyCallbacks[hotKeyCallbacks.length-1](t)},modalConfigs={alert:{title:"警告",content:"警告信息！",icon:"alert",isNo:!1,buttonsAlign:"right",enableBgClose:!1},retry:{txtYes:"重试",content:"是否重试？",icon:"alert",enableBgClose:!1},confirm:{title:"确认操作",icon:"alert",txtYes:"确认",content:"请确认是否操作？",enableBgClose:!1},success:{title:"成功提示",icon:"success",content:"操作成功！",isNo:!1},error:{title:"错误提示",icon:"alert",isNo:!1},help:{title:"帮助信息",icon:"info",content:"这是一条帮助信息。",isNo:!1}},modal=function(t){return new Modal(t)};return $.fn.modal=function(t,e,s){var n=arguments.length;return this.click(function(){return 1===n?"object"==typeof t?(s=t,e="",t=t.type||""):(e=t,t="alert"):2===n&&(s=e||{},e=t,t=s.type||"alert"),t?modal[t](e,s):modal(s)})},$.each(modalConfigs,function(t,e){modal[t]=function(t,s){return modal($.extend({},e,{content:t||e.content},s))}}),$.modal=modal,$.Modal=Modal,$._alert=function(t,e,s){return $(".js-modal-bg, .js-modal").remove(),$.Dialog.remove(),s=$.extend({},s||{}),"function"==typeof e?(s.title="提示",s.onAccept=s.onCancel=e):s.title=e||"提示",$.modal.alert(t,s)},$._loading=function(t,e,s){var n=$._alert(t,e,s),o=$('<div class="modal-loading"><div class="spin"></div><p>'+t+"</p></div>");return n.$.find(".bd-msg").empty().append(o),n.$.find(".modal-loading .spin").spin(!0),n},modal});
define("pages/index/playlist/main",function(e,t,i){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("jquery"),a=e("modules/lib/util"),s=e("modules/lib/cookie"),o=e("modules/lib/login"),u=e("lego_modules/local.data/0.0.1/local.data"),c=e("modules/lib/Q"),l=e("modules/lib/promise");e("lego_modules/modal/0.0.2/modal");var d,m,p,f,g,$,h=a.getUrlParam("course_id"),v=a.getUrlParam("term_id"),y=a.getUrlParam("vid"),T=a.getUrlParam("taid"),b=!1,k=-1;try{var w=u.get(s.uin())&&JSON.parse(u.get(s.uin()));w&&(y=y||JSON.parse(u.get(s.uin())).vid,T=T||w.taid)}catch(_){}i.exports={data:{currentVid:y,currentTaid:T,courseName:"",courseId:h,firstOpen:"1"},filters:{length:function(e){return e&&e.length},subLength:function(e){return 1===e.type&&"object"===r(e.subTask)&&e.subTask.length>0},isPlayback:function(e){return 1===e.type&&4===e.status&&"object"===r(e.subTask)&&e.subTask.length>0},getMsg:function(e,t){return e[t]},returnClass:function(e){return e?"i-v-bottom":"i-v-right"},isToggle:function(e){return!!e},isSlide:function(e,t){var i=t.$up().$up();return e&&i&&(i.$set("isToggle",!0),i.$up().$up().$set("isToggle",!0),d=i.$up().$up(),m=i),!!e},getCourseName:function(e,t){return a.htmlDecode(this._getCourseName(e,t))},getCourseUrl:function(){return"/course/"+h+"#term_id="+v},getSuffix:function(e,t){return a.htmlDecode(this._getSuffix(e,t)||"")},getTaskName:function(e,t){var i="("+t.index+")";return a.htmlDecode(this._getCourseName(e,t.$up().$up(),i))},setTermid:function(e){this.$parent.$set("termid",e)},getResid:function(e){return"object"===("undefined"==typeof e?"undefined":r(e))?"":e},getTaskType:function(e){return e.type},getRecord:function(e,t){var i=this,r=1===t.type&&!t.subTask.length,s=2===t.type,u=3===t.type,l=4===t.type,d=5===t.type,h=d?t.$up().$up():t,v=h.$up().$up(),y=(d||s)&&t.vid,T=h.taid,k=d?"("+t.index+")":void 0,w=v&&(y===i.currentVid||r||""===i.currentVid&&(s||d))&&T===i.currentTaid,_=l&&v&&t.vid===i.currentVid&&T===i.currentTaid,C=u&&v&&T===i.currentTaid,x=parseInt($.price,10);if(w)v.$set("isToggle",!0),v.$up().$up().$set("isToggle",!0),m=t,i.$set("currentVid",y)&&i.$set("currentTaid",T),i.$emit("title.change",i._getCourseName(t.type,h,k)),x>0&&!o.isLogin()?o.show():(!b&&setTimeout(function(){p=[h.$up().$up().subId,v.$up().$up().$key()+1,h.$up().$up().$key()+1].join("_"),f=T,i.$emit("playlist.vidChange",y,T,t).$emit("vplayer.play",y,T,d?1:2,t).$emit("data.report",p,f),b=!0,i.$emit(r?"playerheader.showCommentBtn":"playerheader.hideCommentBtn")},0),i.$set("firstOpen","0"));else if(_){v.$set("isToggle",!0),v.$up().$up().$set("isToggle",!0),g=c.get("#ke-exam"),m=t,i.$emit("title.change",i._getCourseName(t.type,h,k));var D="//ke.qq.com/exercise/index.html?",j=a.saveUrlParamToObj("#");j.task_id=T,j.exam_id=t.vid,j.first_open=i.firstOpen,D+=a.serializeUrlParameFromObj(j),i.$set("firstOpen","0"),setTimeout(function(){i.$emit("exam.show",D)},0)}else C&&(i.$set("firstOpen","0"),setTimeout(function(){n(".js-course-list-header.js-active").trigger("click")},0));return w||_||C},getTarget:function(e,t){return t.tencent},getTopTitle:function(e,t){return a.htmlDecode(n.trim("第"+(t.$key()+1)+"章 "+e))},getChapterTitle:function(e){return a.htmlDecode(n.trim("第"+(k+2)+"节 "+e))},getLiveTencent:function(e){return 1===e?a.htmlDecode($.roomUrl):void 0},getListener:function(e){var t=parseInt($.payStatus,10);return(2===e||1===e)&&4!==t&&5!==t},fillAndTry:function(e,t){var i=1===t.type&&4===t.status&&"object"===r(t.subTask)&&t.subTask.length>0;return e&&i},isLive:function(e){return 1===e},isVideo:function(e){return 2===e},isFile:function(e){return 3===e},isExam:function(e){return 4===e},setCourseName:function(){return this.courseName},getCourseDetailUrl:function(){return v=a.getUrlParam("term_id"),"/course/"+h+"#term_id="+v},getChapterIndex:function(){return k++,k}},directives:{slide:function(e){e?n(this.el).slideDown(200,function(){n(this).show()}):n(this.el).slideUp(200,function(){n(this).hide()})}},methods:{toggleCourse:function(e,t){t.$set("isToggle",!t.isToggle),this.$emit("CaptureClick.report",{obj1:t.isToggle?1:2,ver3:p,ver9:f})},installment:function(e){var t=$,i=t.termInstallment,r=t.installmentType,a=t.installmentState,s=function(){return n(e.currentTarget).parents("ul").data("index")},o=function(){var e=s(),t=0;return i.forEach(function(e){e.orderState>=2&&e.orderState<=5&&(t=e.installmentEnd)}),e>t?!1:!0},u=function(){var e=(new Date).getTime(),t=!1,r=i[1];return 209!==a&&r&&r.orderState>=2&&r.orderState<=5&&e>=1e3*r.installmentBegin?!0:t};if(2===r){if(!o())return!1}else if(1===r&&!u())return!1;return!0},strFormat:function(e,t){return e.replace(/{([^}]+)}/g,function(e,i){return t[i]})},courseSelect:function(e,t){function i(){switch(u.$emit("material.hide"),~~t.type){case 1:4!==t.status&&(u.$emit("exam.hide").$emit("vplayer.pause").$emit("playlist.vidChange",c,l,t).$emit("playerheader.showCommentBtn"),u.$set("currentVid",c),u.$set("currentTaid",l),u.$emit("slideup.menu"),window._T[4]=(new Date).getTime(),window._T[5]=0,window.location.hash="#course_id="+h+"&term_id="+v+"&taid="+l+"&vid="+c,u.$emit("exam.close"));break;case 2:if(d>0&&!o.isLogin()){o.show();break}u.$emit("exam.hide"),u.currentVid!==c||u.currentTaid!==l?(u.$set("currentVid",c),u.$set("currentTaid",l),u._play(c,l,t,t.type)):u.$emit("vplayer.resume"),u.$emit("exam.close");break;case 3:if(!o.isLogin()){o.show();break}if(u.$emit("vplayer.pause"),u.$emit("title.change",t.name),u.$emit("slideup.menu"),!k&&!w&&d>0){u.$emit("exam.hide"),u.$emit("playlist.vidChange",c,l,t),u.$set("currentVid",c),u.$set("currentTaid",l);break}r=u.$parent.files&&u.$parent.files[t.vid]?u.$parent.files[t.vid]:t.file;var e="/cgi-bin/file/download?cw_id="+(r&&r.cw_id)+"&a_id="+(r&&r.cw_aid)+"&cid="+h+"&term_id="+v+"&taid="+l+"&uin="+s.uin();u.$emit("material.show",r,e),window.location.hash="#course_id="+h+"&term_id="+v+"&taid="+l;break;case 4:if(u.$emit("vplayer.pause"),u.$emit("playlist.vidChange",c,l,t),u.$set("currentVid",c),u.$emit("header.toggleMenu"),k||w){u.$set("currentTaid",l);var i="//ke.qq.com/exercise/index.html?",m=a.saveUrlParamToObj("#");m.task_id=l,m.exam_id=t.vid,m.first_open=u.firstOpen,i+=a.serializeUrlParameFromObj(m),u.$emit("exam.show",i);var p="#course_id={0}&term_id={1}&taid={2}&vid={3}";window.location.hash=u.strFormat(p,[h,v,l,c])}else 0===d?n.modal.alert("请先报名课程再答题哦",{title:"提示"}).yes(function(){var e="//ke.qq.com/course/{0}#term_id={1}";window.location.href=u.strFormat(e,[h,v])}):u.$emit("title.change",t.name);break;case 5:if(d>0&&!o.isLogin()){o.show();break}}u.$emit("cover.changeCountDownTaid",l)}var r,u=this,c=t.vid,l=t.taid||t.$up().$up().aid,d=parseInt($.price,10),y=1===t.type&&t.subTask.length>0,T=parseInt($.payStatus,10),b=t.tryListenType,k=(2===b||1===b)&&4!==T&&5!==T,w=4===T||5===T,_=m&&m.type;return k||w||u.installment(e,t)?(y?(t.$set("isToggle",!t.isToggle),m=t,u.$emit("ReplayClickHoldLauch.report",{obj1:t.isToggle?1:2,ver3:p,ver9:f})):(!m&&(m=t),t!==m&&m.$set("isToggle",!1),t.$set("isToggle",!0),m=t,n(".course-list-header, .part-title").removeClass("js-active"),n(e.currentTarget).addClass("js-active"),u.$emit("MissionClick.report",{action:"MissionClick",obj1:t.type,ver3:p,ver9:f})),u.$emit("cover.hide").$emit("playerheader.hideCommentBtn"),4===~~_&&g?u.getIframeWinPromise().then(function(){var e=n(g.$el).find("iframe")[0].contentWindow;e.$(e).off("task.afterchange"),e.$(e).on("task.afterchange",function(){i()}),e.$(e).trigger("task.beforechange")}):i(),void(1===_&&n(window).triggerHandler("beforeunload",!0))):void n.modal.alert("本节内容暂无权限").onClose(function(){var e="//ke.qq.com/user/tasks/index.html?cid={0}#tid={1}&fr=2";window.location.href=u.strFormat(e,[h,v])})},getIframeWinPromise:function(){return new l(function(e){var t=function i(){var t=n(g.$el).find("iframe");t.length>0&&t[0].contentWindow.$?e():setTimeout(i,20)};t()})},taskSelect:function(e,t){var i=this,r=t.vid,a=t.taid||t.$up().$up().taid;i.$emit("exam.hide"),i.$emit("title.change",i._getCourseName(t.type,t.$up().$up(),"("+t.index+")")),i._play(r,a,t,1),i.$set("currentVid",r),i.$set("currentTaid",a),i.$emit("cover.changeCountDownTaid",a),n(".course-list-header, .part-title").removeClass("js-active"),n(e.currentTarget).addClass("js-active")},setData:function(e){0===e.terms.length&&this.$emit("error.show"),$=e.terms[0],k=-1,this.$set("uin",e.uin),this.$set("playlist",e.terms),this.$set("tencent",a.htmlDecode(e.tencent))},_getCourseName:function(e,t,i){return a.htmlDecode(n.trim(t&&t.name||"")+" "+(i||""))},_getSuffix:function(e,t){function i(e){if(e>1048576)return(e/1024/1024).toFixed(1)+"MB";var t=(e/1024).toFixed(1)+"KB";return"0.0KB"===t?"0.1KB":t}function r(e,t,i){return a.formatDate("M月D日 hh:mm",e)+"-"+(new Date(t).getDate()!==new Date(e).getDate()?"次日":"")+a.formatDate("hh:mm",t)+i}var n="",s=!1;switch(e){case 1:switch(t.status){case 1:n=r(t.startTime,t.endTime,"");break;case 2:n="正在直播",s=!0;break;case 3:n=a.formatDate("M月D日",t.startTime)+",已结束";break;case 4:n=""}break;case 2:n=Math.ceil(t.timelen/60)+"分钟";break;case 3:var o=t.file,u=o&&o.cw_size||0;n=i(u);break;case 4:n=t.resid_ext.list[0].count+"道";break;case 5:}return""!==n&&(n="("+n+")"),t.$set("isliving",s),console.log(n),a.htmlDecode(n)},_play:function(e,t,i,r){var n=this,a=i.$up().$up();setTimeout(function(){p=[a.$up().$up().$key()+1,a.$key()+1,i.$key()+1].join("_"),f=t,n.$emit("vplayer.unplay").$emit("playlist.vidChange",e,t,i).$emit("vplayer.play",e,t,r,i).$emit("data.report",p,f).$emit("slideup.menu")},400),window.location.hash="#course_id="+h+"&term_id="+v+"&taid="+t+"&vid="+e}},ready:function(){}}});
define("pages/index/comment/main",function(t,s,e){"use strict";var i=10;e.exports={data:{isShow:!1,url:"//ke.qq.com/comment.html",content:"",marklist:[{id:"course",title:"课堂描述 :",style:"width: 0;",stars:0},{id:"tech",title:"老师讲解 :",style:"width: 0;",stars:0},{id:"agent",title:"机构服务 :",style:"width: 0;",stars:0}]},filters:{getCommentCount:function(t){var s=i-t.length;return s},getStarMark:function(t){var s={1:"差评",2:"不满意",3:"勉强满意",4:"满意",5:"很满意"};return t?t+'<span class="score">分</span><span class="tips">'+(s[t]||"未评价")+"</span>":'<span class="tips hidden">未评价</span>'}},directives:{},methods:{setTid:function(t){var s="//ke.qq.com/comment.html?"+window.location.hash.slice(1)+"&tid="+t;this.$set("url",s)},show:function(){this.$set("isShow",!0)}},ready:function(){}}});
define("modules/lib/jquery.form",function(e){function t(e){var t=e.data;e.isDefaultPrevented()||(e.preventDefault(),n(this).ajaxSubmit(t))}function a(e){var t=e.target,a=n(t);if(!a.is(":submit,input:image")){var r=a.closest(":submit");if(0===r.length)return;t=r[0]}var i=this;if(i.clk=t,"image"==t.type)if(void 0!==e.offsetX)i.clk_x=e.offsetX,i.clk_y=e.offsetY;else if("function"==typeof n.fn.offset){var o=a.offset();i.clk_x=e.pageX-o.left,i.clk_y=e.pageY-o.top}else i.clk_x=e.pageX-t.offsetLeft,i.clk_y=e.pageY-t.offsetTop;setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},100)}function r(){if(n.fn.ajaxSubmit.debug){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e)}}var n=e("jquery"),i={};i.fileapi=void 0!==n("<input type='file'/>").get(0).files,i.formdata=void 0!==window.FormData,n.fn.ajaxSubmit=function(e){function t(e){var t,a,r=n.param(e).split("&"),i=r.length,o={};for(t=0;i>t;t++)a=r[t].split("="),o[decodeURIComponent(a[0])]=decodeURIComponent(a[1]);return o}function a(a){for(var r=new FormData,i=0;i<a.length;i++)r.append(a[i].name,a[i].value);if(e.extraData){var o=t(e.extraData);for(var s in o)o.hasOwnProperty(s)&&r.append(s,o[s])}e.data=null;var u=n.extend(!0,{},n.ajaxSettings,e,{contentType:!1,processData:!1,cache:!1,type:"POST"});e.uploadProgress&&(u.xhr=function(){var t=n.ajaxSettings.xhr();return t.upload&&(t.upload.onprogress=function(t){var a=0,r=t.loaded||t.position,n=t.total;t.lengthComputable&&(a=Math.ceil(r/n*100)),e.uploadProgress(t,r,n,a)}),t}),u.data=null;var l=u.beforeSend;u.beforeSend=function(e,t){t.data=r,l&&l.call(this,e,t)},n.ajax(u)}function o(t){function a(e){var t=e.contentWindow?e.contentWindow.document:e.contentDocument?e.contentDocument:e.document;return t}function i(){function e(){try{var t=a(v).readyState;r("state = "+t),t&&"uninitialized"==t.toLowerCase()&&setTimeout(e,50)}catch(n){r("Server abort: ",n," (",n.name,")"),o(k),T&&clearTimeout(T),T=void 0}}var t=c.attr("target"),i=c.attr("action");w.setAttribute("target",d),s||w.setAttribute("method","POST"),i!=f.url&&w.setAttribute("action",f.url),f.skipEncodingOverride||s&&!/post/i.test(s)||c.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),f.timeout&&(T=setTimeout(function(){y=!0,o(S)},f.timeout));var u=[];try{if(f.extraData)for(var l in f.extraData)f.extraData.hasOwnProperty(l)&&u.push(n.isPlainObject(f.extraData[l])&&f.extraData[l].hasOwnProperty("name")&&f.extraData[l].hasOwnProperty("value")?n('<input type="hidden" name="'+f.extraData[l].name+'">').attr("value",f.extraData[l].value).appendTo(w)[0]:n('<input type="hidden" name="'+l+'">').attr("value",f.extraData[l]).appendTo(w)[0]);f.iframeTarget||(h.appendTo("body"),v.attachEvent?v.attachEvent("onload",o):v.addEventListener("load",o,!1)),setTimeout(e,15),w.submit()}finally{w.setAttribute("action",i),t?w.setAttribute("target",t):c.removeAttr("target"),n(u).remove()}}function o(e){if(!g.aborted&&!M){try{E=a(v)}catch(t){r("cannot access response document: ",t),e=k}if(e===S&&g)return void g.abort("timeout");if(e==k&&g)return void g.abort("server abort");if(E&&E.location.href!=f.iframeSrc||y){v.detachEvent?v.detachEvent("onload",o):v.removeEventListener("load",o,!1);var i,s="success";try{if(y)throw"timeout";var u="xml"==f.dataType||E.XMLDocument||n.isXMLDoc(E);if(r("isXml="+u),!u&&window.opera&&(null===E.body||!E.body.innerHTML)&&--F)return r("requeing onLoad callback, DOM not available"),void setTimeout(o,250);var l=E.body?E.body:E.documentElement;g.responseText=l?l.innerHTML:null,g.responseXML=E.XMLDocument?E.XMLDocument:E,u&&(f.dataType="xml"),g.getResponseHeader=function(e){var t={"content-type":f.dataType};return t[e]},l&&(g.status=Number(l.getAttribute("status"))||g.status,g.statusText=l.getAttribute("statusText")||g.statusText);var c=(f.dataType||"").toLowerCase(),d=/(json|script|text)/.test(c);if(d||f.textarea){var p=E.getElementsByTagName("textarea")[0];if(p)g.responseText=p.value,g.status=Number(p.getAttribute("status"))||g.status,g.statusText=p.getAttribute("statusText")||g.statusText;else if(d){var x=E.getElementsByTagName("pre")[0],b=E.getElementsByTagName("body")[0];x?g.responseText=x.textContent?x.textContent:x.innerText:b&&(g.responseText=b.textContent?b.textContent:b.innerText)}}else"xml"==c&&!g.responseXML&&g.responseText&&(g.responseXML=O(g.responseText));try{L=C(g,c,f)}catch(e){s="parsererror",g.error=i=e||s}}catch(e){r("error caught: ",e),s="error",g.error=i=e||s}g.aborted&&(r("upload aborted"),s=null),g.status&&(s=g.status>=200&&g.status<300||304===g.status?"success":"error"),"success"===s?(f.success&&f.success.call(f.context,L,"success",g),m&&n.event.trigger("ajaxSuccess",[g,f])):s&&(void 0===i&&(i=g.statusText),f.error&&f.error.call(f.context,g,s,i),m&&n.event.trigger("ajaxError",[g,f,i])),m&&n.event.trigger("ajaxComplete",[g,f]),m&&!--n.active&&n.event.trigger("ajaxStop"),f.complete&&f.complete.call(f.context,g,s),M=!0,f.timeout&&clearTimeout(T),setTimeout(function(){f.iframeTarget||h.remove(),g.responseXML=null},100)}}}var u,l,f,m,d,h,v,g,x,b,y,T,w=c[0],j=!!n.fn.prop;if(n(":input[name=submit],:input[id=submit]",w).length)return void alert('Error: Form elements must not have name or id of "submit".');if(t)for(l=0;l<p.length;l++)u=n(p[l]),j?u.prop("disabled",!1):u.removeAttr("disabled");if(f=n.extend(!0,{},n.ajaxSettings,e),f.context=f.context||f,d="jqFormIO"+(new Date).getTime(),f.iframeTarget?(h=n(f.iframeTarget),b=h.attr("name"),b?d=b:h.attr("name",d)):(h=n('<iframe name="'+d+'" src="'+f.iframeSrc+'" />'),h.css({position:"absolute",top:"-1000px",left:"-1000px"})),v=h[0],g={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(e){var t="timeout"===e?"timeout":"aborted";if(r("aborting upload... "+t),this.aborted=1,v.contentWindow.document.execCommand)try{v.contentWindow.document.execCommand("Stop")}catch(a){}h.attr("src",f.iframeSrc),g.error=t,f.error&&f.error.call(f.context,g,t,e),m&&n.event.trigger("ajaxError",[g,f,t]),f.complete&&f.complete.call(f.context,g,t)}},m=f.global,m&&0===n.active++&&n.event.trigger("ajaxStart"),m&&n.event.trigger("ajaxSend",[g,f]),f.beforeSend&&f.beforeSend.call(f.context,g,f)===!1)return void(f.global&&n.active--);if(!g.aborted){x=w.clk,x&&(b=x.name,b&&!x.disabled&&(f.extraData=f.extraData||{},f.extraData[b]=x.value,"image"==x.type&&(f.extraData[b+".x"]=w.clk_x,f.extraData[b+".y"]=w.clk_y)));var S=1,k=2,D=n("meta[name=csrf-token]").attr("content"),A=n("meta[name=csrf-param]").attr("content");A&&D&&(f.extraData=f.extraData||{},f.extraData[A]=D),f.forceSync?i():setTimeout(i,10);var L,E,M,F=50,O=n.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},X=n.parseJSON||function(e){return window.eval("("+e+")")},C=function(e,t,a){var r=e.getResponseHeader("content-type")||"",i="xml"===t||!t&&r.indexOf("xml")>=0,o=i?e.responseXML:e.responseText;return i&&"parsererror"===o.documentElement.nodeName&&n.error&&n.error("parsererror"),a&&a.dataFilter&&(o=a.dataFilter(o,t)),"string"==typeof o&&("json"===t||!t&&r.indexOf("json")>=0?o=X(o):("script"===t||!t&&r.indexOf("javascript")>=0)&&n.globalEval(o)),o}}}if(!this.length)return r("ajaxSubmit: skipping submit process - no element selected"),this;var s,u,l,c=this;"function"==typeof e&&(e={success:e}),s=this.attr("method"),u=this.attr("action"),l="string"==typeof u?n.trim(u):"",l=l||window.location.href||"",l&&(l=(l.match(/^([^#]+)/)||[])[1]),e=n.extend(!0,{url:l,success:n.ajaxSettings.success,type:s||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},e);var f={};if(this.trigger("form-pre-serialize",[this,e,f]),f.veto)return r("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(e.beforeSerialize&&e.beforeSerialize(this,e)===!1)return r("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var m=e.traditional;void 0===m&&(m=n.ajaxSettings.traditional);var d,p=[],h=this.formToArray(e.semantic,p);if(e.data&&(e.extraData=e.data,d=n.param(e.data,m)),e.beforeSubmit&&e.beforeSubmit(h,this,e)===!1)return r("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[h,this,e,f]),f.veto)return r("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var v=n.param(h,m);d&&(v=v?v+"&"+d:d),"GET"==e.type.toUpperCase()?(e.url+=(e.url.indexOf("?")>=0?"&":"?")+v,e.data=null):e.data=v;var g=[];if(e.resetForm&&g.push(function(){c.resetForm()}),e.clearForm&&g.push(function(){c.clearForm(e.includeHidden)}),!e.dataType&&e.target){var x=e.success||function(){};g.push(function(t){var a=e.replaceTarget?"replaceWith":"html";n(e.target)[a](t).each(x,arguments)})}else e.success&&g.push(e.success);e.success=function(t,a,r){for(var n=e.context||this,i=0,o=g.length;o>i;i++)g[i].apply(n,[t,a,r||c,c])};var b=n("input:file:enabled[value]",this),y=b.length>0,T="multipart/form-data",w=c.attr("enctype")==T||c.attr("encoding")==T,j=i.fileapi&&i.formdata;r("fileAPI :"+j);var S=(y||w)&&!j;e.iframe!==!1&&(e.iframe||S)?e.closeKeepAlive?n.get(e.closeKeepAlive,function(){o(h)}):o(h):(y||w)&&j?a(h):n.ajax(e);for(var k=0;k<p.length;k++)p[k]=null;return this.trigger("form-submit-notify",[this,e]),this},n.fn.ajaxForm=function(e){if(e=e||{},e.delegation=e.delegation&&n.isFunction(n.fn.on),!e.delegation&&0===this.length){var i={s:this.selector,c:this.context};return!n.isReady&&i.s?(r("DOM not ready, queuing ajaxForm"),n(function(){n(i.s,i.c).ajaxForm(e)}),this):(r("terminating; zero elements found by selector"+(n.isReady?"":" (DOM not ready)")),this)}return e.delegation?(n(document).off("submit.form-plugin",this.selector,t).off("click.form-plugin",this.selector,a).on("submit.form-plugin",this.selector,e,t).on("click.form-plugin",this.selector,e,a),this):this.ajaxFormUnbind().bind("submit.form-plugin",e,t).bind("click.form-plugin",e,a)},n.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},n.fn.formToArray=function(e,t){var a=[];if(0===this.length)return a;var r=this[0],o=e?r.getElementsByTagName("*"):r.elements;if(!o)return a;var s,u,l,c,f,m,d;for(s=0,m=o.length;m>s;s++)if(f=o[s],l=f.name)if(e&&r.clk&&"image"==f.type)f.disabled||r.clk!=f||(a.push({name:l,value:n(f).val(),type:f.type}),a.push({name:l+".x",value:r.clk_x},{name:l+".y",value:r.clk_y}));else if(c=n.fieldValue(f,!0),c&&c.constructor==Array)for(t&&t.push(f),u=0,d=c.length;d>u;u++)a.push({name:l,value:c[u]});else if(i.fileapi&&"file"==f.type&&!f.disabled){t&&t.push(f);var p=f.files;if(p.length)for(u=0;u<p.length;u++)a.push({name:l,value:p[u],type:f.type});else a.push({name:l,value:"",type:f.type})}else null!==c&&"undefined"!=typeof c&&(t&&t.push(f),a.push({name:l,value:c,type:f.type,required:f.required}));if(!e&&r.clk){var h=n(r.clk),v=h[0];l=v.name,l&&!v.disabled&&"image"==v.type&&(a.push({name:l,value:h.val()}),a.push({name:l+".x",value:r.clk_x},{name:l+".y",value:r.clk_y}))}return a},n.fn.formSerialize=function(e){return n.param(this.formToArray(e))},n.fn.fieldSerialize=function(e){var t=[];return this.each(function(){var a=this.name;if(a){var r=n.fieldValue(this,e);if(r&&r.constructor==Array)for(var i=0,o=r.length;o>i;i++)t.push({name:a,value:r[i]});else null!==r&&"undefined"!=typeof r&&t.push({name:this.name,value:r})}}),n.param(t)},n.fn.fieldValue=function(e){for(var t=[],a=0,r=this.length;r>a;a++){var i=this[a],o=n.fieldValue(i,e);null===o||"undefined"==typeof o||o.constructor==Array&&!o.length||(o.constructor==Array?n.merge(t,o):t.push(o))}return t},n.fieldValue=function(e,t){var a=e.name,r=e.type,i=e.tagName.toLowerCase();if(void 0===t&&(t=!0),t&&(!a||e.disabled||"reset"==r||"button"==r||("checkbox"==r||"radio"==r)&&!e.checked||("submit"==r||"image"==r)&&e.form&&e.form.clk!=e||"select"==i&&-1==e.selectedIndex))return null;if("select"==i){var o=e.selectedIndex;if(0>o)return null;for(var s=[],u=e.options,l="select-one"==r,c=l?o+1:u.length,f=l?o:0;c>f;f++){var m=u[f];if(m.selected){var d=m.value;if(d||(d=m.attributes&&m.attributes.value&&!m.attributes.value.specified?m.text:m.value),l)return d;s.push(d)}}return s}return n(e).val()},n.fn.clearForm=function(e){return this.each(function(){n("input,select,textarea",this).clearFields(e)})},n.fn.clearFields=n.fn.clearInputs=function(e){var t=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var a=this.type,r=this.tagName.toLowerCase();t.test(a)||"textarea"==r?this.value="":"checkbox"==a||"radio"==a?this.checked=!1:"select"==r?this.selectedIndex=-1:e&&(e===!0&&/hidden/.test(a)||"string"==typeof e&&n(this).is(e))&&(this.value="")})},n.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},n.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},n.fn.selected=function(e){return void 0===e&&(e=!0),this.each(function(){var t=this.type;if("checkbox"==t||"radio"==t)this.checked=e;else if("option"==this.tagName.toLowerCase()){var a=n(this).parent("select");e&&a[0]&&"select-one"==a[0].type&&a.find("option").selected(!1),this.selected=e}})},n.fn.ajaxSubmit.debug=!1});
define("modules/lib/jquery.uploader",function(e){var r=e("jquery"),a=(e("modules/lib/db"),e("modules/lib/jquery.form"),e("lego_modules/modal/0.0.2/modal"),function(e){return e.wrap("<form method='post' enctype='multipart/form-data'></form>"),e.parent()}),t=function(e){e.unwrap()},o=function(e){var r=a(e),o=r.html();return t(e),o},n=function(e,r){var o=a(e);e.replaceWith(r.__html__),e=o.find("input"),"function"==typeof r.resetInput&&r.resetInput(e),t(e),l(e,r)},i=function(e){switch(e){case 110405:r.modal.alert("没有管理权限，请重新刷新页面",function(){location.reload()});break;case 106425:r.modal.alert("不能上传空文件","上传失败");break;case 106439:r.modal.alert("上传的文件类型不对","上传失败");break;case 106444:r.modal.alert("上传的文件过大，请上传2M以内的文件","上传失败");break;case 106465:r.modal.alert("请先选择要上传的文件","上传失败");break;case 106467:case 106468:r.modal.alert("Excel文件出错，请重新上传","上传失败");break;case 106627:r.modal.alert("图片过大，请上传分辨率不超过96dip，尺寸不超过3500*2500大小的图片","上传失败");break;default:r.modal.alert("服务器繁忙，请稍后再试("+(e||-1)+")","上传失败")}},l=function(e,o,l){var u=function(r){t(e),n(e,o),r=r||{};var a=r.retcode;if(0!==a){if("function"==typeof o.error){var l=o.error(r);if(l===!0)return}return i(a)}"function"==typeof o.success&&o.success(r)},f=function(){var t=r.trim(e.val());if(t){if(this.files&&this.files[0]&&this.files[0].size<1)return r.modal.alert("不能上传空文件！"),void n(e,o);if("function"==typeof o.beforeSend){var i=o.beforeSend.call(this);if(i===!1)return void n(e,o)}var l={r:Math.random()},f=o.data;if("object"==typeof f)for(var c in f)l[c]=f[c];a(e).ajaxSubmit({data:l,url:o.url,dataType:o.dataType||"json",success:function(e){u(e)},error:function(){u()}})}};l?f():e.change(f)},u=function(e,r,a){r.url&&(r.__html__=r.__html__||o(e),l(e,r,a))};return{upload:u,show_retcode:i}});
define("components/jubao/main",function(e,t,s){"use strict";function i(){return g.isWeixinUser()?f.get("uid_a2")||"":f.get("skey")||""}function o(e){if(!e)return"";for(var t=5381,s=0,i=e.length;i>s;++s)t+=(t<<5)+e.charAt(s).charCodeAt();return 2147483647&t}function n(e){return null===e||"string"!=typeof e?!0:""===e.trim()}var r=e("modules/lib/db"),c=e("jquery"),l=e("modules/lib/util"),u=100,a="请至少选择一项举报原因",h="因网络原因未提交成功，请重试！",c=e("jquery"),d=e("modules/lib/jquery.uploader"),g=e("modules/lib/login"),f=e("modules/lib/cookie");s.exports={data:{content:"",mobile:"",showHolder:!0,showTips:!1,hasReset:!1,errorMsg:a,isShowCloseBtn:!0,picList:[{src:"",select:!0}],jubaoList:[]},filters:{showRemain:function(e){return!e},showHolder:function(e){return!e.length},countRemain:function(e){var t=e.length||0;return t}},directives:{},methods:{eduShowMessageBox:function(e){window.eduShowMessageBox?window.eduShowMessageBox("提示",e,"ok"):c.modal.alert(e)},uploadFile:function(){var e=this,t=c(this.$el),s=t.find("input.upload-img"),n="";s.off().on("change",function(){var r;console.log("$input","onChange"),d.upload(s,(r={data:{bkn:o(i())},url:"/cgi-bin/course/manager/upload_pic"},r.data={type:2},r.beforeSend=function(){console.log("beforeSend");var s=t.find("input.upload-img"),i=c.trim(s.val());return n=i.substring(i.lastIndexOf(".")+1).toLowerCase(),/\.(PNG|JPG|JPEG|GIF|BMP)$/i.test(i)?this.files&&this.files[0]&&this.files[0].size>2097152?(e.eduShowMessageBox("上传的图片过大，请上传2M以内的图片！"),!1):void 0:(e.eduShowMessageBox("请选择PNG,JPG,GIF,BMP图片上传！"),!1)},r.success=function(t){console.log("success"),t=t||{},t.result&&t.result.url&&e.picList.unshift({src:t.result.url}),4===e.picList.length&&e.picList.pop()},r.error=function(){return console.log("error"),e.eduShowMessageBox("上传失败"),!0},r),!0)}),s.click()},selectPic:function(e,t){console.log(e,t);var s=this;if(t.select===!0)this.uploadFile();else{for(var i=0;i<s.picList.length;i++)if(s.picList[i].src===t.src){s.picList.splice(i,1);break}2!==s.picList.length||s.picList[s.picList.length-1].select||s.picList.push({select:!0,src:""})}},checkItem:function(e,t){var s=!t.select;t.$set("select",s),s&&this.$set("showTips",!1)},setContent:function(e,t){var s=e.target.value.length;u>s&&s>0?(t.$set("content",e.target.value),this.$set("showHolder",!1)):0===s?(this.$set("showHolder",!0),t.$set("content",e.target.value)):(t.$set("content",e.target.value.slice(0,u)),c("#jubao-content").val(e.target.value.slice(0,u)))},closeWindow:function(){this.$emit("jubao.close")},dialogSubmit:function(){for(var e={},t=this.jubaoList,s=this,i=[],o=[],u=0;u<this.picList.length;u++)this.picList[u].src&&o.push(this.picList[u].src);for(var u=0,d=t.length;d>u;u++)t[u].select&&i.push(t[u].label);e.reason=0,e.src=5,e.text=this.content,e.tid=l.getHash("term_id")||l.query("term_id"),e.term_id=e.tid,e.item_info=JSON.stringify(i),e.piclist=JSON.stringify(o),e.t_uin=0,e.mobile=c(".contact-number").val().trim(),!c(".jubao-contact .must").hasClass("hidden")&&n(e.mobile)?(s.$set("errorMsg","请正确填写联系方式"),s.$set("showTips",!0)):0===i.length?(h="请至少选择一项举报原因",s.$set("errorMsg",a),s.$set("showTips",!0)):r.postJubao(e).done(function(){s.$set("picList",[{src:"",select:!0}]),s.$set("content","");for(var e=0,t=s.jubaoList.length;t>e;e++)s.jubaoList[e].$set("select",!1);s.$set("showTips",!1),s.closeWindow(),s.$emit("jubaotip.show")}).fail(function(e){switch(s.$set("showTips",!0),e.retcode){case 100003:s.$set("errorMsg","提交参数错误");break;case 108011:s.$set("errorMsg","你已经举报了3次该课程");break;default:s.$set("errorMsg",h)}})},dialogCancel:function(){this.$emit("jubao.close")}},ready:function(){}}});
define("modules/lib/platform",function(t,i,n){n.exports={isMac:function(){return/mac/i.test(navigator.platform)}}});
define("components/feedbacktip/main",function(e,t,i){"use strict";function c(){}var s=e("jquery"),n=e("modules/lib/db"),o=e("modules/lib/util"),a=e("modules/lib/platform");c.prototype={constructor:c,_bindEvent:function(){}},i.exports={data:{isShow:!1,isShowCloseBtn:!0,issue_type:[{text:"画面模糊",value:0,checked:!1},{text:"画面卡顿",value:1,checked:!1},{text:"等待时间过长",value:2,checked:!1},{text:"声音模糊",value:3,checked:!1},{text:"声音卡顿",value:4,checked:!1},{text:"无法聊天",value:5,checked:!1}],issue_times:[{text:"一次",value:0,checked:!1},{text:"二至三次",value:1,checked:!1},{text:"三次以上",value:2,checked:!1}],issue_detail:"",noSubmit:!0},filters:{notMac:function(){return!a.isMac()}},directives:{},methods:{showWindow:function(){this.$emit("feedback.show")},closeWindow:function(){this.$emit("feedback.close")},set_issue_detail:function(e){var t=s(e.target).val();t.length<300?this.$set("issue_detail",t):(s(e.target).val(t.slice(0,300)),this.$set("issue_detail",t.slice(0,300)))},checkSubmit:function(){var e=this,t=["issue_type","issue_times"],i=new Array(t.length);s(i).each(function(e){i[e]=!0}),s(t).each(function(t,c){s(e[c]).each(function(e,c){return c.checked?(i[t]=!1,!1):void 0})}),e.$set("noSubmit",!1),s(i).each(function(t,i){i&&e.$set("noSubmit",!0)})},clear:function(){var e=this,t=["issue_type","issue_times"];s(t).each(function(t,i){s(e[i]).each(function(e,t){t.$set("checked",!1)})}),s(e.$el).find(".js_issue_detail_box").val(""),e.$set("issue_detail",""),e.$set("noSubmit",!0)},dialogSubmit:function(){if(!this.noSubmit){var e=this,t="",i="";s(e.issue_type).each(function(e,i){i.checked&&(t=i.text)}),s(e.issue_times).each(function(e,t){t.checked&&(i=t.text)}),n.postFeedback({course_id:o.getUrlParam("course_id"),term_id:o.getUrlParam("term_id"),task_id:o.getUrlParam("taid"),question:t,times:i,content:e.issue_detail}).done(function(){e.clear(),s.modal.success('<i class="icon-font icon-msg-large i-success"></i>提交成功！<br><div style="margin-top:10px;">很抱歉给您的上课带来不便，我们将会尽快跟进解决您提的问题，感谢您的合作！</div>',{title:"提交成功",icon:""})}),e.closeWindow()}},dialogCancel:function(){this.closeWindow()},backToOld:function(){this.$emit("feedbackBox.backToOld"),this.closeWindow()},activeRadio:function(e,t){var i=s(e.delegateTarget).attr("data-name");window.e=e,s(this[i]).each(function(e,t){t.$set("checked",!1)}),t.$set("checked",!0),this.checkSubmit()}},ready:function(){}}});
define("components/jubaotip/main",function(i,t,o){"use strict";o.exports={data:{isShowCloseBtn:!0},filters:{},directives:{},methods:{closeWindow:function(){this.$emit("jubaotip.close")},dialogCancel:function(){this.$emit("jubaotip.close")}},ready:function(){}}});
define("components/errortip/main",function(i,n,t){"use strict";t.exports={data:{content:"请先报名一个课程!",isShowCloseBtn:!0},filters:{},directives:{},methods:{closeWindow:function(){this._fail()},dialogCancel:function(){this._fail()},_fail:function(){window.location.href="//ke.qq.com/user/index/index.html"}},ready:function(){}}});
define("pages/index/playerheader/main",function(e,t,o){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function c(){function e(e){t=e,document.title=e}var t=document.title.split("#")[0],o=!(!navigator.userAgent.match(/Trident/)||!navigator.userAgent.match(/rv:11.0/));document.attachEvent&&document.attachEvent("onpropertychange",function(e){"title"===e.propertyName&&document.title!==t&&setTimeout(function(){document.title=t},1)}),o&&document.addEventListener&&document.addEventListener("DOMCharacterDataModified",function(){document.title!==t&&setTimeout(function(){document.title=t},1)}),e(t)}function l(){var e=v.get("#ke-playlist"),t=$(e.$el).find(".js-course-title");$(t).each(function(e,t){var o=+$(t).css("maxWidth").replace("px",""),s=$(t).nextAll(".js-tt-suffix");$(t).css("maxWidth","0px");var n=o-$(s).width();$(t).css("maxWidth",n+"px")})}var u,h,m,p,f=e("lego_modules/imweb-base-qjs/0.1.1/src/controller"),d=s(f),w=e("modules/lib/util"),$=e("jquery"),g=e("modules/lib/login"),b=e("modules/lib/platform"),C=e("lego_modules/util.bom/0.0.1/util.bom"),v=e("modules/lib/Q"),T=e("modules/lib/util.cookie"),k=e("modules/lib/db"),y=function(e){function t(){n(this,t);var o=i(this,e.call(this));return o.components={playList:"#ke-playlist",keComment:"#ke-comment",keShare:"#ke-share"},o}return r(t,e),t.prototype.init=function(){this._init()},t}(d["default"]),S=new y;o.exports={data:{showPlaylist:!1,showShare:!1,showComment:!1,showJubao:!1,showJubaotip:!1,isShowDealTips:!1,showFeedback:!1,showCommentTips:!1,showCommentBtn:!1,showShareTips:!1,showError:!1,isQQUser:g.isWeixinUser()?!1:!0,isShowTurnBack:!1,isShowFeedBack:!1,isTeacherView:!1,roomUrl:"",courseSubTitle:"",initComment:!1,initPlaylist:!0,courseInfo:null,showSign:!1,isClient:1===parseInt(C.query("client"))},filters:{length:function(e){return e&&e.length},getTipClass:function(e){return e?"i-success":"i-info"},getCommentTips:function(e){return e?'<span class="green">已达成</span>':'<span class="gray">未达成</span>'},once:function(){var e=!1;return function(t){return e?t:(e=!0,!0)}}(),setPlayListName:function(e){S.playList.$set("courseName",e.replace(/[《》]/g,""))}},directives:{},methods:{closeDealTips:function(){console.log("closeDealTips"),this.$set("isShowDealTips",!1),T.set("isHideDealTipsWebCourse",1)},toggleMenu:function(e){e&&a(e);var t=this;t.$set("showPlaylist",!t.showPlaylist),t.initPlaylist&&t.showPlaylist&&(l(),t.$set("initPlaylist",!1)),$("#play-list").nanoScroller(),t.$emit("MenuClick.report",{obj1:t.showPlaylist?1:2,ver3:m,ver9:p})},setSignInfo:function(e){this.$set("showSign",e)},toggleCourse:function(e,t){t.$set("toggle",!t.toggle)},partSelect:function(e,t){this.$set("courseIndex",0),this.$set("index",t.id)},courseSelect:function(e,t){this.$set("index",0),this.$set("courseIndex",t.id)},doFeedback:function(){var e="";e=this.isQQUser?"http://support.qq.com/write.shtml?fid=1042":"http://support.qq.com/write.shtml?guest=1&fid=1042",window.open(e)},showFeedbackBox:function(){var e=this;e.$set("showFeedback",!0)},doContact:function(){var e=this;window.open(w.htmlDecode(this.serviceqq.url)),e.$emit("ContactClick.report",{ver3:m,ver9:p})},doJubao:function(){var e=this;this.closeDealTips(),e.$set("showCommentTips",!1),e.$set("showComment",!1),e.$set("showJubao",!0);$(".jubao-reason .label-list-item:first-child");k.getJubaoItem({tid:w.getUrlParam("term_id")}).done(function(e){var t=e.mobile,o=v.get("#ke-jubao");o.$set("jubaoList",[]),("undefined"==typeof t||""===t||null===t)&&(t="",$(".jubao-contact .must").addClass("hidden")),o.$set("mobile",t);for(var s=0;s<e.items.length;s++)o.jubaoList.push({label:e.items[s],select:!1})}),e.$emit("ReportClick.report",{ver3:m,ver9:p})},doCommentTips:function(){var e=this;h=!0,e.showCommentTips||e.canComment||(e.$set("showShareTips",!1),e.$set("showCommentTips",!0))},hideCommentTips:function(){var e=this;h=!1,setTimeout(function(){h||(e.$set("showCommentTips",!1),h=!1)},500)},doComment:function(){var e=this;e.canComment&&(e.$set("showComment",!0),S.keComment.show(),e.$emit("CommentClick.report",{ver3:m,ver9:p}))},setHeaderInfo:function(e){var t=["name","serviceqq"];c(),e.name=e.name.replace(/^《+/g,"《").replace(/(》+)$/g,"》"),this.$set("courseInfo",e),console.log("courseInfo",this.courseInfo,11),this._formatKeys(t,e),S.playList.setData(e),S.keShare.setData(e),this.checkExprDoc()},checkExprDoc:function(){3===+w.getUrlParam("ac_type")&&(this.toggleMenu(),$(".js-course-list-header").each(function(e,t){return+$(t).attr("resid")===+w.getUrlParam("cw_id")?($(t).closest(".js-chapter-course").prev(".js-chapter-course-title").click(),$(t).click(),!1):void 0}))},_formatKeys:function(e,t){for(var o=0,s=e.length;s>o;o++)this.$set(e[o],t[e[o]])},showShare:function(){u=!0,this.$set("showCommentTips",!1),this.$set("showShareTips",!0)},hideShare:function(){var e=this;u=!1,setTimeout(function(){u||(e.$set("showShareTips",!1),u=!1)},500)},closeComment:function(e){var t=e.target;"comment-dialog"===t.className&&this.$set("showComment",!1)},closeJubao:function(e){console.log("closeJubao",e.target.className),"jubao-dialog"===e.target.className&&this.$set("showJubao",!1)},closeFeedback:function(e){"feedback-dialog"===e.target.className&&this.$set("showFeedback",!1)},setCommentInfo:function(e,t){var o=this,s=!0,n=e.list;switch(e.retcode){case 0:for(var i=0,r=n.length;r>i;i++)s=s&&n[i].uint32_status;o.$set("canComment",s),o.$set("conditions",n),o.$set("isApplied",e.isApplied);break;default:o.$set("canComment",!1)}o.canComment?(o.$set("showShareTips",!1),o.$set("showJubao",!1),o.$set("showCommentTips",!1),o.$set("showCommentError",!1)):o.$set("showShareTips",!1),o.showCommentBtn&&(o.$set("initComment",!0),S.init(),S.keComment.setTid(t))},jumpToTask:function(){var e=this;window.open("//ke.qq.com/course/"+w.getUrlParam("course_id")),e.$emit("TitleClick.report",{ver3:m,ver9:p})},gotoSign:function(){var e=this,t=w.getUrlParam("term_id"),o=w.getUrlParam("course_id");window.open("//ke.qq.com/course/"+o+"#term_id="+t+"&pay=1&webcourse=1"),e.$set("showSign",!1),e.$emit("SignClick.report",o,t)},closeSign:function(){this.$set("showSign",!1)},setTurnBack:function(e,t){var o=!b.isMac();1===e?(this.isQQUser&&o&&this.$set("isShowTurnBack",!0),this.$set("roomUrl",t)):this.$set("isShowTurnBack",!1)},setFeedBack:function(e,t){1===e?this.$set("isShowFeedBack",!0).$set("roomUrl",t):this.$set("isShowFeedBack",!1)},enterRoom:function(){this.$emit("playerheader.enterRoom");var e=document.createElement("p");e.innerHTML=this.roomUrl;var t=e.innerText||e.textContent;this.$emit("playerheader.leaveRoom"),$("#keplayer").remove(),window.open(t,"_self")},checkDealTips:function(){1!=T.get("isHideDealTipsWebCourse")&&(console.log("isShowDealTips","cookie"),this.$set("isShowDealTips",!0))}},ready:function(){var e=this;1===+w.getUrlParam("tv")&&e.$set("isTeacherView",!0),S.init(),this.$on("jubao.close",function(){e.$set("showJubao",!1)}).$on("feedback.close",function(){e.$set("showFeedback",!1)}).$on("comment.close",function(){e.$set("showComment",!1)}).$on("share.hide",function(){e.$set("showShareTips",!1)}).$on("jubaotip.show",function(){e.$set("showJubaotip",!0)}).$on("jubaotip.close",function(){e.$set("showJubaotip",!1)}).$on("title.change",function(t){e.$set("courseSubTitle",t),document.title=t}).$on("error.show",function(){e.$set("showError",!0)}).$on("data.report",function(e,t){m=e,p=t}).$on("share.report",function(t){t.ver3=m,t.ver9=p,e.$emit("CourseShare.report",t)}).$on("slideup.menu",function(){e.$set("showPlaylist",!1)}).$on("header.toggleMenu",function(){e.toggleMenu()}).$on("playerheader.showCommentBtn",function(){e.$set("showCommentBtn",!0)}).$on("playerheader.hideCommentBtn",function(){e.$set("showCommentBtn",!1)}),window.__COMMENT_CALLBACK=function(){e.$set("showComment",!1)},$("body").on("click",function(t){!$(t.target).hasClass("i-share")&&e.$set("showShareTips",!1),!$(t.target).hasClass("i-ke-comment")&&e.$set("showCommentTips",!1),!$(t.target).hasClass("menu-toggle-icon")&&e.$set("showPlaylist",!1)}).on("click","#ke-playlist",function(e){a(e)})}}});
define("modules/lib/checkFlashPlayerInstalled",function(e,a,i){i.exports={flashChecker:function(){var e,a=0,i=0,n=window.ActiveXObject;if(document.all&&n)try{if(e=new n("ShockwaveFlash.ShockwaveFlash")){a=1;var t=e.GetVariable("$version");i=parseInt(t.split(" ")[1].split(",")[0])}}catch(l){a=0}else if(navigator.plugins&&navigator.plugins.length>0&&(e=navigator.plugins["Shockwave Flash"])){a=1;for(var s=e.description.split(" "),r=0;r<s.length;++r)isNaN(parseInt(s[r]))||(i=parseInt(s[r]))}return{f:a,v:i}}}});
define("pages/index/player/imweblog/cache",function(e,n){"use strict";function t(){var e=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;if(null!=e){var n=e.open(d);n.onupgradeneeded=function(e){var n=e.target,t=n.result,r=n.transaction;t.createObjectStore(d,{autoIncrement:!0}),r.oncomplete=function(){u=t,o()}},n.onsuccess=function(e){u=e.target.result,o()}}}function o(){u.onerror=function(){t()}}function r(){return void 0!==u}function c(e){try{u.transaction([d],"readwrite").objectStore(d).add(e)}catch(n){}}function a(e){try{u.transaction([d],"readwrite").objectStore(d)["delete"](e)}catch(n){}}function i(e){try{u.transaction([d],"readonly").objectStore(d).openCursor().onsuccess=function(n){var t=n.target.result;if(t){var o=t.value,r=t.key;e(o,r),t["continue"]()}}}catch(n){}}Object.defineProperty(n,"__esModule",{value:!0}),n.supportCache=r,n.add=c,n.remove=a,n.each=i;var d="ULS_LOG",u=void 0;t()});
define("pages/index/player/imweblog/util",function(e,o){"use strict";function n(){return Math.random()+Date.now()}function t(e){delete e.TTL;var o=[];for(var n in e)if(e.hasOwnProperty(n)){var t=e[n];null!=t&&o.push(n+"="+encodeURIComponent(t))}var r=c+"?"+o.join("&"),i=new Image;i.src=r}function r(){l.supportCache()&&l.each(function(e,o){var n=e||{},r=n.TTL,i=n.i;(!r||Date.now()-i<r)&&t(e),l.remove(o)})}function i(e){var o=e.immediately,r=void 0===o?!0:o,i=e.sample,u=void 0===i?1:i,c=e.log,d=e.level,y=e.module,p=e.cacheTTL,s=e.unSupportCacheLogHandler,m=void 0===s?t:s;if(null!==c&&void 0!==c&&""!==c){var v=n();if(1>u){var b=1-u,h=Math.random();if(b>h)return}var g="undefined"==typeof c?"undefined":f(c);"object"===g?c=JSON.stringify(c):"string"!==g&&(c=String(c));var S=[];if(c.length>a){for(var T=Math.floor(c.length/a);T>=0;){var L=T*a;S.unshift(c.substring(L,L+a)),T--}delete e.log}else S.push(c);c=null,S.forEach(function(e){var o={i:v,l:e,le:d,m:y};r?t(o):(p>0&&(o.TTL=p),l.supportCache()?l.add(o):"function"==typeof m&&m(o))})}}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(o,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"===u(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":u(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":u(e)};o.uuid=n,o.flushCachedLog=r,o.handleLog=i;var l=e("pages/index/player/imweblog/cache"),a=1e3,c="https://badjs2.qq.com/ulslog"});
define("pages/index/player/imweblog/index",function(e,n){"use strict";function o(e){n.BaseOptions=i=r({},i,e);var o=i,t=o.autoFlushCachedLog,a=void 0===t?10:t;a>0?u=setInterval(l.flushCachedLog,a):clearInterval(u)}function t(e,n){return l.handleLog(r({},i,n,{log:e,level:0}))}function a(e,n){return l.handleLog(r({},i,n,{log:e,level:1}))}Object.defineProperty(n,"__esModule",{value:!0}),n.flushCachedLog=n.BaseOptions=void 0;var r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e};n.init=o,n.info=t,n.error=a;var l=e("pages/index/player/imweblog/util");Object.defineProperty(n,"flushCachedLog",{enumerable:!0,get:function(){return l.flushCachedLog}});var i=n.BaseOptions={autoFlushCachedLog:10,module:"test_module",immediately:!0,sample:1},u=void 0});
define("pages/index/player/flash_log",function(e){"use strict";function n(e){s.push(e),s.length>15&&(o(s.join("\n")),s.length=0)}function o(e){u.info(e)}function i(){s.length>0&&(o(s.join("\n")),s.length=0),u.flushCachedLog(),console.log("上报成功，清空数据库")}function l(){$.ajax({url:a,dataType:"json",success:function(e){for(var n=e.result,o=0;o<n.length;o++)if(c==n[o])return void setTimeout(i,1e3)}})}function t(){window.__flash_log=n,l()}e("jquery"),e("lego_modules/util.cookie/0.0.3/util.cookie");var u=e("pages/index/player/imweblog/index"),a="//sas.qq.com/cgi-bin/ke_config_flashlog",c=$.cookie.uin();u.init({module:"ke_flash_log",immediately:!1,cacheTTL:6048e5,autoFlushCachedLog:!1,unSupportCacheLogHandler:function(){}});var s=[];t()});
define("pages/index/player/main",function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=e("lego_modules/imweb-base-qjs/0.1.1/src/controller"),o=a(r),c=e("jquery"),h=e("modules/lib/promise"),d=e("modules/lib/checkFlashPlayerInstalled").flashChecker;e("lego_modules/modal/0.0.2/modal");var u=function(e){function t(){return s(this,t),l(this,e.call(this))}return n(t,e),t.prototype.init=function(e){this._init(e)},t}(o["default"]),f=new u;if(i.exports={data:{isShow:!1,livePlayerId:"keplayer",playerStyle:{width:"0px",height:"0px"},isHasFlash:!0,needSign:!1,flashvars:"",tcpListVars:"",onlineFlashLoaded:!1,obejctHtml:"",hideTimer:-1,price:0},filters:{getUnInstallStyle:function(){var e;return e=this.isHasFlash?"":"display:block;",e+="width:"+this.playerStyle.width}},directives:{},methods:{setPlayerStyle:function(e){var t=this;this.$set("playerStyle",e),t._flashDomReadyPromise().then(function(){var t=document.querySelector("object.player"),i=document.querySelector("embed.player");t&&t.style&&(t.style.width=e.width,t.style.height=e.height),i&&i.style&&(i.style.width=e.width,i.style.height=e.height)})},setObjectHtml:function(){var e=d(),t='<object id="'+this.livePlayerId+'-object" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=11,0,0,0" class="player" id="'+this.livePlayerId+'" style="width:'+this.playerStyle.width+";height:"+this.playerStyle.height+';" align="middle"><param name="movie" value="'+this.playerSrc+'" /><param name="flashvars" value="'+this.flashvars+'" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /><param name="quality" value="high" /><param name="wmode" value="transparent" /><param name="bgcolor" value="#000000" /><embed id="'+this.livePlayerId+'-embed" name="'+this.livePlayerId+'" class="player" style="width:'+this.playerStyle.width+";height:"+this.playerStyle.height+';" flashvars="'+this.flashvars+'" src="'+this.playerSrc+'"  wmode="transparent" quality="high" bgcolor="#000000" align="middle" allowscriptaccess="always" allowfullscreen="true" type="application/x-shockwave-flash" pluginspage="http://get.adobe.com/cn/flashplayer/" /></object>';this.$set("isHasFlash",1===e.f),this.$emit("flash.flashChecker",{f:e.f,v:e.v}),this.$set("obejctHtml",t)},loadFlash:function(){var e=this,t=function(e){var t="";for(var i in e)e.hasOwnProperty(i)&&(t+="&"+encodeURIComponent(i)+"="+encodeURIComponent(JSON.stringify(e[i])));return t.replace(/^&/,"")},i=function(){return{keplayer:"41",sdk:"21"}},a={};a.version=i(),a.show=!0,e.$set("flashvars",t(a)),e.$set("playerSrc","//7.url.cn/edu/webcourse/swf/loader/1/loader.swf"),e.setObjectHtml(),""!==e.tcpListVars&&e.setTcpListVars()},setTcpListVars:function(e){e=e||this.tcpListVars,this.$set("tcpListVars",e)},setPrice:function(e){this.$set("price",e)},show:function(){void 0!==this.hideTimer&&-1!==this.hideTimer&&(clearTimeout(this.hideTimer),this.$set("hideTimer",-1)),this.$set("isShow",!0),(""===this.obejctHtml||void 0===this.obejctHtml)&&this.loadFlash()},hide:function(){var e=this,t=setTimeout(function(){e.$set("isShow",!1),e.$set("onlineFlashLoaded",!1),e.$set("obejctHtml",""),e.$set("hideTimer",-1)},2e3);e.$set("hideTimer",t)},getFlash:function(){var e=this.livePlayerId;return window.document[e]?window.document[e]:-1!==navigator.appName.indexOf("Microsoft Internet")?document.getElementById(e):document.embeds&&document.embeds[e]?document.embeds[e]:void 0},_flashDomReadyPromise:function(){var e=this,t=function i(t){var a=e.getFlash();a?t(a):setTimeout(function(){i(t)},100)};return new h(function(e){t(e)})},_flashLoadedPromise:function(){var e=this;return new h(function(t){var i=e.onlineFlashLoaded;i?t(i):e.$once("player.flashLoaded",function(){t(e.onlineFlashLoaded)})})},getFlashPromise:function(){var e=this;return new h(function(t){h.all([e._flashDomReadyPromise(),e._flashLoadedPromise()]).then(function(e){t(e[0])})})},showPauseDialog:function(){this.callFlashFunc("showPauseDialog")},hidePauseDialog:function(){this.callFlashFunc("hidePauseDialog")},setAttendTime:function(e){this.callFlashFunc("setAttendTime",e)},callFlashFunc:function(e){var t=arguments;this.getFlashPromise().then(function(i){var a=function s(){if(i&&i[e])switch(t.length){case 1:i[e]();break;case 2:i[e](t[1]);break;case 3:i[e](t[1],t[2]);break;case 4:i[e](t[1],t[2],t[3]);break;case 5:i[e](t[1],t[2],t[3],t[4]);break;case 6:i[e](t[1],t[2],t[3],t[4],t[5])}else setTimeout(s,30)};a()})}},ready:function(){f.init(this);var e=this;window.__keplayer_exc__=function(t){try{t=JSON.parse(t)}catch(i){return void console.error(i)}e.$emit("flash.log",t,e.needSign)},window.__keplayer_dialog__=function(t,i){e.isShow&&c.modal.alert(i)},window.__keplayer_getTcpListVars__=function(){if(""===e.tcpListVars)return null;var t=e.tcpListVars.split("&"),i=t[0].split("=")[1],a=t[1].split("=")[1],s=t[2].split("=")[1];return{tcp_list:i,key:a,uid:s,price:e.price}},window.__keplayer_loaded__=function(){e.$set("onlineFlashLoaded",!0),e.$emit("player.flashLoaded")}}},Object.defineProperty)try{e("pages/index/player/flash_log")}catch(p){window.console.log("flash_log error:",p)}});
define("lego_modules/check/0.0.2/check",function(e){e("lego_modules/util.cookie/0.0.3/util.cookie");var i=e("jquery");return{isWeixinUser:function(){var e=i.cookie.get("uid_type");return 2==e?!0:!1}}});
define("pages/index/tcplayer/main",function(e,t,a){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=e("lego_modules/modal/0.0.2/modal"),o=e("modules/lib/db"),l=e("modules/lib/util"),s=e("modules/lib/checkFlashPlayerInstalled").flashChecker,r=e("lego_modules/util.cookie/0.0.3/util.cookie"),c=e("lego_modules/check/0.0.2/check"),d=function(){function e(){i(this,e),this.classTimeIntervalId=-1,this.checkStreamIntervalId=-1,this.attendTime=0,this.isStreamInterupt=!1,this.playState=null}return e.prototype.startTick=function(){var e=this;e.stopTick(),e.classTimeIntervalId=setInterval(function(){if(e.attendTime>0){var t=.001*Math.floor((new Date).getTime()-e.attendTime),a=Math.floor(t/3600),i=Math.floor((t-3600*a)/60),n=Math.floor(t%60),o=(10>a?"0"+a:a)+":"+(10>i?"0"+i:i)+":"+(10>n?"0"+n:n);$(".vcp-timelabel").text(o)}},1e3)},e.prototype.stopTick=function(){var e=this;-1!==e.classTimeIntervalId&&clearInterval(e.classTimeIntervalId),e.classTimeIntervalId=-1},e.prototype.hasClass=function(e,t){return e.className.match(RegExp("(\\s|^)"+t+"(\\s|$)"))},e.prototype.addClass=function(e,t){this.hasClass(e,t)||(e.className+=" "+t)},e.prototype.createWaitingTip=function(e,t){var a=this;if(e&&e.el){{var i=document.createElement("div");document.createElement("img")}a.addClass(i,t),e.el.appendChild(i)}},e.prototype.removePlayerLoading=function(e){e&&e.loading&&(e.loading.el.innerHTML="")},e.prototype.checkStream=function(){var e=this;e.checkStreamIntervalId=setInterval(function(){e.isStreamInterupt&&"PLAYING"===e.playState&&e.checkRtmpStreamStatus(function(){n.retry("测试",{title:"重试",content:"老师端已断流，刷新页面尝试重新进入"}).yes(function(){window.location.reload()})}),e.isStreamInterupt=!0},2e3)},e.prototype.checkRtmpStreamStatus=function(e){var t=this,a=l.getUrlParam("term_id");o.getRtmpStreamStatus({roomid:a}).done(function(a){0===a.uint32_status&&(t.removeStreamCheck(),e&&e())})},e.prototype.removeStreamCheck=function(){clearInterval(this.checkStreamIntervalId),this.checkStreamIntervalId=-1},e.prototype.authentication=function(e){var t=this,a=l.getUrlParam("term_id");o.rtmpAuthentication({roomid:a,op_cmd:"live_auth"}).done(function(a){0==a.int32_result?e&&e(a):t.authenFaillCallBack(a)})},e.prototype.authenFaillCallBack=function(e){e&&n.alert("测试",{title:"提示",content:e.str_err_msg}).yes(function(){window.location.href="//ke.qq.com/user/index/index.html"})},e}(),h=new d;a.exports={data:{isShow:!1,isHasFlash:!1,isPlaying:!1,live:!0,autoPlay:!0,coverPic:null,opcmd:"live_auth",width:0,height:0,player:null,livePlayerId:"tcplayer",waittingTipClass:"tcp-waiting-tip"},filters:{getUnInstallStyle:function(){var e=this,t=e.isHasFlash?"":"display:block;";return t+="width:"+e.width+"px;",t+="height:"+e.height+"px"}},methods:{show:function(){var e=this,t=s();e.isShow||(e.$set("isShow",!0),e.$set("isHasFlash",1===t.f),h.authentication(e.createPlayer.bind(e)))},hide:function(){var e=this;e.$set("isShow",!1),e.$set("isPlaying",!1),h.stopTick(),h.removeStreamCheck()},play:function(){var e=this;e.player||(e.player=new window.TcPlayer(e.livePlayerId,e.getTcPlayerOptions()),h.removePlayerLoading(e.player),h.createWaitingTip(e.player,e.waittingTipClass),e.player.listener=e.registerEventListener.bind(e),e.setWaittingTipShow(!0,!0))},createPlayer:function(e){var t=this,a=-1;e&&e.msg_subcmd0x1_rsp_txcloud_live_auth&&t.$set("opcmd",e.msg_subcmd0x1_rsp_txcloud_live_auth.str_op_cmd),window.TcPlayer?t.play():a=setInterval(function(){window.TcPlayer&&(clearInterval(a),t.play())},100)},registerEventListener:function(e){var t=this;if(e)switch(e.type){case"error":t.onError(e);break;case"loadedmetadata":t.onLoadedMetaData();break;case"loadeddata":t.onLoadedData(e);break;case"load":t.onLoad(e);break;case"ended":t.onEnded(e);break;case"onresize":t.onResize(e);break;case"fullscreen":t.onFullscreen(e);break;case"timeupdate":t.onTimeUpdate(e);break;case"play":t.onPlay(e);break;case"pause":t.onPause(e);break;case"progress":break;case"seeking":break;case"seeked":break;case"volumechange":}},onPlay:function(e){h.playState=e.detail.playState},onPause:function(e){h.playState=e.detail.playState},onTimeUpdate:function(){h.isStreamInterupt=!1,-1==h.checkStreamIntervalId&&h.checkStream()},onResize:function(){},onFullscreen:function(){},onEnded:function(e){var t=this;h.checkRtmpStreamStatus(function(){t.setWaittingTipShow(!0,!1),h.stopTick(),h.removeStreamCheck(),h.playState=e.detail.playState})},onLoadedMetaData:function(){var e=this;e.setWaittingTipShow(!1),h.startTick()},onError:function(){var e=this;e.setWaittingTipShow(!1)},onLoadedData:function(){},onLoad:function(){this.$set("isPlaying",!0)},getTcPlayerOptions:function(){var e=this,t="",a="",i=r.uin(),n=l.getUrlParam("term_id");c.isWeixinUser()?(t=r.get("uid_a2")||"",a=e.opcmd):(t=r.get("p_skey")||"",a=t);var o={rtmp:"rtmp://7800.liveplay.myqcloud.com/edulive/7800_"+n+"?uin="+i+"&pskey="+a+"&roomid="+n+"&platform=3&op_cmd="+e.opcmd,flv:"http://7800.liveplay.myqcloud.com/edulive/7800_"+n+".flv?uin="+i+"&pskey="+t+"&roomid="+n+"&platform=3&op_cmd="+e.opcmd,m3u8:"http://7800.liveplay.myqcloud.com/edulive/7800_"+n+".m3u8?uin="+i+"&pskey="+t+"&roomid="+n+"&platform=3&op_cmd="+e.opcmd,coverpic:e.coverPic||null,autoplay:e.autoPlay,live:e.live,width:e.width,height:e.height};return o},setPlayerSize:function(e){var t=this,a=document.querySelector(".flashUnInstall"),i=document.querySelector(".vcp-player");(e.width!=t.width||e.height!=t.height)&&(t.width=e.width,t.height=e.height,t.player&&(t.player.options.width=t.width,t.player.options.height=t.height),a&&(a.style.width=t.width+"px",a.style.height=t.height+"px"),i&&(i.style.width=t.width+"px",i.style.height=t.height+"px"))},setTcPlayerParams:function(e,t,a){this.coverPic=a||null,this.live=e||!0,this.autoPlay=t||!0},setAttendTime:function(e){h.attendTime=e},setWaittingTipShow:function(e,t){var a=this,i=document.querySelector("."+a.waittingTipClass);i&&(e?(t?(i.className+=" classing",i.className=i.className.replace(" classOver","")):(i.className+=" classOver",i.className=i.className.replace(" classing","")),i.style.display="block"):i.style.display="none")}}}});
define("pages/index/chat/main",function(e,t,i){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a,c,u,l=e("lego_modules/imweb-base-qjs/0.1.1/src/controller"),d=o(l),h=e("modules/lib/db"),f=e("modules/lib/util"),m=e("modules/lib/cookie"),p=e("jquery"),g=e("lego_modules/observer/0.0.1/observer"),_=(e("modules/lib/format"),e("modules/lib/report.tdw").tdw),b=e("modules/lib/faceReplace"),y=e("pages/index/report.index").monitor,k=[],I=f.getHash("course_id")||f.query("course_id"),w=function(e){return _(p.extend(e,{module:"WebLive",ver1:I}))},v=function(){var e,t,i,o=1e3,n="0",r=0,s=!1,u=!1;return{init:function(e,o){return t=e,i=o,this},start:function(){var e=this;c?this._start():this.getToken().done(function(){e._start()})},_start:function(){var t=this;u=!1,this.getMsg().always(function(){u||(e=setTimeout(function(){t._start()},o))}).done(function(){s&&(s=!1,a.userChangeHandler(),i.$emit("chat.firstConnect"))})},stop:function(){n="0",clearTimeout(e),u=!0},getToken:function(){return h.getToken({term_id:t,seq:n}).done(function(e){c=e.token}).fail(function(e,t){window.BJ_REPORT.info("getToken|"+JSON.stringify(e)+"|"+JSON.stringify(t)),a.stopLongPoll()})},getMsg:function(){var e=this;return h.getPushData({tid:t,seq:n,token:c,next_heart:r,taskid:a.taskInfo.taid,ts:JSON.stringify(k)}).done(function(t){e.getMsgSucc(t)}).fail(function(t){switch(window.BJ_REPORT.info("longpoll|"+JSON.stringify(t)),i.$emit("chat.fail"),t.retcode){case 100001:t.result&&t.result.getToken?e.getToken():a.stopLongPoll()}})},getMsgSucc:function(e){if(n=e.seq||n||0,e&&e.msgList){if(e.msgList.length){for(var t,i=e.msgList,o=a.userInfo.uin,s=[],c=0,u=i.length;u>c;c++)t=i[c],t.uin!=o&&(t.role=a.isTeacher(t.uin)?1:0,s.push(i[c]));a.setChatMsg(s.reverse())}e.sysMsgList.length&&a.handleSysMsg(e.sysMsgList),e.getToken&&this.getToken();for(var l=e.sysMsgList.concat(e.msgList),d=0,h=l.length;h>d;d++)l[d].flag&&k.push(l[d].seq);k.sort(function(e,t){return t-e});for(var f=0,m=k.length;m>f;f++)k[0]-k[f]>1e5&&(k.length=f);r=e.nextHeart,e.teacherUin&&(window.__keplayer_teacherUin__=e.teacherUin)}}}},C=function(){var e=0,t=65535;return{get:function(){return++e>t&&(e=1),e}}}(),T=function(){var e={},t=!1;return{init:function(t){if(t)for(var i=0,o=t.length;o>i;i++)e[t[i].uin]=!0},isForbit:function(t){return e[t]},add:function(t){e[t]=!0},del:function(t){delete e[t]},setIsAllForbit:function(e){t=e},isAllForbit:function(){return t}}}(),M=function(){var e={},t={bmp:1,jpg:2,gif:3};return{add:function(i,o){e[i]=t[o]||0},get:function(t){return e[t]},del:function(t){delete e[t]}}}(),L=function(e){function t(){n(this,t);var i=r(this,e.call(this));return i.components={keNotice:"#ke-notice",keChatlist:"#ke-chatlist",keEditor:"#ke-editor",keToolbar:"#ke-toolbar",keMemberlist:"#ke-memberlist"},i.userInfo={},i._isInit=!1,i.__current_num=1,i.membersPerPage=20,i._readyLoginInfo=!1,i._isInitUserInfo=!1,i._readyCourseInfo=!1,i}return s(t,e),t.prototype.init=function(e){this._isInit||(this.MAXMSGCONFIG={strLength:200,img:3},this._isInit=!0,this._init(e),this.courseId=+f.getUrlParam("course_id"),this.termId=+f.getUrlParam("term_id"),this.reportTDW())},t.prototype.reportTDW=function(){w({action:"Exposure",ver1:I}),w({action:"From",ver1:I,path:m.get("_cookie_tdw_userPath")+"-"+m.get("_cookie_tdw_userPathCode")})},t.prototype._initInfo=function(){var e=this;window.BJ_REPORT.init({id:103}),e.courseId=+f.getUrlParam("course_id"),e.termId=+f.getUrlParam("term_id"),e.initRoomConfig(),this.updateNotice(),this.updateCoupon(!0),h.isGroupMember({groupcode:this.courseInfo.groupId}).done(function(t){e.getIsGroupMemberSucc(t)}),this.getMemberList()},t.prototype.enterRoom=function(){var e=this;e.model.isRtmp?e.enterRoomSucc():(e.model.$emit("enterRoom.before"),h.getFlashInfo({course_id:e.termId}).done(function(t){e.model.$emit("enterRoom.succ",t),e.enterRoomSucc(t),e.model.$emit("saveTcpList",t)}).fail(function(t){t.retcode<=100&&e.model.$emit("enterRoom.fail",t),e.enterRoomFail(t)})),e._readyLoginInfo&&e._readyCourseInfo&&!e._isInitUserInfo&&(e._initInfo(),e._isInitUserInfo=!0)},t.prototype.enterRoomSucc=function(e){this.isEnterRoomSucc=!0,this.model.$emit("chat.enterRoom",!0,e),y(2924165)},t.prototype.enterRoomFail=function(e){this.model.$emit("chat.enterRoom",!1,e)},t.prototype.startLongPoll=function(){var e=this;window._T[4]=(new Date).getTime(),window._T[5]=0,this.model.$emit("liveClass.start");var t=0,i=setInterval(function(){e.getMemberList(),++t,t>4&&clearInterval(i)},2e3);this._longpoll=v().init(this.termId,this.model),this._longpoll.start(),setTimeout(function(){e.enterRoom()},20)},t.prototype.stopLongPoll=function(){this._longpoll&&this._longpoll.stop()},t.prototype.getMemberList=function(e){e=e?e:{};var t=this,i=void 0===e.operation?1:e.operation,o=p("#ke-memberlist .teacher-item").length,n=e.current||t.__current_num;2===i?n--:3===i&&n++;var r=1===n?t.membersPerPage:t.membersPerPage-o;return h.getMemberList({cmd0x6_get_page_member_list:JSON.stringify({uint32_term_id:t.termId,uint32_page_operation:void 0===e.operation?1:e.operation,uint32_cur_page_no:e.current||t.__current_num,uint64_contain_uid:t.userInfo.uin,uint32_need_special:1,uint32_page_count:r})}).done(function(e){t.getMemberListSucc(e.list)}).fail(function(){window.BJ_REPORT.info({msg:"getMemberListFail-retcode: requestFail",ext:{msid:2138885}})})},t.prototype.getMemberListSucc=function(e){var t,i,o=e.teacherList||[],n=e.userList||[],r=this.userInfo.uin;for(u=e,t=0,i=o.length;i>t;t++)r==o[t].uid&&(this.userInfo.roleId=o[t].role_id,this.userInfo.uidType=o[t].uid_type);if(!this.userInfo.roleId)for(t=0,i=n.length;i>t;t++)r==n[t].uid&&(this.userInfo.roleId=n[t].role_id,this.userInfo.uidType=n[t].uid_type);this.keMemberlist.setData(e),this.model.setMemberNum(e.total),this.teacherList=e.teacherList,this.__current_num=e.curPage,this.keToolbar.setAllowFlower(this.isAllowFlower())},t.prototype.getIsGroupMemberSucc=function(e){var t=this.courseInfo;this.keToolbar.setDefaultGroupHref(e.url),this.keToolbar.setIsAllreadyinGroup(e.isMember),this.keMemberlist.setGroupList([{id:t.groupId,name:t.groupName,url:e.url}])},t.prototype.getRemark=function(){var e=this,t=JSON.stringify(u.teacherList.concat(u.userList));h.getRemark({term_id:e.termId,user_info:t}).done(function(t){var i=e.userInfo.uin,o=t.items;if(o)for(var n=0,r=o.length;r>n;n++)o[n].uin==i&&(e.userInfo.remark=o[n].mark)})},t.prototype.initRoomConfig=function(){var e=this;h.getRoomConfig({term_id:e.termId}).done(function(t){0!==+t.retcode&&(e.keEditor.setWarnType(3),window.BJ_REPORT.info({msg:"getRoomConfigFail-retcode: "+t.retcode,ext:{msid:2057635}})),e.getRoomConfigSucc(t)}).fail(function(){e.keEditor.setWarnType(3),window.BJ_REPORT.info({msg:"getRoomConfigFail-retcode: requestFail",ext:{msid:2057635}})})},t.prototype.updateNotice=function(e){console.log("更新公告",e);var t=this,i=!!e;e&&1!==e.subcmd?2===e.subcmd&&(0===e.coupon.remainTime?t.keNotice.setCouponData(null,!0):t.updateCoupon(i)):(h.getNotice({uint32_course_abs_id:this.termId}).done(function(e){t.getNoticeSucc(e,i)}),t.updateRecommend(i))},t.prototype.updateRecommend=function(e){var t=this;h.getRecommend({tid:this.termId}).done(function(i){i.currentCourseId=t.courseId,t.keNotice.setRecommendData(i,e)})},t.prototype.updateCoupon=function(e){var t=this;h.get_coupon_status_marketing({tid:t.termId}).done(function(i){return void 0===i.price?void t.keNotice.reportCouponExopTime():(i.tid=t.termId,void t.keNotice.setCouponData(i,e))})},t.prototype.htmldecode=function(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText||t.textContent},t.prototype.createMsg=function(e){if(!e)return"";var t=this,i={msg_rich_text:{rpt_msg_elems:[]}},o=i.msg_rich_text.rpt_msg_elems,n=0,r="";return e.replace(/<\/div>|<\/span>/g,"").replace(/<div[^>]+>|<span[^>]+>/g,"").replace(/<div>|<span>|<br>/g,"\r").replace(/(<img [^>]*src=['"]([^'"]+)[^>]*>|([^<>]*))/gi,function(e,i,s){if(s){var a=s.match(/\/\/7\.url\.cn\/edu\/webcourse\/modules\/img\/emoji\/(\d+?)\@2x.gif/);if(a)return o.push({msg_face:{uint32_index:b.getClientFaceCode(~~a[1]),bytes_buf:""},uint32_elem_type:2}),"";var c=s.match(/\/\/p\.qpic\.cn\/edu_msgpic\/0\/([A-Z0-9]+)\/0/);if(c)return o.push({msg_not_online_image:{uint32_img_type:M.get(c[1]),bytes_pic_md5:c[1]},uint32_elem_type:3}),n++,""}return e&&(o.push({msg_text:{bytes_attr_6_buf:"",bytes_buf:"",bytes_str:t.htmldecode(e)},uint32_elem_type:1}),r=e),e}),r.length>t.MAXMSGCONFIG.strLength?{warn:1}:n>t.MAXMSGCONFIG.img?{warn:2}:(o.push({msg_add_info:{str_nick_name:t.userInfo.decodeNick},uint32_elem_type:18}),JSON.stringify(i))},t.prototype.checkMsg=function(e){var t=this;switch(e.warn){case 1:t.keChatlist.setWarnText("发送消息内容超长，请分条发送。");break;case 2:t.keChatlist.setWarnText("每条信息最多包含3张图片，多张图片请分条发送。");break;default:return!0}return!1},t.prototype.submitMsg=function(e){var t=this,i=this.createMsg(e),o=C.get(),n=this.userInfo;e=e.replace(/&amp;/g,"&").replace(/([Tt]encent:\/\/[A-Za-z0-9-_]+\/\??[A-Za-z0-9-_%&@\?\/.=]+)([\s]*[^\w]*)/g,'<a href="$1" target="_blank">$1</a>$2'),i&&this.checkMsg(i)&&(a.setChatMsg([{_seq:o,role:-1,type:1,content:e.replace(/<(img|IMG) src=\"\/\/7\.url\.cn\/edu\/webcourse\/modules\/img\/noHash\/error-img\.png\" (\/|)>/g,""),name:this.userInfo.nick}]),h.sendMessage({term_id:this.termId,msg_body:i,uint32_role:n.roleId||6,uint32_msg_seq:C.get(),uint32_label:0,str_remark:n.remark,uint32_uid_type:n.uidType||0}).done(function(){t.sendMessageSucc(e)}).fail(function(){t.sendMessageFail(o)}))},t.prototype.sendMessageSucc=function(){this.keEditor.clear()},t.prototype.sendMessageFail=function(e){for(var t=this.keChatlist.chatList,i=0,o=t.length;o>i;i++)t[i]._seq===e&&t[i].$set("warn",!0);this.keChatlist.setChatList({role:0,content:"发送信息失败",type:3})},t.prototype.sendFlower=function(){var e=this,t=this.courseInfo,i=this.termInfo;if(this.teacherList&&this.teacherList.length){var o=this.teacherList[0];o.nickname=""===o.nickname?o.uid:o.nickname,a.setChatMsg([{role:0,type:2,name:this.userInfo.nick,to:o.nickname}]),h.sendFlower({uint32_group_id:t.groupId,uint32_room_id:~~i.roomId,uint64_dest_uin:o.uid,uint32_course_abs_id:this.termId,str_dest_nick:o.nickname,str_from_nick:this.userInfo.decodeNick,str_from_mark:this.userInfo.remark}).done(function(t){e.sendFlowerSucc(t)}).fail(function(){e.sendFlowerFail()})}},t.prototype.sendFlowerSucc=function(){},t.prototype.sendFlowerFail=function(){this.keChatlist.setChatList([{role:0,content:"献花失败",type:3}])},t.prototype.setChatMsg=function(e){var t=this;e.length&&e.forEach(function(e){var i=t.keMemberlist.getRole(e.uin);e.role=i?i.role_id:e.role||0,e.sex=i?i.sex:0}),this.keChatlist.setChatList(e)},t.prototype._filter=function(e){var t=this;return t.keEditor.insert(e.html().replace(/<(\S+?)\s.+?>/g,function(e,t){return"img"!==t&&"IMG"!==t?"":(e=e.replace(/^<IMG/,"<img"),e.match(/<img.+?src\=(["'])\/\/7.url.cn\/edu\/webcourse\/img\/emoji\/([\d\D]+?).png\1.*?>/)?p("<div>").html(p(e).addClass("face-zoom")).html():e.match(/<img.+?src\=(["'])\/\/p\.qpic\.cn\/edu_msgpic\/0\/([A-Z0-9]+)\/0\1.*?>/)?p("<div>").html(p(e)).html():void 0)})),this},t.prototype._bindEvent=function(){var e=this,t=this.model;t.$on("face.face",function(t){e.keEditor.insert('<img class="face-zoom" src="'+t.face+'" >')}),t.$on("editor.isAllow",function(t){e.setToolbarIsAllow(t)}).$on("editor.paste",function(t){e._filter(t)}),t.$on("chattoolbar.onlyTeacher",function(t){e.keChatlist.setOnlyTeacher(t)}),t.$on("editor.submit",function(t){e.submitMsg(t)}),t.$on("chattoolbar.flower",function(){e.sendFlower()}),window._imgerror=function(e,t){var i=p('<img src="//7.url.cn/edu/webcourse/modules/img/noHash/error-img.png" />');i.click(function(){p(e).unload().load(function(){p(this).show()}).attr("src",function(){return t+(~t.indexOf("?")?"&t=":"?t=")+ +new Date}),p(this).remove()}),p(e).hide().after(i)},t.$on("imguploader.new-image",function(t){M.add(t.fid,t.ext);var i="//p.qpic.cn/edu_msgpic/0/"+t.fid+"/0";e.keEditor.insert('<img style="display:block;" src="'+i+'" onerror="_imgerror(this, \''+i+"')\" >")}),t.$on("memberlist.pre-page",function(){e.getMemberList({operation:2,current:e.__current_num})}),t.$on("memberlist.next-page",function(){e.getMemberList({operation:3,current:e.__current_num})}),t.$on("memberlist.searchUser",function(t){e.searchUser(t)}),t.$on("chat.refresh",function(){e.initRoomConfig()})},t.prototype.getNoticeSucc=function(e,t){var i=this,o=e.msg;o.content&&(~o.content.indexOf(o.info)?h.getIdKey({group:o.info}).done(function(e){o.content=o.content.replace(o.info,'<a href="'+e.url+'" target="_blank">'+o.info+"</a>"),i.keNotice.setNoticeData(o,t)}):i.keNotice.setNoticeData(o,t))},t.prototype.getSpeechLimitSucc=function(e){this.keEditor.setLimitSec(e.limit)},t.prototype.getRoomConfigSucc=function(e){var t=this;this.forbidPicture=e.forbidPicture,this.forbidFlower=e.forbidFlower,T.init(e.forbidSpeechList),T.setIsAllForbit(e.allForbidSpeech),e.allForbidSpeech&&(this.setToolbarIsAllow(!1),this.keEditor.setWarnType(2)),!T.isAllForbit()&&T.isForbit(this.userInfo.uin)&&(this.keEditor.setWarnType(1),this.setToolbarIsAllow(!1)),h.getSpeechLimit({term_id:this.termId}).done(function(e){0!==+e.retcode&&(t.keEditor.setWarnType(3),window.BJ_REPORT.info({msg:"getSpeechLimit-retcode: "+e.retcode,ext:{msid:2057636}})),t.getSpeechLimitSucc(e)}).fail(function(){t.keEditor.setWarnType(3),window.BJ_REPORT.info({msg:"getSpeechLimit-retcode: requestFail",ext:{msid:2057636}})})},t.prototype.isAllowPicture=function(){return this.keEditor.isAllow&&!this.forbidPicture},t.prototype.isAllowFlower=function(){return this.keEditor.isAllow&&!this.forbidFlower&&!T.isForbit(this.userInfo.uin)&&this.teacherList&&this.teacherList.length},t.prototype.isMemberForbidSpeech=function(e){for(var t=this.userInfo.uin,i=0,o=e.length;o>i;i++)if(e[i].uin==t)return!0;return!1},t.prototype.searchUser=function(e){var t=this;h.searchUser({str_key:e,uint32_course_id:t.termId}).done(function(){})},t.prototype.handleSysMsg=function(e){for(var t,i=this,o=0,n=e.length;n>o;o++)switch(t=e[o],t.cmd){case"updateNotice":i.updateNotice(t);break;case"roomConfigChange":i.roomConfigChangeHandler(t);break;case"kick":i.kickHandler(t);break;case"speakMode":i.speakModeHandler(t);break;case"attendClass":i.attendClassHandler(t);break;case"attendRoom":i.attendRoomHandler(t);break;case"userChange":i.userChangeHandler(t);break;case"updateRemark":i.updateRemarkHandler(t);break;case"flashStatus":i.flashStatusHandler(t)}},t.prototype.roomConfigChangeHandler=function(e){var t={1:"speechChangeHandler",2:"uploadImgChangeHandler",3:"flowerChangeHandler",4:"speechRateChangeHandler",5:"speechLimitChangeHandler"};t[e.changeType]&&this[t[e.changeType]]&&this[t[e.changeType]](e)},t.prototype.speechChangeHandler=function(e){var t=e.speechChange,i=t.flag,o=t.type,n=this.userInfo.uin,r=-1;i?o?(r=2,this.setToolbarIsAllow(!1),T.setIsAllForbit(!0)):t.uin==n&&(T.add(t.uin),r=1,this.setToolbarIsAllow(!1)):(o&&(this.setToolbarIsAllow(!0),T.setIsAllForbit(!1)),o||t.uin!=n?r=T.isForbit(n)?1:-1:T.del(t.uin)),T.isAllForbit()?r=2:-1===r&&this.setToolbarIsAllow(!0),this.keEditor.setWarnType(r)},t.prototype.setToolbarIsAllow=function(e){this.keToolbar.setIsAllow(e),e&&(this.keToolbar.setAllowImage(this.isAllowPicture()),this.keToolbar.setAllowFlower(this.isAllowFlower()))},t.prototype.uploadImgChangeHandler=function(e){{var t=e.uploadImgChange,i=t.flag;t.type}this.forbidPicture=i,this.keToolbar.setAllowImage(this.isAllowPicture())},t.prototype.flowerChangeHandler=function(e){{var t=e.flowerChange,i=t.flag;t.type}this.forbidFlower=i,this.keToolbar.setAllowFlower(!i&&this.isAllowFlower())},t.prototype.speechRateChangeHandler=function(e){{var t=e.speechRateChange;t.flag,t.type}},t.prototype.kickHandler=function(e){this.keChatlist.setChatList([{role:0,content:e.msg+"，即将关闭课堂",type:3}]),this.model.$set("isKicked",!0),setTimeout(function(){window.location.href="//ke.qq.com/user/index/index.html"},5e3)},t.prototype.speakModeHandler=function(){},t.prototype.attendClassHandler=function(e){e.uin&&this.model.$emit("chat.attendClass",e.subcmd)},t.prototype.attendRoomHandler=function(e){e.uin&&this.model.$emit("chat.attendRoom")},t.prototype.userChangeHandler=function(){var e=this;clearTimeout(this._getMemberListTimer),this._getMemberListTimer=setTimeout(function(){e.getMemberList()},2e3)},t.prototype.speechLimitChangeHandler=function(e){this.keEditor.setLimitSec(e.speechLimit)},t.prototype.updateRemarkHandler=function(){this.getRemark()},t.prototype.flashStatusHandler=function(e){g.get("onlineFlash").trigger("changeStatus",e.status)},t.prototype.isTeacher=function(e){return this.keMemberlist.isTeacher(e)},t}(d["default"]);a=new L,i.exports={data:{isShow:!1,isKicked:!1,isRtmp:!1,tabIndex:0,memberNum:0,userInfo:{}},filters:{tabActive:function(e,t){return e===~~t},lineClass:function(e){return 1===e},sendParam:function(e){var t=Array.prototype.slice.call(arguments,1);return function(){e.apply(this,t)}},showChat:function(e){return 0===e},isHideChat:function(e){return 0!==e},showMember:function(e){return 1===e}},directives:{},methods:{setLiveType:function(e){this.$set("isRtmp",e)},selectTab:function(e){var t=~~e;this.$set("tabIndex",t),this.$emit("chat.selectTab",t)},setMemberNum:function(e){this.$set("memberNum",e)},setHeight:function(e){var t=p("#titleDiv").height(),i=p(a.keNotice.$el).height(),o=p(a.keToolbar.$el).height(),n=p(a.keEditor.$el).height(),r=50;a.keChatlist.setChatListStyle({height:e-t-i-o-n+"px"}),a.keMemberlist.setMemberListStyle({height:e-t-r+"px"}),this.setMembersPerPage(e-t-r)},setMembersPerPage:function(e){var t=20,i=28,o=parseInt((e+10-2*t)/i)-1;a.membersPerPage=o},show:function(){this.$set("isShow",!0),a.startLongPoll()},hide:function(){this.$set("isShow",!1),a.stopLongPoll()},getWidth:function(){return p(this.$el).width()},setCourseInfo:function(e){a.courseInfo=e,a._readyCourseInfo=!0,a._readyLoginInfo&&!a._isInitUserInfo&&(a._initInfo(),a._isInitUserInfo=!0)},setTermInfo:function(e){a.termInfo=e},setTaskInfo:function(e){a.taskInfo=e},isInRoom:function(){return a.isEnterRoomSucc},init:function(){a.init(this)}},ready:function(){function e(e){var t=document.createElement("p");return t.innerHTML=e,p(t).text()}g.get("login").listen("statusChanged",function(t){a.userInfo=t,t.nick=""===t.nick?t.uin:t.nick,t.decodeNick=e(t.nick),!a._isInitUserInfo&&a._readyCourseInfo&&(a._initInfo(),a._isInitUserInfo=!0),a._readyLoginInfo=!0})}}});
define("pages/index/notice/main",function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=t("modules/lib/db"),u=n(s),r=t("jquery"),l=n(r),p=t("lego_modules/imweb-base-qjs/0.1.1/src/controller"),h=n(p),m=t("lego_modules/local.data/0.0.1/local.data"),d=function(t){function e(){i(this,e);var o=c(this,t.call(this));return o.components={keCouponDialog:"#ke-couponDialog",keCouponDialogTip:"#ke-couponDialogTip"},o}return a(e,t),e.prototype.receiveCoupon=function(t){t&&this.model.$emit("notice.coupon_claim_expo",t.couponId),this.keCouponDialog.show()},e.prototype.init=function(t){var e=this;this._init(t),this.keCouponDialog.$on("couponDialog.getCoupon",function(t){e.keCouponDialog.hide(),u["default"].get_coupon_marketing({tid:t.tid,cid:t.cid,price:t.price}).done(function(){e.keCouponDialogTip.showSuccess("","领取成功","","确认"),e.model.$emit("notice.coupon_claim_succ",t.couponId),e.model.selectTab(e.model.checkTabIndex(0)),e.model.setCouponData(null)}).fail(function(o){var n="";switch(o.retcode){case 113141:n="领取优惠券过多，最多可领取500张可用的优惠券 ";break;case 113131:n="优惠券不存在 ";break;case 113133:n="优惠券被删除";break;case 113134:case 113135:case 113116:n="课程优惠券已领取完毕或过期，敬请关注下轮发放"}e.model.$emit("notice.coupon_claim_fail",t.couponId),""!==n&&(e.model.setCouponData(null),e.model.selectTab(e.model.checkTabIndex(0))),e.keCouponDialogTip.showAlert("","领取失败",n,"确认")})})},e}(h["default"]),f=new d,D=0,g=null,b=3;o.exports={data:{neverShow:!1,isShow:!1,isHideAll:!0,tabIndex:0,noticeData:null,recommendData:null,recommendDes:"",recommendName:"",couponData:null,couponNum:0,couponTitle:"优惠券",timer:null},filters:{tabActive:function(t,e){return t===~~e},sendParam:function(t){var e=Array.prototype.slice.call(arguments,1);return function(){t.apply(this,e)}},isShowNotice:function(){return this.noticeData&&""!==this.noticeData.content?!0:!1},getNotice:function(){return'<span class="notice-title">[公告]</span>'+this.noticeData.content},getRecommendUrl:function(){return"https://ke.qq.com/course/"+this.recommendData.cid+"?from=96&livecid="+this.recommendData.currentCourseId},getRecommendCoverUrl:function(){return this.recommendData.coverUrl+"90"},getTabsNum:function(){var t=0;return this.noticeData&&""!==this.noticeData.content&&t++,this.recommendData&&t++,this.couponData&&t++,["","tab-one","tab-two","tab-three"][t]},isOrangeCoupon:function(){return this.couponData?"orange"===this.couponData.color:!1},getCouponInfo:function(){return"领取"+this.couponTitle+"即可享受课程优惠："},notNull:function(t){return!!t}},directives:{},methods:{close:function(){this.$set("neverShow",!0),this.$set("isShow",!1)},hide:function(){this.$set("isShow",!1)},show:function(){this.neverShow||this.$set("isShow",!0)},selectTab:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,o=Number(t);this.stop(),this.$set("tabIndex",o),this.play(e)},play:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,o=setTimeout(function(){var e=t.tabIndex;e++,e=e>=b?e-b:e,e=t.checkTabIndex(e),t.selectTab(e)},e);this.$set("timer",o)},checkTabIndex:function(t,e){var o={1:0,2:1,0:2};return e=e||o[t],0===t&&this.noticeData?t:1===t&&this.recommendData?t:2===t&&this.couponData?t:t===e?(this.$set("isHideAll",!0),0):(t++,t>=b&&(t=0),this.checkTabIndex(t,e))},delayTenMinutesPlay:function(t){this.selectTab(t,6e5)},stop:function(){clearTimeout(this.timer)},setNoticeData:function(t,e){var o=this.noticeData;if(o&&t){if(o.content==t.content)return;e=!0}else this.couponData||this.selectTab(0);this.$set("noticeData",t),this.$set("isHideAll",!1),this.show(),e&&this.delayTenMinutesPlay(0)},setRecommendData:function(t,e){var o=this.recommendData;if(o&&t){if(o.cid==t.cid&&o.des==t.des)return;e=!0}else this.couponData||this.selectTab(1);t.des&&(this.$emit("notice.recom_course_expo",{recommendcid:t.cid}),this.$set("recommendData",t),this.$set("recommendName",t.name),this.$set("recommendDes",t.des),this.$set("isHideAll",!1),this.show(),e&&this.delayTenMinutesPlay(1))},clickRecommend:function(){this.$emit("notice.recom_course_click",{recommendcid:this.recommendData.cid})},setCouponData:function(t){this.$set("couponData",t),t?(this.$emit("notice.coupon_expo",t.couponId),this.$set("couponNum",t.price/100),this.$set("couponTitle",t.couponTitle),this.$set("isHideAll",!1),f.keCouponDialog.setData(t),this.reportCouponExopTime(),this.delayTenMinutesPlay(2),this.startCountCouponExpoTime()):this.stopCountCouponExpoTime()},reportCouponExopTime:function(){var t=m.get("couponExpoTime");t?(t=JSON.parse(t),t.time&&this.$emit("notice.coupon_expo_time",t)):t={},D=0,t.time=0,m.set("couponExpoTime",JSON.stringify(t))},startCountCouponExpoTime:function(){var t=this;g=setInterval(function(){D+=1,t.couponData&&m.set("couponExpoTime",JSON.stringify({couponId:t.couponData.couponId,time:D}))},1e3)},stopCountCouponExpoTime:function(){null!==g&&(clearInterval(g),g=null)},receiveCoupon:function(){this.couponData&&this.$emit("notice.coupon_click",this.couponData.couponId),f.receiveCoupon(this.couponData)}},ready:function(){var t=this,e=this.$$.container;f.init(this),this.$watch("isShow",function(e){t.$emit("notice.toggle",e)}),l["default"](e).on("click","a",function(e){e.preventDefault();var o=l["default"](this).attr("href");/^https?:\/\//.test(o)&&(window.open(l["default"](this).attr("href")),t.$emit("notice.click"))})}}});
define("components/coupondialog/main",function(o,t,n){"use strict";function e(o){return o&&o.__esModule?o:{"default":o}}var i=o("modules/lib/util"),u=e(i);n.exports={data:{isShow:!1,isShowCloseBtn:!0,couponData:null,couponNum:0,couponTitle:"",couponFullName:"",updateCouponData:null},filters:{getCouponClass:function(){if(!this.couponData)return"";var o="db-coupon",t=["0","num-one","num-two","num-three","num-four"];"orange"===this.couponData.color&&(o+=" coupon-orange");var n=String(this.couponNum).length;return o+=" "+t[n]},getCouponUseConditions:function(){var o=this.couponData;if(!o)return"";var t="",n=o.price/100;return 1===o.kind?t+='使用条件：购买<a href="//'+o.domain+'" target="_blank">'+o.aname+"</a>机构任意课程,满"+Math.floor(o.limit.min_cost/100)+"元减"+n+"元":2===o.kind&&(t+='使用条件：购买<a href="//ke.qq.com/course/'+o.cid+'" target="_blank">'+o.cname+"</a>,立减"+n+"元"),t},getCouponUseTime:function(){if(!this.couponData)return"";var o="",t=u["default"].formatDate("Y-M-D",new Date(this.couponData.beginTime)),n=u["default"].formatDate("Y-M-D",new Date(this.couponData.endTime));return o="使用期限："+t+"至"+n}},directives:{},methods:{closeWindow:function(){this.hide()},hide:function(){this.$set("isShow",!1),this.setData(this.updateCouponData)},show:function(){this.$set("isShow",!0)},setData:function(o){this.$set("updateCouponData",o),this.isShow||(this.$set("couponNum",o.price/100),this.$set("couponTitle",o.couponTitle),this.$set("couponFullName",this.couponNum+"元"+o.prefix+o.couponTitle),this.$set("couponData",o))},dialogSubmit:function(){this.$emit("couponDialog.getCoupon",this.couponData)}},ready:function(){}}});
define("components/blackdialog/main",function(t,s,i){"use strict";i.exports={data:{isShow:!1,isShowCloseBtn:!0,head:"",title:"",content:"",cancelText:"",isShowCancelBtn:!1,isAlert:!1,isSuccess:!0},filters:{},directives:{},methods:{closeWindow:function(){this.hide()},show:function(){this.$set("isShow",!0)},hide:function(){this.$set("isShow",!1)},dialogSubmit:function(){},dialogCancel:function(){this.hide()},showSuccess:function(t,s,i,e,n){this.$set("isSuccess",!0),this.$set("isAlert",!1),this.setMsg(t,s,i,e,n),this.show()},showAlert:function(t,s,i,e,n){this.$set("isSuccess",!1),this.$set("isAlert",!0),this.setMsg(t,s,i,e,n),this.show()},setMsg:function(t,s,i,e,n){this.$set({head:t,title:s,content:i,cancelText:e}),e&&""!==e&&this.showCancelBtn(),this._dialogCancel=n},showCloseBtn:function(){this.$set("isShowCloseBtn",!0)},hideCloseBtn:function(){this.$set("isShowCloseBtn",!1)},showCancelBtn:function(){this.$set("isShowCancelBtn",!0)},hideCancelBtn:function(){this.$set("isShowCancelBtn",!1)}},ready:function(){}}});
define("modules/lib/bower_components/nanoScroller/nanoScroller",function(t){var e,i,s,o,n,l,r,h,c,a,p,d,u,g,v,f,S,m,T,w,b,y,x,$,C,H,O,A,E,Y,D,M,N=t("jquery");x={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",enabledClass:"has-scrollbar",flashedClass:"flashed",activeClass:"active",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},m="scrollbar",S="scroll",c="mousedown",a="mouseenter",p="mousemove",u="mousewheel",d="mouseup",f="resize",n="drag",l="enter",w="up",v="panedown",s="DOMMouseScroll",o="down",b="wheel",r="keydown",h="keyup",T="touchmove",e="Microsoft Internet Explorer"===window.navigator.appName&&/msie 7./i.test(window.navigator.appVersion)&&window.ActiveXObject,i=null,O=window.requestAnimationFrame,y=window.cancelAnimationFrame,E=document.createElement("div").style,D=function(){var t,e,i,s,o,n;for(s=["t","webkitT","MozT","msT","OT"],t=o=0,n=s.length;n>o;t=++o)if(i=s[t],e=s[t]+"ransform",e in E)return s[t].substr(0,s[t].length-1);return!1}(),Y=function(t){return D===!1?!1:""===D?t:D+t.charAt(0).toUpperCase()+t.substr(1)},A=Y("transform"),C=A!==!1,$=function(){var t,e,i;return t=document.createElement("div"),e=t.style,e.position="absolute",e.width="100px",e.height="100px",e.overflow=S,e.top="-9999px",document.body.appendChild(t),i=t.offsetWidth-t.clientWidth,document.body.removeChild(t),i},H=function(){var t,e,i;return e=window.navigator.userAgent,(t=/(?=.+Mac OS X)(?=.+Firefox)/.test(e))?(i=/Firefox\/\d{2}\./.exec(e),i&&(i=i[0].replace(/\D+/g,"")),t&&+i>23):!1},g=function(){function t(t,e){this.el=t,this.options=e,i||(i=$()),this.$el=N(this.el),this.doc=N(this.options.documentContext||document),this.win=N(this.options.windowContext||window),this.body=this.doc.find("body"),this.$content=this.$el.children("."+this.options.contentClass),this.$content.attr("tabindex",this.options.tabIndex||0),this.content=this.$content[0],this.previousPosition=0,this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return t.prototype.preventScrolling=function(t,e){if(this.isActive)if(t.type===s)(e===o&&t.originalEvent.detail>0||e===w&&t.originalEvent.detail<0)&&t.preventDefault();else if(t.type===u){if(!t.originalEvent||!t.originalEvent.wheelDelta)return;(e===o&&t.originalEvent.wheelDelta<0||e===w&&t.originalEvent.wheelDelta>0)&&t.preventDefault()}},t.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},t.prototype.updateScrollValues=function(){var t,e;t=this.content,this.maxScrollTop=t.scrollHeight-t.clientHeight,this.prevScrollTop=this.contentScrollTop||0,this.contentScrollTop=t.scrollTop,e=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same",this.previousPosition=this.contentScrollTop,"same"!==e&&this.$el.trigger("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:e}),this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=0===this.maxScrollTop?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},t.prototype.setOnScrollStyles=function(){var t;C?(t={},t[A]="translate(0, "+this.sliderTop+"px)"):t={top:this.sliderTop},O?(y&&this.scrollRAF&&y(this.scrollRAF),this.scrollRAF=O(function(e){return function(){return e.scrollRAF=null,e.slider.css(t)}}(this))):this.slider.css(t)},t.prototype.createEvents=function(){this.events={down:function(t){return function(e){return t.isBeingDragged=!0,t.offsetY=e.pageY-t.slider.offset().top,t.slider.is(e.target)||(t.offsetY=0),t.pane.addClass(t.options.activeClass),t.doc.bind(p,t.events[n]).bind(d,t.events[w]),t.body.bind(a,t.events[l]),!1}}(this),drag:function(t){return function(e){return t.sliderY=e.pageY-t.$el.offset().top-t.paneTop-(t.offsetY||.5*t.sliderHeight),t.scroll(),t.contentScrollTop>=t.maxScrollTop&&t.prevScrollTop!==t.maxScrollTop?t.$el.trigger("scrollend"):0===t.contentScrollTop&&0!==t.prevScrollTop&&t.$el.trigger("scrolltop"),!1}}(this),up:function(t){return function(){return t.isBeingDragged=!1,t.pane.removeClass(t.options.activeClass),t.doc.unbind(p,t.events[n]).unbind(d,t.events[w]),t.body.unbind(a,t.events[l]),!1}}(this),resize:function(t){return function(){t.reset()}}(this),panedown:function(t){return function(e){return t.sliderY=(e.offsetY||e.originalEvent.layerY)-.5*t.sliderHeight,t.scroll(),t.events.down(e),!1}}(this),scroll:function(t){return function(e){t.updateScrollValues(),t.isBeingDragged||(t.iOSNativeScrolling||(t.sliderY=t.sliderTop,t.setOnScrollStyles()),null!=e&&(t.contentScrollTop>=t.maxScrollTop?(t.options.preventPageScrolling&&t.preventScrolling(e,o),t.prevScrollTop!==t.maxScrollTop&&t.$el.trigger("scrollend")):0===t.contentScrollTop&&(t.options.preventPageScrolling&&t.preventScrolling(e,w),0!==t.prevScrollTop&&t.$el.trigger("scrolltop"))))}}(this),wheel:function(t){return function(e){var i;if(null!=e)return i=e.delta||e.wheelDelta||e.originalEvent&&e.originalEvent.wheelDelta||-e.detail||e.originalEvent&&-e.originalEvent.detail,i&&(t.sliderY+=-i/3),t.scroll(),!1}}(this),enter:function(t){return function(e){var i;if(t.isBeingDragged)return 1!==(e.buttons||e.which)?(i=t.events)[w].apply(i,arguments):void 0}}(this)}},t.prototype.addEvents=function(){var t;this.removeEvents(),t=this.events,M=t[f],this.options.disableResize||this.win.bind(f,M),this.iOSNativeScrolling||(this.slider.bind(c,t[o]),this.pane.bind(c,t[v]).bind(""+u+" "+s,t[b])),this.$content.bind(""+S+" "+u+" "+s+" "+T,t[S])},t.prototype.removeEvents=function(){var t;t=this.events,this.win.unbind(f,M),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(""+S+" "+u+" "+s+" "+T,t[S])},t.prototype.generate=function(){var t,e,s,o,n,l,r;return o=this.options,l=o.paneClass,r=o.sliderClass,t=o.contentClass,(n=this.$el.children("."+l)).length||n.children("."+r).length||this.$el.append('<div class="'+l+'"><div class="'+r+'" /></div>'),this.pane=this.$el.children("."+l),this.slider=this.pane.find("."+r),0===i&&H()?(s=window.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/[^0-9.]+/g,""),e={right:-14,paddingRight:+s+14}):i&&(e={right:-i},this.$el.addClass(o.enabledClass)),null!=e&&this.$content.css(e),this},t.prototype.restore=function(){this.stopped=!1,this.iOSNativeScrolling||this.pane.show(),this.addEvents()},t.prototype.reset=function(){var t,e,s,o,n,l,r,h,c,a,p,d;return this.iOSNativeScrolling?void(this.contentHeight=this.content.scrollHeight):(this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),t=this.content,o=t.style,n=o.overflowY,e=t.scrollHeight+i,a=parseInt(this.$el.css("max-height"),10),a>0&&(this.$el.height(""),this.$el.height(t.scrollHeight>a?a:t.scrollHeight)),r=this.pane.outerHeight(!1),c=parseInt(this.pane.css("top"),10),l=parseInt(this.pane.css("bottom"),10),h=r+c+l,d=Math.round(h/e*r),d<this.options.sliderMinHeight?d=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&d>this.options.sliderMaxHeight&&(d=this.options.sliderMaxHeight),n===S&&o.overflowX!==S&&(d+=i),this.maxSliderTop=h-d,this.contentHeight=e,this.paneHeight=r,this.paneOuterHeight=h,this.sliderHeight=d,this.paneTop=c,this.slider.height(d),this.events.scroll(),this.pane.show(),this.isActive=!0,t.scrollHeight===t.clientHeight||this.pane.outerHeight(!0)>=t.scrollHeight&&n!==S?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===t.scrollHeight&&n===S?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),s=this.$content.css("position"),("static"===s||"relative"===s)&&(p=parseInt(this.$content.css("right"),10),p&&this.$content.css({right:"",marginRight:p})),this)},t.prototype.scroll=function(){return this.isActive?(this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop(this.maxScrollTop*this.sliderY/this.maxSliderTop),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this):void 0},t.prototype.scrollBottom=function(t){return this.isActive?(this.$content.scrollTop(this.contentHeight-this.$content.height()-t).trigger(u),this.stop().restore(),this):void 0},t.prototype.scrollTop=function(t){return this.isActive?(this.$content.scrollTop(+t).trigger(u),this.stop().restore(),this):void 0},t.prototype.scrollTo=function(t){return this.isActive?(this.scrollTop(this.$el.find(t).get(0).offsetTop),this):void 0},t.prototype.stop=function(){return y&&this.scrollRAF&&(y(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},t.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),this.$content.removeAttr("tabindex"),this.$el.hasClass(this.options.enabledClass)&&(this.$el.removeClass(this.options.enabledClass),this.$content.css({right:""})),this},t.prototype.flash=function(){return!this.iOSNativeScrolling&&this.isActive?(this.reset(),this.pane.addClass(this.options.flashedClass),setTimeout(function(t){return function(){t.pane.removeClass(t.options.flashedClass)}}(this),this.options.flashDelay),this):void 0},t}(),N.fn.nanoScroller=function(t){return this.each(function(){var e,i;if((i=this.nanoscroller)||(e=N.extend({},x,t),this.nanoscroller=i=new g(this,e)),t&&"object"==typeof t){if(N.extend(i.options,t),null!=t.scrollBottom)return i.scrollBottom(t.scrollBottom);if(null!=t.scrollTop)return i.scrollTop(t.scrollTop);if(t.scrollTo)return i.scrollTo(t.scrollTo);if("bottom"===t.scroll)return i.scrollBottom(0);if("top"===t.scroll)return i.scrollTop(0);if(t.scroll&&t.scroll instanceof N)return i.scrollTo(t.scroll);if(t.stop)return i.stop();if(t.destroy)return i.destroy();if(t.flash)return i.flash()}return i.reset()})},N.fn.nanoScroller.Constructor=g});
define("pages/index/chatlist/viewer",function(i,t,e){"use strict";function s(i){return"string"==typeof i}function n(i){return"number"==typeof i&&!isNaN(i)}function a(i){return"undefined"==typeof i}function o(i,t){var e=[];return n(t)&&e.push(t),e.slice.apply(i,e)}function h(i,t){var e=o(arguments,2);return function(){return i.apply(t,e.concat(o(arguments)))}}function r(i){var t=[],e=i.rotate,s=i.scaleX,a=i.scaleY;return n(e)&&t.push("rotate("+e+"deg)"),n(s)&&n(a)&&t.push("scale("+s+","+a+")"),t.length?t.join(" "):"none"}function l(i){return i.offsetWidth}function d(i){return s(i)?i.replace(/^.*\//,"").replace(/[\?&#].*$/,""):""}function u(i,t){var e;return i.naturalWidth?t(i.naturalWidth,i.naturalHeight):(e=document.createElement("img"),e.onload=function(){t(this.width,this.height)},void(e.src=i.src))}function c(i){var t=i.length,e=0,s=0;return t&&(g.each(i,function(i,t){e+=t.pageX,s+=t.pageY}),e/=t,s/=t),{pageX:e,pageY:s}}function m(i){switch(i){case 2:return F;case 3:return z;case 4:return I}}function v(i,t){this.$element=g(i),this.options=g.extend({},v.DEFAULTS,g.isPlainObject(t)&&t),this.isImg=!1,this.isBuilt=!1,this.isShown=!1,this.isViewed=!1,this.isFulled=!1,this.isPlayed=!1,this.wheeling=!1,this.playing=!1,this.fading=!1,this.tooltiping=!1,this.transitioning=!1,this.action=!1,this.target=!1,this.timeout=!1,this.index=0,this.length=0,this.init()}var g=i("jquery"),f=g(window),w=g(document),p="viewer",b=document.createElement(p),x="viewer-fixed",y="viewer-open",$="viewer-show",C="viewer-hide",F="viewer-hide-xs-down",z="viewer-hide-sm-down",I="viewer-hide-md-down",k="viewer-fade",Y="viewer-in",X="viewer-move",P="viewer-active",T="viewer-invisible",V="viewer-transition",E="viewer-fullscreen",S="viewer-fullscreen-exit",D="viewer-close",L="img",_="mousedown touchstart pointerdown MSPointerDown",R="mousemove touchmove pointermove MSPointerMove",q="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",M="wheel mousewheel DOMMouseScroll",B="transitionend",W="load."+p,A="keydown."+p,j="click."+p,H="dblclick."+p,U="resize."+p,N="build."+p,O="built."+p,Z="show."+p,K="shown."+p,G="hide."+p,J="hidden."+p,Q="view."+p,it="viewed."+p,tt="undefined"!=typeof b.style.transition,et=Math.round,st=Math.sqrt,nt=Math.abs,at=Math.min,ot=Math.max,ht=Number;v.prototype={constructor:v,init:function(){var i=this.options,t=this.$element,e=t.is(L),s=this.getReduceImage(),n=s.length,a=g.proxy(this.ready,this);n&&(g.isFunction(i.build)&&t.one(N,i.build),this.trigger(N).isDefaultPrevented()||(tt||(i.transition=!1),this.isImg=e,this.length=n,this.count=0,this.$images=s,this.$body=g("body"),i.inline?(t.one(O,g.proxy(function(){this.view()},this)),s.each(function(){this.complete?a():g(this).one(W,a)})):t.on(H,this.proxy_start=g.proxy(this.start,this))))},webcourseUpdate:function(){var i;this.init(),this.update(),0===this.$images.length&&this.hide(),this.isViewed&&!this.isPlayed&&this.options.movable&&(i=this.index,0===i?g(".viewer-prev").addClass("viewer-disable"):g(".viewer-prev").removeClass("viewer-disable"),i===this.length-1?g(".viewer-next").addClass("viewer-disable"):g(".viewer-next").removeClass("viewer-disable"))},notEmoji:function(i){return!/.+\/emoji\/.+/.test(i)},getReduceImage:function(){var i=this,t=this.$element,e=t.is(L),s=e?t:t.find(L);return s=s.filter(function(){var t=g(this).attr("src"),e=g(this).attr("data-imageindex");return void 0!==e?!1:i.notEmoji(t)})},ready:function(){this.count++,this.count===this.length&&this.build()},build:function(){var i,t,e,s,n,a,o=this.options,h=this.$element;this.isBuilt||(this.$parent=i=h.parent(),this.$viewer=t=g(v.TEMPLATE),this.$canvas=t.find(".viewer-canvas"),this.$footer=t.find(".viewer-footer"),this.$title=e=t.find(".viewer-title"),this.$toolbar=s=t.find(".viewer-toolbar"),this.$navbar=n=t.find(".viewer-navbar"),this.$button=a=t.find(".viewer-button"),this.$tooltip=t.find(".viewer-tooltip"),this.$player=t.find(".viewer-player"),this.$list=t.find(".viewer-list"),e.addClass(o.title?m(o.title):C),s.addClass(o.toolbar?m(o.toolbar):C),s.find("li[class*=zoom]").toggleClass(T,!o.zoomable),s.find("li[class*=flip]").toggleClass(T,!o.scalable),o.rotatable||s.find("li[class*=rotate]").addClass(T).appendTo(s),n.addClass(o.navbar?m(o.navbar):C),a.toggleClass(C,!o.button),o.inline?(a.addClass(E),t.css("z-index",o.zIndexInline),"static"===i.css("position")&&i.css("position","relative")):(a.addClass(D),t.css("z-index",o.zIndex).addClass([x,k,C].join(" "))),h.after(t),o.inline&&(this.render(),this.bind(),this.isShown=!0),this.isBuilt=!0,g.isFunction(o.built)&&h.one(O,o.built),this.trigger(O))},unbuild:function(){this.isBuilt&&(this.isBuilt=!1,this.$viewer.remove())},bind:function(){var i=this.options,t=this.$element;g.isFunction(i.view)&&t.on(Q,i.view),g.isFunction(i.viewed)&&t.on(it,i.viewed),this.$viewer.on(j,this.proxy_click=g.proxy(this.click,this)).on(M,this.proxy_wheel=g.proxy(this.wheel,this)),this.$canvas.on(_,this.proxy_mousedown=g.proxy(this.mousedown,this)),w.on(R,this._mousemove=h(this.mousemove,this)).on(q,this._mouseup=h(this.mouseup,this)).on(A,this._keydown=h(this.keydown,this)),f.on(U,this._resize=h(this.resize,this))},unbind:function(){var i=this.options,t=this.$element;g.isFunction(i.view)&&t.off(Q,i.view),g.isFunction(i.viewed)&&t.off(it,i.viewed),this.$viewer.off(j,this.proxy_click).off(M,this.proxy_wheel),this.$canvas.off(_,this.proxy_mousedown),w.off(R,this._mousemove).off(q,this._mouseup).off(A,this._keydown),f.off(U,this._resize)},render:function(){this.initContainer(),this.initViewer(),this.initList(),this.renderViewer()},initContainer:function(){this.container={width:f.innerWidth(),height:f.innerHeight()}},initViewer:function(){var i,t=this.options,e=this.$parent;t.inline&&(this.parent=i={width:ot(e.width(),t.minWidth),height:ot(e.height(),t.minHeight)}),(this.isFulled||!i)&&(i=this.container),this.viewer=g.extend({},i)},renderViewer:function(){this.options.inline&&!this.isFulled&&this.$viewer.css(this.viewer)},initList:function(){var i=this.options,t=this.$element,e=this.$list,n=[];this.$images.each(function(t){var e=this.src,a=this.alt||d(e),o=i.url;e&&(s(o)?o=this.getAttribute(o):g.isFunction(o)&&(o=o.call(this,this)),n.push('<li><img src="'+e+'" onerror="_imgerror(this, \'//p.qpic.cn/edu_msgpic/0/292BB65D1B66B0388B632790F0096341/0\')" data-action="view" data-index="'+t+'" data-original-url="'+(o||e)+'" alt="'+a+'"></li>'))}),e.html(n.join("")).find(L).one(W,{filled:!0},g.proxy(this.loadImage,this)),this.$items=e.children(),i.transition&&t.one(it,function(){e.addClass(V)})},renderList:function(i){var t=i||this.index,e=this.$items.eq(t).width(),s=e+1;this.$list.css({width:s*this.length,marginLeft:(this.viewer.width-e)/2-s*t})},resetList:function(){this.$list.empty().removeClass(V).css("margin-left",0)},initImage:function(i){var t=this.options,e=this.$image,s=this.viewer,n=this.$footer.height(),a=s.width,o=ot(s.height-n,n),h=this.image||{};u(e[0],g.proxy(function(e,s){var n,r,l=e/s,d=a,u=o;o*l>a?u=a/l:d=o*l,d=at(.9*d,e),u=at(.9*u,s),r={naturalWidth:e,naturalHeight:s,aspectRatio:l,ratio:d/e,width:d,height:u,left:(a-d)/2,top:(o-u)/2},n=g.extend({},r),t.rotatable&&(r.rotate=h.rotate||0,n.rotate=0),t.scalable&&(r.scaleX=h.scaleX||1,r.scaleY=h.scaleY||1,n.scaleX=1,n.scaleY=1),this.image=r,this.initialImage=n,g.isFunction(i)&&i()},this))},renderImage:function(i){var t=this.image,e=this.$image;t.width===t.naturalWidth&&t.height===t.naturalHeight?g(".viewer-one-to-one").addClass("viewer-disable"):g(".viewer-one-to-one").removeClass("viewer-disable"),e.css({width:t.width,height:t.height,marginLeft:t.left,marginTop:t.top,transform:r(t)}),/MSIE [678]/.test(navigator.userAgent)&&(t.rotate=t.rotate%360,e.removeClass("iefilter0 iefilter90 iefilter180 iefilter270").addClass("iefilter"+t.rotate)),g.isFunction(i)&&(this.transitioning?e.one(B,i):i())},resetImage:function(){this.$image&&(this.$image.remove(),this.$image=null)},start:function(i){if(i.handled!==!0){i.handled=!0;var t=i.target;g(t).is("img")&&this.notEmoji(g(t).attr("src"))&&(this.target=t,this.show())}},click:function(i){var t=g(i.target),e=t.data("action"),s=this.image;switch(e){case"mix":this.isPlayed?this.stop():this.options.inline?this.isFulled?this.exit():this.full():this.hide();break;case"view":this.view(t.data("index"));break;case"zoom-in":this.zoom(.1,!0);break;case"zoom-out":this.zoom(-.1,!0);break;case"one-to-one":this.toggle();break;case"reset":this.reset();break;case"prev":this.prev();break;case"play":this.play();break;case"next":this.next();break;case"rotate-left":this.rotate(-90);break;case"rotate-right":this.rotate(90);break;case"flip-horizontal":this.scaleX(-s.scaleX||-1);break;case"flip-vertical":this.scaleY(-s.scaleY||-1);break;default:this.isPlayed&&this.stop()}},load:function(){var i=this.options,t=this.viewer,e=this.$image;this.timeout&&(clearTimeout(this.timeout),this.timeout=!1),e.removeClass(T).css("cssText","width:0;height:0;margin-left:"+t.width/2+"px;margin-top:"+t.height/2+"px;max-width:none!important;visibility:visible;"),this.initImage(g.proxy(function(){e.toggleClass(V,i.transition).toggleClass(X,i.movable),this.renderImage(g.proxy(function(){this.isViewed=!0,this.trigger(it)},this))},this))},loadImage:function(i){var t=i.target,e=g(t),s=e.parent(),n=s.width(),a=s.height(),o=i.data&&i.data.filled;u(t,function(i,t){var s=i/t,h=n,r=a;a*s>n?o?h=a*s:r=n/s:o?r=n/s:h=a*s,e.css({width:h,height:r,marginLeft:(n-h)/2,marginTop:(a-r)/2})})},resize:function(){this.initContainer(),this.initViewer(),this.renderViewer(),this.renderList(),this.isViewed&&this.initImage(g.proxy(function(){this.renderImage()},this)),this.isPlayed&&this.$player.find(L).one(W,g.proxy(this.loadImage,this)).trigger(W)},wheel:function(i){var t=i.originalEvent||i,e=ht(this.options.zoomRatio)||.1,s=1;this.isViewed&&(i.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(g.proxy(function(){this.wheeling=!1},this),50),t.deltaY?s=t.deltaY>0?1:-1:t.wheelDelta?s=-t.wheelDelta/120:t.detail&&(s=t.detail>0?1:-1),this.zoom(-s*e,!0,i)))},keydown:function(i){var t=this.options,e=i.which;if(this.isFulled&&t.keyboard)switch(e){case 27:this.isPlayed?this.stop():t.inline?this.isFulled&&this.exit():this.hide();break;case 32:this.isPlayed&&this.stop();break;case 37:this.prev();break;case 38:i.preventDefault(),this.zoom(t.zoomRatio,!0);break;case 39:this.next();break;case 40:i.preventDefault(),this.zoom(-t.zoomRatio,!0);break;case 48:case 49:(i.ctrlKey||i.shiftKey)&&(i.preventDefault(),this.toggle())}},mousedown:function(i){var t,e=this.options,s=i.originalEvent,n=s&&s.touches,a=i,o=e.movable?"move":!1;if(this.isViewed){if(n){if(t=n.length,t>1){if(!e.zoomable||2!==t)return;a=n[1],this.startX2=a.pageX,this.startY2=a.pageY,o="zoom"}else this.isSwitchable()&&(o="switch");a=n[0]}o&&(i.preventDefault(),this.action=o,this.startX=a.pageX||s&&s.pageX,this.startY=a.pageY||s&&s.pageY)}},mousemove:function(i){var t,e=this.options,s=this.action,n=this.$image,a=i.originalEvent,o=a&&a.touches,h=i;if(this.isViewed){if(o){if(t=o.length,t>1){if(!e.zoomable||2!==t)return;h=o[1],this.endX2=h.pageX,this.endY2=h.pageY}h=o[0]}s&&(i.preventDefault(),"move"===s&&e.transition&&n.hasClass(V)&&n.removeClass(V),this.endX=h.pageX||a&&a.pageX,this.endY=h.pageY||a&&a.pageY,this.change(i))}},mouseup:function(i){var t=this.action;t&&(i.preventDefault(),"move"===t&&this.options.transition&&this.$image.addClass(V),this.action=!1)},show:function(){var i,t=this.options;t.inline||this.transitioning||(this.isBuilt||this.build(),g.isFunction(t.show)&&this.$element.one(Z,t.show),this.trigger(Z).isDefaultPrevented()||(this.$body.addClass(y),i=this.$viewer.removeClass(C),this.$element.one(K,g.proxy(function(){var i=this.target?this.$images.index(this.target):this.index;console.log("this.target ? this.$images.index(this.target) : this.index",i),this.view(this.target?this.$images.index(this.target):this.index),this.target=!1},this)),t.transition?(this.transitioning=!0,i.addClass(V),l(i[0]),i.one(B,g.proxy(this.shown,this)).addClass(Y)):(i.addClass(Y),this.shown())))},hide:function(){var i=this.options,t=this.$viewer;i.inline||this.transitioning||!this.isShown||(g.isFunction(i.hide)&&this.$element.one(G,i.hide),this.trigger(G).isDefaultPrevented()||(this.isViewed&&i.transition?(this.transitioning=!0,this.$image.one(B,g.proxy(function(){t.one(B,g.proxy(this.hidden,this)).removeClass(Y)},this)),this.zoomTo(0,!1,!1,!0)):(t.removeClass(Y),this.hidden())))},view:function(i){var t,e,s,n,a,o=this.$title;console.log("view",i),i=Number(i)||0,0===i?g(".viewer-prev").addClass("viewer-disable"):g(".viewer-prev").removeClass("viewer-disable"),i===this.length-1?g(".viewer-next").addClass("viewer-disable"):g(".viewer-next").removeClass("viewer-disable"),!this.isShown||this.isPlayed||0>i||i>=this.length||this.isViewed&&i===this.index||this.trigger(Q).isDefaultPrevented()||(e=this.$items.eq(i),s=e.find(L),n=s.data("originalUrl"),a=s.attr("alt"),this.$image=t=g('<img src="'+n+'" alt="'+a+'">'),this.isViewed&&this.$items.eq(this.index).removeClass(P),e.addClass(P),this.isViewed=!1,this.index=i,this.image=null,this.$canvas.html(t.addClass(T)),this.renderList(),o.empty(),this.$element.one(it,g.proxy(function(){var i=this.image,t=i.naturalWidth,e=i.naturalHeight;o.html(a+" ("+t+" &times; "+e+")")},this)),t[0].complete?this.load():(t.one(W,g.proxy(this.load,this)),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(g.proxy(function(){t.removeClass(T),this.timeout=!1},this),1e3)))},prev:function(){this.view(ot(this.index-1,0))},next:function(){this.view(at(this.index+1,this.length-1))},move:function(i,t){var e=this.image;this.moveTo(a(i)?i:e.left+ht(i),a(t)?t:e.top+ht(t))},moveTo:function(i,t){var e=this.image,s=!1;a(t)&&(t=i),i=ht(i),t=ht(t),this.isViewed&&!this.isPlayed&&this.options.movable&&(n(i)&&(e.left=i,s=!0),n(t)&&(e.top=t,s=!0),s&&this.renderImage())},zoom:function(i,t,e){var s=this.image;i=ht(i),i=0>i?1/(1-i):1+i,this.zoomTo(s.width*i/s.naturalWidth,t,e)},zoomTo:function(i,t,e,s){var a,o,h,r,l,d=this.options,u=.01,m=100,v=this.image,g=v.width,f=v.height;i=ot(.1,i),i=at(10,i),n(i)&&this.isViewed&&!this.isPlayed&&(s||d.zoomable)&&(s||(u=ot(u,d.minZoomRatio),m=at(m,d.maxZoomRatio),i=at(ot(i,u),m)),i>.95&&1.05>i&&(i=1),o=v.naturalWidth*i,h=v.naturalHeight*i,e&&(a=e.originalEvent)?(r=this.$viewer.offset(),l=a.touches?c(a.touches):{pageX:e.pageX||a.pageX||0,pageY:e.pageY||a.pageY||0},v.left-=(o-g)*((l.pageX-r.left-v.left)/g),v.top-=(h-f)*((l.pageY-r.top-v.top)/f)):(v.left-=(o-g)/2,v.top-=(h-f)/2),v.width=o,v.height=h,v.ratio=i,this.renderImage(),t&&this.tooltip())},rotate:function(i){this.rotateTo((this.image.rotate||0)+ht(i))},rotateTo:function(i){var t=this.image;i=ht(i),n(i)&&this.isViewed&&!this.isPlayed&&this.options.rotatable&&(t.rotate=i,this.renderImage())},scale:function(i,t){var e=this.image,s=!1;a(t)&&(t=i),i=ht(i),t=ht(t),this.isViewed&&!this.isPlayed&&this.options.scalable&&(n(i)&&(e.scaleX=i,s=!0),n(t)&&(e.scaleY=t,s=!0),s&&this.renderImage())},scaleX:function(i){this.scale(i,this.image.scaleY)},scaleY:function(i){this.scale(this.image.scaleX,i)},play:function(){var i,t=this.options,e=this.$player,s=g.proxy(this.loadImage,this),a=[],o=0,h=0;this.isShown&&!this.isPlayed&&(t.fullscreen&&this.requestFullscreen(),this.isPlayed=!0,e.addClass($),this.$items.each(function(i){var n=g(this),r=n.find(L),l=g('<img src="'+r.data("originalUrl")+'" alt="'+r.attr("alt")+'">');o++,l.addClass(k).toggleClass(V,t.transition),n.hasClass(P)&&(l.addClass(Y),h=i),a.push(l),l.one(W,{filled:!1},s),e.append(l)}),n(t.interval)&&t.interval>0&&(i=g.proxy(function(){this.playing=setTimeout(function(){a[h].removeClass(Y),h++,h=o>h?h:0,a[h].addClass(Y),i()},t.interval)},this),o>1&&i()))},stop:function(){this.isPlayed&&(this.options.fullscreen&&this.exitFullscreen(),this.isPlayed=!1,clearTimeout(this.playing),this.$player.removeClass($).empty())},full:function(){var i=this.options,t=this.$image,e=this.$list;this.isShown&&!this.isPlayed&&!this.isFulled&&i.inline&&(this.isFulled=!0,this.$body.addClass(y),this.$button.addClass(S),i.transition&&(t.removeClass(V),e.removeClass(V)),this.$viewer.addClass(x).removeAttr("style").css("z-index",i.zIndex),this.initContainer(),this.viewer=g.extend({},this.container),this.renderList(),this.initImage(g.proxy(function(){this.renderImage(function(){i.transition&&setTimeout(function(){t.addClass(V),e.addClass(V)},0)})},this)))},exit:function(){var i=this.options,t=this.$image,e=this.$list;this.isFulled&&(this.isFulled=!1,this.$body.removeClass(y),this.$button.removeClass(S),i.transition&&(t.removeClass(V),e.removeClass(V)),this.$viewer.removeClass(x).css("z-index",i.zIndexInline),this.viewer=g.extend({},this.parent),this.renderViewer(),this.renderList(),this.initImage(g.proxy(function(){this.renderImage(function(){i.transition&&setTimeout(function(){t.addClass(V),e.addClass(V)},0)})},this)))},tooltip:function(){var i=this.options,t=this.$tooltip,e=this.image,s=[$,k,V].join(" ");this.isViewed&&!this.isPlayed&&i.tooltip&&(t.text(et(100*e.ratio)+"%"),this.tooltiping?clearTimeout(this.tooltiping):i.transition?(this.fading&&t.trigger(B),t.addClass(s),l(t[0]),t.addClass(Y)):t.addClass($),this.tooltiping=setTimeout(g.proxy(function(){i.transition?(t.one(B,g.proxy(function(){t.removeClass(s),this.fading=!1},this)).removeClass(Y),this.fading=!0):t.removeClass($),this.tooltiping=!1},this),1e3))},toggle:function(){this.zoomTo(1,!0),this.image.left=(this.viewer.width-this.image.naturalWidth)/2,this.image.top=(this.viewer.height-this.image.naturalHeight-90)/2,this.renderImage()},reset:function(){this.isViewed&&!this.isPlayed&&(this.image=g.extend({},this.initialImage),this.renderImage())},update:function(){var i,t=this.$element,e=this.$images,s=[];if(this.isImg){if(!t.parent().length)return this.destroy()}else this.$images=e=this.getReduceImage(),this.length=e.length;this.isBuilt&&(g.each(this.$items,function(i){var t=g(this).find("img")[0],n=e[i];n?n.src!==t.src&&s.push(i):s.push(i)}),this.$list.width("auto"),this.initList(),this.isShown&&(this.length?this.isViewed&&(i=g.inArray(this.index,s),i>=0?(this.isViewed=!1,this.view(ot(this.index-(i+1),0))):this.$items.eq(this.index).addClass(P)):(this.$image=null,this.isViewed=!1,this.index=0,this.image=null,this.$canvas.empty(),this.$title.empty())))},destroy:function(){var i=this.$element;this.options.inline?this.unbind():(this.isShown&&this.unbind(),i.off(H,this.proxy_start)),this.unbuild(),i.removeData(p)},trigger:function(i,t){var e=g.Event(i,t);return this.$element.trigger(e),e},shown:function(){var i=this.options;this.transitioning=!1,this.isFulled=!0,this.isShown=!0,this.isVisible=!0,this.render(),this.bind(),g.isFunction(i.shown)&&this.$element.one(K,i.shown),this.trigger(K)},hidden:function(){var i=this.options;this.transitioning=!1,this.isViewed=!1,this.isFulled=!1,this.isShown=!1,this.isVisible=!1,this.unbind(),this.$body.removeClass(y),this.$viewer.addClass(C),this.resetList(),this.resetImage(),g.isFunction(i.hidden)&&this.$element.one(J,i.hidden),this.trigger(J)},requestFullscreen:function(){var i=document.documentElement;!this.isFulled||document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement||(i.requestFullscreen?i.requestFullscreen():i.msRequestFullscreen?i.msRequestFullscreen():i.mozRequestFullScreen?i.mozRequestFullScreen():i.webkitRequestFullscreen&&i.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT))},exitFullscreen:function(){this.isFulled&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())},change:function(i){var t=this.endX-this.startX,e=this.endY-this.startY;switch(this.action){case"move":this.move(t,e);break;case"zoom":this.zoom(function(i,t,e,s){var n=st(i*i+t*t),a=st(e*e+s*s);return(a-n)/n}(nt(this.startX-this.startX2),nt(this.startY-this.startY2),nt(this.endX-this.endX2),nt(this.endY-this.endY2)),!1,i),this.startX2=this.endX2,this.startY2=this.endY2;break;case"switch":this.action="switched",nt(t)>nt(e)&&(t>1?this.prev():-1>t&&this.next())}this.startX=this.endX,this.startY=this.endY},isSwitchable:function(){var i=this.image,t=this.viewer;return i.left>=0&&i.top>=0&&i.width<=t.width&&i.height<=t.height}},v.DEFAULTS={inline:!1,button:!0,navbar:!0,title:!0,toolbar:!0,tooltip:!0,movable:!0,zoomable:!0,rotatable:!0,scalable:!0,transition:!0,fullscreen:!0,keyboard:!0,interval:5e3,minWidth:200,minHeight:100,zoomRatio:.1,minZoomRatio:.01,maxZoomRatio:100,zIndex:2015,zIndexInline:0,url:"src",build:null,built:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null},v.setDefaults=function(i){g.extend(v.DEFAULTS,i)},v.TEMPLATE='<div class="viewer-container"><div class="viewer-canvas"></div><div class="viewer-footer"><div class="viewer-title hide"></div><div class="viewer-toolbar-box"><ul class="viewer-toolbar"><li class="viewer-one-to-one viewer-disable"><i data-action="one-to-one"></i></li><li class="viewer-prev"><i data-action="prev"></i></li><li class="viewer-next"><i data-action="next"></i></li><li class="viewer-rotate-right"><i data-action="rotate-right"></i></li></ul></div><div class="viewer-navbar"><ul class="viewer-list"></ul></div></div><div class="viewer-tooltip"></div><div class="viewer-button"><div class="viewer-button-transparent"><i data-action="mix"></i></div></div><div class="viewer-player"></div></div>',v.other=g.fn.viewer,g.fn.viewer=function(i){var t,e=o(arguments,1);return this.each(function(){var n,a=g(this),o=a.data(p);if(!o){if(/destroy|hide|exit|stop|reset/.test(i))return;a.data(p,o=new v(this,i))}s(i)&&g.isFunction(n=o[i])&&(t=n.apply(o,e))}),a(t)?this:t},g.fn.viewer.Constructor=v,g.fn.viewer.setDefaults=v.setDefaults,g.fn.viewer.noConflict=function(){return g.fn.viewer=v.other,this},e.exports=g.fn.viewer});
define("pages/index/chatlist/main",function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=t("lego_modules/imweb-base-qjs/0.1.1/src/controller"),h=o(s),c=t("jquery"),l=(t("modules/lib/bower_components/nanoScroller/nanoScroller"),t("modules/lib/login")),u=t("modules/lib/faceReplace"),f=t("modules/lib/promise"),p=t("modules/lib/util"),g=u.faceWord;t("pages/index/chatlist/viewer");var m=function(t){function e(){n(this,e);var i=r(this,t.call(this));return i._isBottom=!0,i._scrollTop=0,i.countHeight=0,i.teacherCountHeight=0,i.countImage=0,i.startIndex=0,i}return a(e,t),e.prototype.init=function(t){this.el=c(t.$el),this._init(t),this.$lists=c("#list-ul"),this.initViewer()},e.prototype.initViewer=function(){var t=this;t.$images=c(".viewer-content"),t.$images.viewer(),t.$lists.on("click","a.img-zoom-in",function(){c(this).prev().trigger("dblclick")}),t.$lists.on("dblclick","img",function(){var e=c(this).data("imageindex");return c(".viewer-box img").eq(e).trigger("dblclick"),t.model.$emit("chatlist.imgviewer_click"),!1})},e.prototype.resetViewer=function(){this.$images.viewer("webcourseUpdate")},e.prototype.removeQAttr=function(){var t=this.$lists.find(".chat-list-getheight");t.find("[q-if]").removeAttr("q-if"),t.find("[q-class]").removeAttr("q-class"),t.find("[q-attr]").removeAttr("q-attr"),t.find("[q-text]").removeAttr("q-text"),t.find("[q-html]").removeAttr("q-html"),t.find("[q-show]").removeAttr("q-show")},e.prototype.resetBigImages=function(){var t=this,e=[];return t.removeQAttr(),t.$lists.find(".chat-list-getheight img").each(function(){var i=c(this);i.attr("data-imageindex",t.countImage),t.countImage++,!i.next().hasClass("img-zoom-in")&&e.push(t._getImageSize(this).then(function(t){t>240&&c('<a href="javascript:void(0)" class="img-zoom-in icon-font i-zoom-in"></a>').insertAfter(i)}))}),f.all(e)},e.prototype._getImageSize=function(t){return new f(function(e){var i;i=document.createElement("img"),i.onload=function(){e(this.width,this.height)},i.onError=function(){e(0,0)},i.src=t.src})},e.prototype.updateScroll=function(){this.el.nanoScroller()},e.prototype._bindEvent=function(){var t=this;this.model.$watch("chatList",function(){t.updateScroll()}),this.el.bind("scrollend",function(){t.model.$set("tipText",""),t._isBottom=!0}),this.el.on("update",function(e,i){t._scrollTop=i.position,t._isBottom=!1,t.showChatListHandler()})},e.prototype.longScrollCheck=function(){var t=this,e=this.$lists,i=t.model.chatList;e.find(".chat-list-getheight li").each(function(){var e=c(this),o=e.data("index"),n=i[o];n&&!n.height&&(n.height=e.outerHeight(!0),n.height=n.height<50?50:n.height,n.top=t.countHeight,n.innerHTML=e.html(),t.countHeight+=n.height),1===n.type&&n.role>1&&(n.teacherTop=t.teacherCountHeight,t.teacherCountHeight+=n.height+8,t.model.teacherChatList.push(n))}),t.model.$set("chatGetHeightList",[]),t.renderChatListHeight(),t.showChatListHandler()},e.prototype.renderChatListHeight=function(){var t=this,e=this.$lists;e.height(t.model.onlyTeacher?t.teacherCountHeight:t.countHeight)},e.prototype.binarySearch=function(t,e){var i=0,o=t.length,n=0,r=void 0;if(0==o)return-1;for(;o>=i;){if(n=Math.floor((i+o)/2),r=e(n,t),0===r)return n;r>0?o=n-1:i=n+1}return-1},e.prototype.getStartIndexFromList=function(t,e){var i=-this._scrollTop;e=e||"top";var o=this.binarySearch(t,function(t,o){var n=o[t-1],r=o[t];return r&&n?i+r[e]+r.height>=0&&i+n[e]+n.height<0?0:i+r[e]+r.height<0?-1:i+n[e]+n.height>=0?1:void 0:0});return 0>o?0:o},e.prototype.showChatListHandler=function(){var t=(this.$lists,this.el.height()),e=[],i=-this._scrollTop,o=void 0,n=void 0,r=void 0;n=this.model.onlyTeacher?this.model.teacherChatList:this.model.chatList,r=this.model.onlyTeacher?"teacherTop":"top",o=this.getStartIndexFromList(n,r);for(var a=n.length,s=o;a>s;s++){var h=n[s];if(!h)break;if(i+h.top+h.height>=0&&e.push(h),!this.isBottom()&&h.top+i>t)break}this.array2Array("showChatList",e)},e.prototype.array2Array=function(t,e){var i=this.model[t]||[],o=i.length;o>0&&o===e.length&&i[0].index===e[0].index&&i[o-1].index===e[o-1].index||this.model.$set(t,e)},e.prototype.scrollBottom=function(){this.el.nanoScroller({flash:"bottom"}),this.el.nanoScroller({scroll:"bottom"})},e.prototype.isBottom=function(){return this._isBottom},e.prototype.getScrollTop=function(){return~~this._scrollTop},e}(h["default"]),d=new m;i.exports={data:{onlyTeacher:!1,chatList:[],teacherChatList:[],showChatList:[],allImages:[],chatGetHeightList:[],chatListStyle:{height:"400px"},tipText:"",warnText:""},filters:{avatarClass:function(t){var e=~~t.role,i=~~t.sex,o="avatar-stu";switch(e){case 1:o="avatar-zhujiao";break;case 2:o="avatar-tech";break;case 6:o="avatar-stu";break;case 7:o="avatar-admin";break;case 8:o="avatar-captain";break;case 9:o="avatar-banzhang"}return o+(2===i?"-female":"-male")},isTeacher:function(t){return t>0},isOnlyTeacher:function(t){return 2===t},isOnlyZhujiao:function(t){return 1===t},isOnlyBanzhang:function(t){return 9===t},isStudent:function(t){return 0===t},isMine:function(t){return-1===t},whichType:function(t,e){return t===~~e},roleType:function(t){var e=~~t.role,i="";switch(e){case 1:i="助教";break;case 2:i="老师";break;case 7:i="管理员";break;case 8:i="校长";break;case 9:i="班长"}return i},ItemMarginTop:function(t){return this.onlyTeacher?"top:"+t.teacherTop+"px":"top:"+t.top+"px"}},directives:{},methods:{setOnlyTeacher:function(t){this.$set("onlyTeacher",t),d.showChatListHandler(),d.renderChatListHeight(),d.updateScroll()},setChatListStyle:function(t){this.$set("chatListStyle",t),setTimeout(function(){d.updateScroll()},100)},setChatList:function(t){for(var e=this,i=!1,o=0,n=t.length;n>o;o++)t[o]&&~~t[o].fromUin===~~l.uin()&&"flower"===t[o].cmd&&t.splice(o,1);if(t&&t.length){var r=this.chatList,a=(this.showChatList,r.length),s=this.allImages;t.forEach(function(t){t.index=a,a+=1}),r.push.apply(r,t),this.chatGetHeightList.push.apply(this.chatGetHeightList,t),t.forEach(function(t){return/<(img|IMG)/.test(t.content)?(i=!0,void s.push(t)):void 0}),p.throttleV2(function(){e._checkScrollTop(t),d.resetBigImages().then(function(){d.longScrollCheck(),i&&d.resetViewer()})["catch"](function(t){window.BJ_REPORT.info("chatlist promise|"+t.toString())})},50,100)()}},setWarnText:function(t){var e=this;this.$set("warnText",t),setTimeout(function(){e.$set("warnText","")},5e3)},clickTipText:function(){d.scrollBottom(),this.$set("tipText","")},_checkScrollTop:function(t){var e=c(this.$el),i=(d.getScrollTop(),t[t.length-1]),o="";if(c(this.$$["list-ul"]).height()-e.height()>0&&!d.isBottom()){switch(i.type){case 1:o=i.name+": "+i.content;break;case 2:o='"'+i.name+'"送给"'+i.to+'"鲜花';break;case 3:o=i.content}o=o.replace(/(<img [^>]*src=['"]([^'"]+)[^>]*>|([^<>]*))/gi,function(t,e,i){if(i){var o=i.match(/\/\/7\.url\.cn\/edu\/webcourse\/img\/emoji\/(\d+?)\@2x.gif/);if(o)return"["+g[+o[1]]+"]";var n=i.match(/\/\/p\.qpic\.cn\/edu_msgpic\/0\/([A-Z0-9]+)\/0/);if(n)return"[图片]"}return t}),o&&this.$set("tipText",o.replace(/<br>/g,""))}else d.scrollBottom(),setTimeout(function(){d.scrollBottom()},100)}},ready:function(){d.init(this),c(this.$el).nanoScroller()}}});
define("components/third/face/main",function(e,i,t){"use strict";function n(e){return e.replace(/<(img|IMG).+?src\=(["'])([^"']+?)\2.*?>/g,function(e,i,t,n){var o=n.match(/\/\/0\.web\.qstatic\.com\/webqqpic\/style\/face\/(\d+?).gif/);return o?"["+n.match(/\/\/0\.web\.qstatic\.com\/webqqpic\/style\/face\/(\d+?).png/)[1]+"]":e})}function o(e){return e.replace(/\[(.+?)\]/g,function(e,i){return-1!==+i?'<img src="//7.url.cn/edu/webcourse/img/emoji/'+i+'.png">':e})}function s(e,i){var t=this;return this.container=e=r(e),this.panel=void 0,this.hover=void 0,this.hoverImg=void 0,this.hoverText=void 0,this.hoverPos="left",this.vm=i.vm,this._bind={onClick:function(e){return t._onClick(e)},onHide:function(e){return t.hide(e)},onMouseover:function(e){return t._onMouseover(e)},onMousehover:function(e){return t._onMousehover(e)}},this.init(e,i)}var r=e("jquery"),c=["微笑","撇嘴","色","发呆","得意","流泪","害羞","闭嘴","睡","大哭","尴尬","发怒","调皮","呲牙","惊讶","难过","酷","冷汗","抓狂","吐","偷笑","可爱","白眼","傲慢","饥饿","困","惊恐","流汗","憨笑","大兵","奋斗","咒骂","疑问","嘘","晕","折磨","衰","骷髅","敲打","再见","擦汗","抠鼻","鼓掌","糗大了","坏笑","左哼哼","右哼哼","哈欠","鄙视","委屈","快哭了","阴险","亲亲","吓","可怜","菜刀","西瓜","啤酒","篮球","乒乓","咖啡","饭","猪头","玫瑰","凋谢","示爱","爱心","心碎","蛋糕","闪电","炸弹","刀","足球","瓢虫","便便","月亮","太阳","礼物","拥抱","强","弱","握手","胜利","抱拳","勾引","拳头","差劲","爱你","NO","OK","爱情","飞吻","跳跳","发抖","怄火","转圈","磕头","回头","跳绳","挥手","激动","街舞","献吻","左太极","右太极"],a=function(e){e=e||{};var i=[];i.push('<div class="face_selector hide"><div class="face_hover left"><div class="img"><img class="face" title="OK" src="//7.url.cn/edu/webcourse/modules/img/emoji/89@2x.gif" alt="[/OK]" rel="face"></div><div class="name">OK</div></div><div class="inner_pnl">');for(var t=0;105>t;t++)i.push('<a href="javascript:void(0)" i="',t,'" ',e.tabindex?'tabindex="'+e.tabindex+'"':"","></a>");return i.push('</div><div class="row" style="display: none;"></div><div class="bg"></div></div>'),i.join("")},h=function(){};s.prototype={constructor:s,_bindEvent:function(e){e.on("click","a[i]",this._bind.onClick).on("mouseover","a[i]",this._bind.onMouseover).on("mouseover",".face_hover",this._bind.onMousehover),r(document).on("click",this._bind.onHide)},_onClick:function(e){e.stopPropagation();var i,t=r(e.target),n=t.attr("i");if(n)return i=r.Event("face"),i.word=c[+n],i.faceCode=n,i.face="//7.url.cn/edu/webcourse/modules/img/emoji/"+i.faceCode+"@2x.gif",this.panel.trigger(i),this.hide(),this},_onMouseover:function(e){e.stopPropagation();var i=r(e.target),t=i.attr("i");t&&(this.hoverImg.prop("src","//7.url.cn/edu/webcourse/modules/img/emoji/"+t+"@2x.gif"),this.hoverText.html(c[t]))},_onMousehover:function(e){e.stopPropagation();var i=r(e.target).closest(".face_hover");i.hasClass("left")?i.removeClass("left").addClass("right"):i.removeClass("right").addClass("left")},init:function(e,i){return e.append(a(i)),this.panel=r(".face_selector",e),this.hover=r(".face_hover",e),this.hoverImg=r("img",this.hover),this.hoverText=r(".name",this.hover),this._bindEvent(this.panel),this.init=h,this},show:function(){return this.panel.show(),this.vm.$emit("face.show"),this},hide:function(){return this.panel.hide(),this.vm.$emit("face.hide"),this},on:function(){return this.panel.on.apply(this.panel,arguments),this}},r.extend(s,{encode:n,decode:o}),t.exports={_face:"",bind:function(){var e=this;r(this.el).bind("click",function(){e._face||(e._face=new s(this,{vm:e.vm}),e._face.on("face",function(i){e.vm.$emit("face.face",i)})),setTimeout(function(){e._face.show()},0)})},unbind:function(){}}});
define("pages/index/chattoolbar/main",function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=e("lego_modules/imweb-base-qjs/0.1.1/src/controller"),s=i(a),u=e("modules/lib/login"),c=e("modules/lib/third");c.key("third-face",e("components/third/face/main"));var f=function(e){function t(){r(this,t);var o=l(this,e.call(this));return o.components={uploadImage:"#upload-image"},o}return n(t,e),t.prototype.init=function(e){this._init(e)},t}(s["default"]),h=new f;o.exports={data:{onlyTeacher:!1,allowFace:!1,allowImage:!1,allowFlower:!1,flowerFreqLimit:!1,isAllreadyInGroup:!0,defaultGroupHref:"",groupHref:"javascript:void(0)",groupTitle:"加入该群",isWexinUser:u.isWeixinUser()},filters:{getTitle:function(e){return e?"查看全部":"只看老师说话"},getImageTitle:function(e){return e?"发送图片":"老师已禁止发送图片"}},directives:{},methods:{clickOnlyTeacher:function(){this.$set("onlyTeacher",!this.onlyTeacher),this.$emit("chattoolbar.onlyTeacher",this.onlyTeacher)},toggleFace:function(){},clickUploadImage:function(){this.allowImage&&this.$emit("chattoolbar.upload")},clickFlower:function(){var e=this;this.allowFlower&&this.$emit("chattoolbar.flower"),this.setAllowFlower(!1),this.$set("flowerFreqLimit",!0),setTimeout(function(){!e.allowFlower&&e.flowerFreqLimit&&e.setAllowFlower(!0)},3e4)},clickJoinGroup:function(){this.joinGroup(),this.$emit("chattoolbar.addGroup")},joinGroup:function(){},setAllowFlower:function(e){this.$set("allowFlower",e),!e&&this.$set("flowerFreqLimit",!1)},setAllowImage:function(e){this.$set("allowImage",e)},setAllowFace:function(e){this.$set("allowFace",e)},setIsAllow:function(e){this.$set({allowFace:e,allowFlower:e,allowImage:e})},setIsAllreadyinGroup:function(e){this.$set(e?{groupHref:this.defaultGroupHref,groupTitle:"已加入此课堂群"}:{groupHref:this.defaultGroupHref,groupTitle:"加入此课堂群"}),this.$set("isAllreadyInGroup",e)},setDefaultGroupHref:function(e){this.$set("defaultGroupHref",e)}},ready:function(){h.init(this)}}});
define("pages/index/imguploader/main",function(e,i,o){"use strict";function r(e){if(!e)return"";for(var i=5381,o=0,r=e.length;r>o;++o)i+=(i<<5)+e.charAt(o).charCodeAt();return 2147483647&i}var t=e("modules/lib/jquery.uploader"),n=e("modules/lib/login"),u=e("modules/lib/cookie"),l=e("jquery");e("lego_modules/modal/0.0.2/modal"),o.exports={data:{},filters:{},directives:{},methods:{},ready:function(){function e(){return n.isWeixinUser()?u.get("uid_a2")||"":u.get("skey")||""}function i(){l(o.$$.filePicker).removeClass("hover-icon")}var o=this,a=l(this.$el),s=a.find("input.upload-img");s.parent().on("mouseover","input.upload-img",function(){l(o.$$.filePicker).addClass("hover-icon")}).on("mouseout","input.upload-img",function(){l(o.$$.filePicker).removeClass("hover-icon")});var d="";t.upload(s,{data:{bkn:r(e())},url:"//ke.qq.com/cgi-bin/web_ke/upload_pic_ie",beforeSend:function(){var e=a.find("input.upload-img"),o=l.trim(e.val());return d=o.substring(o.lastIndexOf(".")+1).toLowerCase(),i(),/\.(PNG|JPG|JPEG|GIF|BMP)$/i.test(o)?this.files&&this.files[0]&&this.files[0].size>2097152?(l.modal.alert("上传的图片过大，请上传2M以内的图片！"),!1):void 0:(l.modal.alert("请选择PNG,JPG,GIF,BMP图片上传！"),!1)},success:function(e){e.result.ext=d,o.$emit("imguploader.new-image",e.result)},error:function(){return l.modal.alert("上传失败"),!0}})}}});
define("pages/index/editor/jquery.hotkeys",function(e,t,s){"use strict";var a=e("jquery");!function(e){function t(t){var s=t.handler,a=(t.namespace||"").toLowerCase().split(" ");a=e.map(a,function(e){return e.split(".")}),(1!==a.length||""!==a[0]&&"autocomplete"!==a[0].substring(0,12)&&"accordion"!==a[0].substring(0,9)&&"tabs"!==a[0].substring(0,4)&&"menu"!==a[0].substring(0,4))&&(t.handler=function(t){if(this===t.target||!/textarea|select/i.test(t.target.nodeName)&&"text"!==t.target.type&&"true"!=$(t.target).prop("contenteditable")){var r="keypress"!==t.type&&e.hotkeys.specialKeys[t.which],i=String.fromCharCode(t.which).toLowerCase(),n="",o={};t.altKey&&"alt"!==r&&(n+="alt_"),t.ctrlKey&&"ctrl"!==r&&(n+="ctrl_"),t.metaKey&&!t.ctrlKey&&"meta"!==r&&(n+="meta_"),t.shiftKey&&"shift"!==r&&(n+="shift_"),r?o[n+r]=!0:(o[n+i]=!0,o[n+e.hotkeys.shiftNums[i]]=!0,"shift_"===n&&(o[e.hotkeys.shiftNums[i]]=!0));for(var c=0,f=a.length;f>c;c++)if(o[a[c]])return s.apply(this,arguments)}})}e.hotkeys={version:"0.8+",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",188:",",190:".",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},e.each(["keydown","keyup","keypress"],function(){e.event.special[this]={add:t}})}(a),s.exports=a.hotkeys});
define("pages/index/editor/main",function(e,t,n){"use strict";var i=e("jquery");e("modules/lib/bower_components/nanoScroller/nanoScroller"),e("pages/index/editor/jquery.hotkeys");var o="editor-content",r={saveSelection:function(){try{if(document.getSelection){var e=document.getSelection(),t=[];if(e.rangeCount)for(var n=0,i=e.rangeCount;i>n;n++)t.push(e.getRangeAt(n));return t}return document.selection&&document.selection.createRange&&"none"!==document.selection.type.toLowerCase()?document.selection.createRange():null}catch(o){console.log(o)}},restoreSelection:function(){return document.getSelection?function(e){var t=document.getSelection();t.removeAllRanges();for(var n=0,i=e.length;i>n;n++)t.addRange(e[n])}:document.selection?function(e){e&&e.select()}:function(){}}(),replaceSelection:function(e){if(e){var t=document.getElementById(o);if(t.focus(),window.getSelection){var n,i=window.getSelection(),r="string"==typeof e?document.createTextNode(e):e;i.getRangeAt&&i.rangeCount>0?(n=i.getRangeAt(0),n.deleteContents(),n.collapse(!1),n.insertNode(document.createTextNode(" ")),n.insertNode(r),n.setStart(r,0),setTimeout(function(){if(document.createRange)n=document.createRange(),n.setStartAfter(r),n.collapse(!1),i.removeAllRanges(),i.addRange(n);else{var e=document.body.createTextRange();e.moveToElementText(r),e.select()}},0)):t.innerHTML+=r.outerHTML}else if(document.selection&&document.selection.createRange){var n=document.selection.createRange();"string"==typeof e?n.text=e:n.pasteHTML?n.pasteHTML(e.outerHTML):t.innerHTML+=r.outerHTML}}}},s=function(e){return this.content=void 0,this.selection=void 0,this.hasFocus=void 0,this._init(e)};s.prototype={constructor:s,_init:function(e){return this.content=i("#"+o,e),this._bindEvent(),this},_bindEvent:function(){var e=this;this.content.on("mousedown",function(){e.saveSelection()}).on("blur",function(){e.saveSelection()})},saveSelection:function(){try{this.selection=r.saveSelection()||this.selection}catch(e){}return this},insert:function(e){e=i(e),this.content.trigger("focus"),this.selection&&r.restoreSelection(this.selection);try{r.replaceSelection(e[0])}catch(t){}return this},val:function(){return this.content.html()},focus:function(){return this.content.trigger("focus"),this.selection?r.restoreSelection(this.selection):r.content.focus(),this},clear:function(){return this.content.empty(),this},filter:function(){return this.content.html(this.content.html().replace(/<(\S+?)\s.+?>/g,function(e,t){if("img"!==t&&"IMG"!==t)return"";e=e.replace(/^<IMG/,"<img");var n=e.match(/<img.+?src\=(["'])\/\/7.url.cn\/edu\/webcourse\/img\/emoji\/([\d\D]+?).png\1.*?>/);return n?i("<div>").html(i(e).addClass("face-zoom")).html():""})),this},filtHTML:function(e){var t=e.originalEvent.clipboardData||window.clipboardData,n=t.getData("text"),o=-1!=navigator.userAgent.indexOf("Firefox");if(o||0===n.length||1===n.length&&32===n.charCodeAt(0))return!0;var s=r.saveSelection(),c=i('<input style="width:100px;height:40px;margin:0;padding:0;border:1;outline:0;" value="">');return i("body").append(c),c.val(n),c[0].select(),document.execCommand("copy"),document.getSelection&&document.getSelection().removeAllRanges(),c.remove(),r.restoreSelection(s),r.replaceSelection(n),!1}};var c=200;n.exports={data:{isAllow:!1,limitSec:0,_limitSecTimer:"",warnType:0,isRefresh:!1,textOverLength:0},filters:{whatType:function(e,t){return e===~~t}},directives:{},methods:{insert:function(e){this.isAllow&&this.editor.insert(e)},clear:function(){this.editor.clear()},submit:function(){this.isAllow&&(this.$emit("editor.submit",this.editor.val()),i("#editor-content",this.el).focus())},setLimitSec:function(e){var t=this;if(-1!==e){if(this.isRefresh){var n=Math.floor((new Date-(window._Tlive||new Date))/1e3);e=n>=e?0:e-n,this.$set("isRefresh",!1)}this.$set("limitSec",e),clearInterval(this._limitSecTimer),this._limitSecTimer=setInterval(function(){var e=t.limitSec;e?(t.$set("limitSec",--e),t.setWarnType(0)):(t.setWarnType(-2),clearInterval(t._limitSecTimer))},1e3)}else this.setIsAllow(!1)},setWarnType:function(e){var t=this.warnType;0!==t&&-2===e||-1!==t&&0===e||(-1===e||-2===e?this.$set("isAllow",!0):(this.editor.clear(),this.$set("isAllow",!1)),this.$set("warnType",e))},setIsAllow:function(e){this.$set("isAllow",e)},refreshChat:function(){this.setWarnType(-1),this.setWarnType(0),this.$set("isRefresh",!0),this.$emit("chat.refresh")},getStrLength:function(e){var t=e.replace(/<\/div>|<\/span>/g,"").replace(/<div[^>]+>|<span[^>]+>/g,"").replace(/<div>|<span>|<br>/g,"\r").replace(/<img.*>/g,"");return t.length},contentInput:function(){var e=this.getStrLength(this.editor.val()),t=e-c;this.$set("textOverLength",t>0?t:0)}},ready:function(){var e=this,t=i(this.$el);this.editor=new s(t),t.find("#editor-content").bind("keydown.return",function(){return e.submit(),!1}).bind("keydown",function(){i(".nano",t).nanoScroller()}).on("paste",function(t){return e.$emit("editor.paste",i(this)),e.editor.filtHTML(t)}),this.$watch("isAllow",function(t){e.$emit("editor.isAllow",t)}),i(".nano",t).nanoScroller()}}});
define("pages/index/memberlist/main",function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=e("lego_modules/imweb-base-qjs/0.1.1/src/controller"),c=i(o),u=e("modules/lib/login"),h=function(e){function t(){return n(this,t),s(this,e.call(this))}return a(t,e),t.prototype.init=function(e){this._init(e),this.teacherMap={}},t.prototype.getRole=function(e){if(e+="",this.teacherMap[e])return this.teacherMap[e];for(var t=this.model.teacherList||[],r=0,i=t.length;i>r;r++)if(t[r].uid===e&&t[r].role_id)return this.teacherMap[e]=t[r],t[r];return!1},t.prototype.isTeacher=function(e){return!!this.getRole(e)},t}(c["default"]),f=new h;r.exports={data:{groupList:[],teacherList:[],members:[],memberListStyle:{height:"400px"},isFirstPage:1,isLastpage:1,searchContent:"",isWexinUser:u.isWeixinUser()},filters:{avatarClass:function(e){var t=~~e.role_id,r=~~e.sex,i="avatar-stu";switch(t){case 1:i="avatar-zhujiao";break;case 2:i="avatar-tech";break;case 6:i="avatar-stu";break;case 7:i="avatar-admin";break;case 8:i="avatar-captain";break;case 9:i="avatar-banzhang"}return i+(2===r?"-female":"-male")},getNickname:function(e,t){var r=~~t.role_id;switch(r){case 1:return"[助教] "+e;case 2:return"[老师] "+e;case 7:return"[管理员] "+e;case 8:return"[校长] "+e;case 9:return"[班长] "+e;default:return e}},not:function(e){return!e},isPhone:function(e){return 1===e||2===e}},directives:{},methods:{startSearch:function(){this.$emit("memberlist.searchUser",this.searchContent)},setGroupList:function(e){this.$set("groupList",e)},setTeacherList:function(e){this.$set("teacherList",e)},setData:function(e){this.setTeacherList(e.teacherList),this.$set("members",e.userList),this.$set("isFirstPage",e.isFirstPage),this.$set("isLastPage",e.curPage*e.countPerPage>=e.total)},isTeacher:function(e){return f.isTeacher(e)},getRole:function(e){return f.getRole(e)},setMemberListStyle:function(e){this.$set("memberListStyle",e)},preMemberList:function(){this.$emit("memberlist.pre-page","pre")},nextMemberList:function(){this.$emit("memberlist.next-page","next")},init:function(){}},ready:function(){f.init(this)}}});
define("lego_modules/socket.io-client/1.7.2/dist/socket.io",function(t,e,r){!function(t,n){"object"==typeof e&&"object"==typeof r?r.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof e?e.io=n():t.io=n()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function n(t,e){"object"===("undefined"==typeof t?"undefined":i(t))&&(e=t,t=void 0),e=e||{};var r,n=s(t),a=n.source,p=n.id,f=n.path,l=h[p]&&f in h[p].nsps,d=e.forceNew||e["force new connection"]||!1===e.multiplex||l;return d?(u("ignoring socket cache for %s",a),r=c(a,e)):(h[p]||(u("new io instance for %s",a),h[p]=c(a,e)),r=h[p]),n.query&&!e.query?e.query=n.query:e&&"object"===i(e.query)&&(e.query=o(e.query)),r.socket(n.path,e)}function o(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e.join("&")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=r(1),a=r(7),c=r(17),u=r(3)("socket.io-client");t.exports=e=n;var h=e.managers={};e.protocol=a.protocol,e.connect=n,e.Manager=r(17),e.Socket=r(44)},function(t,e,r){(function(e){"use strict";function n(t,r){var n=t;r=r||e.location,null==t&&(t=r.protocol+"//"+r.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?r.protocol+t:r.host+t),/^(https?|wss?):\/\//.test(t)||(i("protocol-less url %s",t),t="undefined"!=typeof r?r.protocol+"//"+t:"https://"+t),i("parse %s",t),n=o(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var s=-1!==n.host.indexOf(":"),a=s?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port,n.href=n.protocol+"://"+a+(r&&r.port===n.port?"":":"+n.port),n}var o=r(2),i=r(3)("socket.io-client:url");t.exports=n}).call(e,function(){return this}())},function(t){var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var n=t,o=t.indexOf("["),i=t.indexOf("]");-1!=o&&-1!=i&&(t=t.substring(0,o)+t.substring(o,i).replace(/:/g,";")+t.substring(i,t.length));for(var s=e.exec(t||""),a={},c=14;c--;)a[r[c]]=s[c]||"";return-1!=o&&-1!=i&&(a.source=n,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(t,e,r){(function(n){function o(){return"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function i(){var t=arguments,r=this.useColors;if(t[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+t[0]+(r?"%c ":" ")+"+"+e.humanize(this.diff),!r)return t;var n="color: "+this.color;t=[t[0],n,"color: inherit"].concat(Array.prototype.slice.call(t,1));var o=0,i=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&(o++,"%c"===t&&(i=o))}),t.splice(i,0,n),t}function s(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(r){}}function c(){try{return e.storage.debug}catch(t){}return"undefined"!=typeof n&&"env"in n?n.env.DEBUG:void 0}function u(){try{return window.localStorage}catch(t){}}e=t.exports=r(5),e.log=s,e.formatArgs=i,e.save=a,e.load=c,e.useColors=o,e.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:u(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},e.enable(c())}).call(e,r(4))},function(t){function e(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function n(t){if(u===setTimeout)return setTimeout(t,0);if((u===e||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(r){try{return u.call(null,t,0)}catch(r){return u.call(this,t,0)}}}function o(t){if(h===clearTimeout)return clearTimeout(t);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function i(){d&&f&&(d=!1,f.length?l=f.concat(l):y=-1,l.length&&s())}function s(){if(!d){var t=n(i);d=!0;for(var e=l.length;e;){for(f=l,l=[];++y<e;)f&&f[y].run();y=-1,e=l.length}f=null,d=!1,o(t)}}function a(t,e){this.fun=t,this.array=e}function c(){}var u,h,p=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:e}catch(t){u=e}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(t){h=r}}();var f,l=[],d=!1,y=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new a(t,e)),1!==l.length||d||n(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.binding=function(){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e,r){function n(){return e.colors[h++%e.colors.length]}function o(t){function r(){}function o(){var t=o,r=+new Date,i=r-(u||r);t.diff=i,t.prev=u,t.curr=r,u=r,null==t.useColors&&(t.useColors=e.useColors()),null==t.color&&t.useColors&&(t.color=n());for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var c=0;s[0]=s[0].replace(/%([a-z%])/g,function(r,n){if("%%"===r)return r;c++;var o=e.formatters[n];if("function"==typeof o){var i=s[c];r=o.call(t,i),s.splice(c,1),c--}return r}),s=e.formatArgs.apply(t,s);var h=o.log||e.log||console.log.bind(console);h.apply(t,s)}r.enabled=!1,o.enabled=!0;var i=e.enabled(t)?o:r;return i.namespace=t,i}function i(t){e.save(t);for(var r=(t||"").split(/[\s,]+/),n=r.length,o=0;n>o;o++)r[o]&&(t=r[o].replace(/[\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*/g,".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))}function s(){e.enable("")}function a(t){var r,n;for(r=0,n=e.skips.length;n>r;r++)if(e.skips[r].test(t))return!1;for(r=0,n=e.names.length;n>r;r++)if(e.names[r].test(t))return!0;return!1}function c(t){return t instanceof Error?t.stack||t.message:t}e=t.exports=o.debug=o,e.coerce=c,e.disable=s,e.enable=i,e.enabled=a,e.humanize=r(6),e.names=[],e.skips=[],e.formatters={};var u,h=0},function(t){function e(t){if(t=String(t),!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*u;case"days":case"day":case"d":return r*c;case"hours":case"hour":case"hrs":case"hr":case"h":return r*a;case"minutes":case"minute":case"mins":case"min":case"m":return r*s;case"seconds":case"second":case"secs":case"sec":case"s":return r*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return void 0}}}}function r(t){return t>=c?Math.round(t/c)+"d":t>=a?Math.round(t/a)+"h":t>=s?Math.round(t/s)+"m":t>=i?Math.round(t/i)+"s":t+"ms"}function n(t){return o(t,c,"day")||o(t,a,"hour")||o(t,s,"minute")||o(t,i,"second")||t+" ms"}function o(t,e,r){return e>t?void 0:1.5*e>t?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}var i=1e3,s=60*i,a=60*s,c=24*a,u=365.25*c;t.exports=function(t,o){o=o||{};var i=typeof t;if("string"===i&&t.length>0)return e(t);if("number"===i&&isNaN(t)===!1)return o.long?n(t):r(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,r){function n(){}function o(t){var r="",n=!1;return r+=t.type,(e.BINARY_EVENT==t.type||e.BINARY_ACK==t.type)&&(r+=t.attachments,r+="-"),t.nsp&&"/"!=t.nsp&&(n=!0,r+=t.nsp),null!=t.id&&(n&&(r+=",",n=!1),r+=t.id),null!=t.data&&(n&&(r+=","),r+=f.stringify(t.data)),p("encoded %j as %s",t,r),r}function i(t,e){function r(t){var r=d.deconstructPacket(t),n=o(r.packet),i=r.buffers;i.unshift(n),e(i)}d.removeBlobs(t,r)}function s(){this.reconstructor=null}function a(t){var r={},n=0;if(r.type=Number(t.charAt(0)),null==e.types[r.type])return h();if(e.BINARY_EVENT==r.type||e.BINARY_ACK==r.type){for(var o="";"-"!=t.charAt(++n)&&(o+=t.charAt(n),n!=t.length););if(o!=Number(o)||"-"!=t.charAt(n))throw new Error("Illegal attachments");r.attachments=Number(o)}if("/"==t.charAt(n+1))for(r.nsp="";++n;){var i=t.charAt(n);if(","==i)break;if(r.nsp+=i,n==t.length)break}else r.nsp="/";var s=t.charAt(n+1);if(""!==s&&Number(s)==s){for(r.id="";++n;){var i=t.charAt(n);if(null==i||Number(i)!=i){--n;break}if(r.id+=t.charAt(n),n==t.length)break}r.id=Number(r.id)}return t.charAt(++n)&&(r=c(r,t.substr(n))),p("decoded %s as %j",t,r),r}function c(t,e){try{t.data=f.parse(e)}catch(r){return h()}return t}function u(t){this.reconPack=t,this.buffers=[]}function h(){return{type:e.ERROR,data:"parser error"}}var p=r(8)("socket.io-parser"),f=r(11),l=r(13),d=r(14),y=r(16);e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=n,e.Decoder=s,n.prototype.encode=function(t,r){if(p("encoding packet %j",t),e.BINARY_EVENT==t.type||e.BINARY_ACK==t.type)i(t,r);else{var n=o(t);r([n])}},l(s.prototype),s.prototype.add=function(t){var r;if("string"==typeof t)r=a(t),e.BINARY_EVENT==r.type||e.BINARY_ACK==r.type?(this.reconstructor=new u(r),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",r)):this.emit("decoded",r);else{if(!y(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,this.emit("decoded",r))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},u.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length==this.reconPack.attachments){var e=d.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},u.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,e,r){function n(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function o(){var t=arguments,r=this.useColors;if(t[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+t[0]+(r?"%c ":" ")+"+"+e.humanize(this.diff),!r)return t;var n="color: "+this.color;t=[t[0],n,"color: inherit"].concat(Array.prototype.slice.call(t,1));var o=0,i=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&(o++,"%c"===t&&(i=o))}),t.splice(i,0,n),t}function i(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(r){}}function a(){var t;try{t=e.storage.debug}catch(r){}return t}function c(){try{return window.localStorage}catch(t){}}e=t.exports=r(9),e.log=i,e.formatArgs=o,e.save=s,e.load=a,e.useColors=n,e.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){return JSON.stringify(t)},e.enable(a())},function(t,e,r){function n(){return e.colors[h++%e.colors.length]}function o(t){function r(){}function o(){var t=o,r=+new Date,i=r-(u||r);t.diff=i,t.prev=u,t.curr=r,u=r,null==t.useColors&&(t.useColors=e.useColors()),null==t.color&&t.useColors&&(t.color=n());var s=Array.prototype.slice.call(arguments);s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var a=0;s[0]=s[0].replace(/%([a-z%])/g,function(r,n){if("%%"===r)return r;a++;var o=e.formatters[n];if("function"==typeof o){var i=s[a];r=o.call(t,i),s.splice(a,1),a--}return r}),"function"==typeof e.formatArgs&&(s=e.formatArgs.apply(t,s));var c=o.log||e.log||console.log.bind(console);c.apply(t,s)}r.enabled=!1,o.enabled=!0;var i=e.enabled(t)?o:r;return i.namespace=t,i}function i(t){e.save(t);for(var r=(t||"").split(/[\s,]+/),n=r.length,o=0;n>o;o++)r[o]&&(t=r[o].replace(/\*/g,".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))}function s(){e.enable("")}function a(t){var r,n;for(r=0,n=e.skips.length;n>r;r++)if(e.skips[r].test(t))return!1;for(r=0,n=e.names.length;n>r;r++)if(e.names[r].test(t))return!0;return!1}function c(t){return t instanceof Error?t.stack||t.message:t}e=t.exports=o,e.coerce=c,e.disable=s,e.enable=i,e.enabled=a,e.humanize=r(10),e.names=[],e.skips=[],e.formatters={};var u,h=0},function(t){function e(t){if(t=""+t,!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*u;case"days":case"day":case"d":return r*c;case"hours":case"hour":case"hrs":case"hr":case"h":return r*a;case"minutes":case"minute":case"mins":case"min":case"m":return r*s;case"seconds":case"second":case"secs":case"sec":case"s":return r*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r}}}}function r(t){return t>=c?Math.round(t/c)+"d":t>=a?Math.round(t/a)+"h":t>=s?Math.round(t/s)+"m":t>=i?Math.round(t/i)+"s":t+"ms"}function n(t){return o(t,c,"day")||o(t,a,"hour")||o(t,s,"minute")||o(t,i,"second")||t+" ms"}function o(t,e,r){return e>t?void 0:1.5*e>t?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}var i=1e3,s=60*i,a=60*s,c=24*a,u=365.25*c;t.exports=function(t,o){return o=o||{},"string"==typeof t?e(t):o.long?n(t):r(t)}},function(t,e,r){(function(t,r){var n=!1;(function(){function o(t,e){function r(t){if(r[t]!==g)return r[t];var o;if("bug-string-char-index"==t)o="a"!="a"[0];else if("json"==t)o=r("json-stringify")&&r("json-parse");else{var s,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var c=e.stringify,h="function"==typeof c&&b;if(h){(s=function(){return 1}).toJSON=s;try{h="0"===c(0)&&"0"===c(new n)&&'""'==c(new i)&&c(v)===g&&c(g)===g&&c()===g&&"1"===c(s)&&"[1]"==c([s])&&"[null]"==c([g])&&"null"==c(null)&&"[null,null,null]"==c([g,v,null])&&c({a:[s,!0,!1,null,"\x00\b\n\f\r	"]})==a&&"1"===c(null,s)&&"[\n 1,\n 2\n]"==c([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==c(new u(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==c(new u(864e13))&&'"-000001-01-01T00:00:00.000Z"'==c(new u(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==c(new u(-1))}catch(p){h=!1}}o=h}if("json-parse"==t){var f=e.parse;if("function"==typeof f)try{if(0===f("0")&&!f(!1)){s=f(a);var l=5==s.a.length&&1===s.a[0];if(l){try{l=!f('"	"')}catch(p){}if(l)try{l=1!==f("01")}catch(p){}if(l)try{l=1!==f("1.")}catch(p){}}}}catch(p){l=!1}o=l}}return r[t]=!!o}t||(t=c.Object()),e||(e=c.Object());var n=t.Number||c.Number,i=t.String||c.String,a=t.Object||c.Object,u=t.Date||c.Date,h=t.SyntaxError||c.SyntaxError,p=t.TypeError||c.TypeError,f=t.Math||c.Math,l=t.JSON||c.JSON;"object"==typeof l&&l&&(e.stringify=l.stringify,e.parse=l.parse);var d,y,g,m=a.prototype,v=m.toString,b=new u(-0xc782b5b800cec);try{b=-109252==b.getUTCFullYear()&&0===b.getUTCMonth()&&1===b.getUTCDate()&&10==b.getUTCHours()&&37==b.getUTCMinutes()&&6==b.getUTCSeconds()&&708==b.getUTCMilliseconds()}catch(k){}if(!r("json")){var w="[object Function]",x="[object Date]",A="[object Number]",C="[object String]",B="[object Array]",S="[object Boolean]",T=r("bug-string-char-index");if(!b)var E=f.floor,_=[0,31,59,90,120,151,181,212,243,273,304,334],N=function(t,e){return _[e]+365*(t-1970)+E((t-1969+(e=+(e>1)))/4)-E((t-1901+e)/100)+E((t-1601+e)/400)};if((d=m.hasOwnProperty)||(d=function(t){var e,r={};return(r.__proto__=null,r.__proto__={toString:1},r).toString!=v?d=function(t){var e=this.__proto__,r=t in(this.__proto__=null,this);return this.__proto__=e,r}:(e=r.constructor,d=function(t){var r=(this.constructor||e).prototype;return t in this&&!(t in r&&this[t]===r[t])}),r=null,d.call(this,t)}),y=function(t,e){var r,n,o,i=0;(r=function(){this.valueOf=0}).prototype.valueOf=0,n=new r;for(o in n)d.call(n,o)&&i++;return r=n=null,i?y=2==i?function(t,e){var r,n={},o=v.call(t)==w;for(r in t)o&&"prototype"==r||d.call(n,r)||!(n[r]=1)||!d.call(t,r)||e(r)}:function(t,e){var r,n,o=v.call(t)==w;for(r in t)o&&"prototype"==r||!d.call(t,r)||(n="constructor"===r)||e(r);(n||d.call(t,r="constructor"))&&e(r)}:(n=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],y=function(t,e){var r,o,i=v.call(t)==w,a=!i&&"function"!=typeof t.constructor&&s[typeof t.hasOwnProperty]&&t.hasOwnProperty||d;for(r in t)i&&"prototype"==r||!a.call(t,r)||e(r);for(o=n.length;r=n[--o];a.call(t,r)&&e(r));}),y(t,e)},!r("json-stringify")){var j={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},O="000000",P=function(t,e){return(O+(e||0)).slice(-t)},R="\\u00",D=function(t){for(var e='"',r=0,n=t.length,o=!T||n>10,i=o&&(T?t.split(""):t);n>r;r++){var s=t.charCodeAt(r);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=j[s];break;default:if(32>s){e+=R+P(2,s.toString(16));break}e+=o?i[r]:t.charAt(r)}}return e+'"'},q=function(t,e,r,n,o,i,s){var a,c,u,h,f,l,m,b,k,w,T,_,j,O,R,U;try{a=e[t]}catch(M){}if("object"==typeof a&&a)if(c=v.call(a),c!=x||d.call(a,"toJSON"))"function"==typeof a.toJSON&&(c!=A&&c!=C&&c!=B||d.call(a,"toJSON"))&&(a=a.toJSON(t));else if(a>-1/0&&1/0>a){if(N){for(f=E(a/864e5),u=E(f/365.2425)+1970-1;N(u+1,0)<=f;u++);for(h=E((f-N(u,0))/30.42);N(u,h+1)<=f;h++);f=1+f-N(u,h),l=(a%864e5+864e5)%864e5,m=E(l/36e5)%24,b=E(l/6e4)%60,k=E(l/1e3)%60,w=l%1e3}else u=a.getUTCFullYear(),h=a.getUTCMonth(),f=a.getUTCDate(),m=a.getUTCHours(),b=a.getUTCMinutes(),k=a.getUTCSeconds(),w=a.getUTCMilliseconds();a=(0>=u||u>=1e4?(0>u?"-":"+")+P(6,0>u?-u:u):P(4,u))+"-"+P(2,h+1)+"-"+P(2,f)+"T"+P(2,m)+":"+P(2,b)+":"+P(2,k)+"."+P(3,w)+"Z"}else a=null;if(r&&(a=r.call(e,t,a)),null===a)return"null";if(c=v.call(a),c==S)return""+a;if(c==A)return a>-1/0&&1/0>a?""+a:"null";if(c==C)return D(""+a);if("object"==typeof a){for(O=s.length;O--;)if(s[O]===a)throw p();if(s.push(a),T=[],R=i,i+=o,c==B){for(j=0,O=a.length;O>j;j++)_=q(j,a,r,n,o,i,s),T.push(_===g?"null":_);U=T.length?o?"[\n"+i+T.join(",\n"+i)+"\n"+R+"]":"["+T.join(",")+"]":"[]"}else y(n||a,function(t){var e=q(t,a,r,n,o,i,s);e!==g&&T.push(D(t)+":"+(o?" ":"")+e)}),U=T.length?o?"{\n"+i+T.join(",\n"+i)+"\n"+R+"}":"{"+T.join(",")+"}":"{}";return s.pop(),U}};e.stringify=function(t,e,r){var n,o,i,a;if(s[typeof e]&&e)if((a=v.call(e))==w)o=e;else if(a==B){i={};for(var c,u=0,h=e.length;h>u;c=e[u++],a=v.call(c),(a==C||a==A)&&(i[c]=1));}if(r)if((a=v.call(r))==A){if((r-=r%1)>0)for(n="",r>10&&(r=10);n.length<r;n+=" ");}else a==C&&(n=r.length<=10?r:r.slice(0,10));return q("",(c={},c[""]=t,c),o,i,n,"",[])}}if(!r("json-parse")){var U,M,L=i.fromCharCode,I={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},H=function(){throw U=M=null,h()},z=function(){for(var t,e,r,n,o,i=M,s=i.length;s>U;)switch(o=i.charCodeAt(U)){case 9:case 10:case 13:case 32:U++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=T?i.charAt(U):i[U],U++,t;case 34:for(t="@",U++;s>U;)if(o=i.charCodeAt(U),32>o)H();else if(92==o)switch(o=i.charCodeAt(++U)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=I[o],U++;break;case 117:for(e=++U,r=U+4;r>U;U++)o=i.charCodeAt(U),o>=48&&57>=o||o>=97&&102>=o||o>=65&&70>=o||H();t+=L("0x"+i.slice(e,U));break;default:H()}else{if(34==o)break;for(o=i.charCodeAt(U),e=U;o>=32&&92!=o&&34!=o;)o=i.charCodeAt(++U);t+=i.slice(e,U)}if(34==i.charCodeAt(U))return U++,t;H();default:if(e=U,45==o&&(n=!0,o=i.charCodeAt(++U)),o>=48&&57>=o){for(48==o&&(o=i.charCodeAt(U+1),o>=48&&57>=o)&&H(),n=!1;s>U&&(o=i.charCodeAt(U),o>=48&&57>=o);U++);if(46==i.charCodeAt(U)){for(r=++U;s>r&&(o=i.charCodeAt(r),o>=48&&57>=o);r++);r==U&&H(),U=r}if(o=i.charCodeAt(U),101==o||69==o){for(o=i.charCodeAt(++U),(43==o||45==o)&&U++,r=U;s>r&&(o=i.charCodeAt(r),o>=48&&57>=o);r++);r==U&&H(),U=r}return+i.slice(e,U)}if(n&&H(),"true"==i.slice(U,U+4))return U+=4,!0;if("false"==i.slice(U,U+5))return U+=5,!1;if("null"==i.slice(U,U+4))return U+=4,null;H()}return"$"},J=function(t){var e,r;if("$"==t&&H(),"string"==typeof t){if("@"==(T?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];t=z(),"]"!=t;r||(r=!0))r&&(","==t?(t=z(),"]"==t&&H()):H()),","==t&&H(),e.push(J(t));return e}if("{"==t){for(e={};t=z(),"}"!=t;r||(r=!0))r&&(","==t?(t=z(),"}"==t&&H()):H()),(","==t||"string"!=typeof t||"@"!=(T?t.charAt(0):t[0])||":"!=z())&&H(),e[t.slice(1)]=J(z());return e}H()}return t},X=function(t,e,r){var n=F(t,e,r);n===g?delete t[e]:t[e]=n},F=function(t,e,r){var n,o=t[e];if("object"==typeof o&&o)if(v.call(o)==B)for(n=o.length;n--;)X(o,n,r);else y(o,function(t){X(o,t,r)});return r.call(t,e,o)};e.parse=function(t,e){var r,n;return U=0,M=""+t,r=J(z()),"$"!=z()&&H(),U=M=null,e&&v.call(e)==w?F((n={},n[""]=r,n),"",e):r}}}return e.runInContext=o,e}var i="function"==typeof n&&n.amd,s={"function":!0,object:!0},a=s[typeof e]&&e&&!e.nodeType&&e,c=s[typeof window]&&window||this,u=a&&s[typeof t]&&t&&!t.nodeType&&"object"==typeof r&&r;if(!u||u.global!==u&&u.window!==u&&u.self!==u||(c=u),a&&!i)o(c,a);else{var h=c.JSON,p=c.JSON3,f=!1,l=o(c,c.JSON3={noConflict:function(){return f||(f=!0,c.JSON=h,c.JSON3=p,h=p=null),l}});c.JSON={parse:l.parse,stringify:l.stringify}}i&&n(function(){return l})}).call(this)}).call(e,r(12)(t),function(){return this}())},function(t){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t){function e(t){return t?r(t):void 0}function r(t){for(var r in e.prototype)t[r]=e.prototype[r];return t}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},e.prototype.once=function(t,e){function r(){n.off(t,r),e.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},r.fn=e,this.on(t,r),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks[t];if(!r)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var n,o=0;o<r.length;o++)if(n=r[o],n===e||n.fn===e){r.splice(o,1);break}return this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks[t];if(r){r=r.slice(0);for(var n=0,o=r.length;o>n;++n)r[n].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,r){(function(t){var n=r(15),o=r(16);e.deconstructPacket=function(t){function e(t){if(!t)return t;if(o(t)){var i={_placeholder:!0,num:r.length};return r.push(t),i}if(n(t)){for(var s=new Array(t.length),a=0;a<t.length;a++)s[a]=e(t[a]);return s}if("object"==typeof t&&!(t instanceof Date)){var s={};for(var c in t)s[c]=e(t[c]);return s}return t}var r=[],i=t.data,s=t;return s.data=e(i),s.attachments=r.length,{packet:s,buffers:r}},e.reconstructPacket=function(t,e){function r(t){if(t&&t._placeholder){var o=e[t.num];return o}if(n(t)){for(var i=0;i<t.length;i++)t[i]=r(t[i]);return t}if(t&&"object"==typeof t){for(var s in t)t[s]=r(t[s]);return t}return t}return t.data=r(t.data),t.attachments=void 0,t},e.removeBlobs=function(e,r){function i(e,c,u){if(!e)return e;if(t.Blob&&e instanceof Blob||t.File&&e instanceof File){s++;var h=new FileReader;h.onload=function(){u?u[c]=this.result:a=this.result,--s||r(a)},h.readAsArrayBuffer(e)}else if(n(e))for(var p=0;p<e.length;p++)i(e[p],p,e);else if(e&&"object"==typeof e&&!o(e))for(var f in e)i(e[f],f,e)}var s=0,a=e;i(a),s||r(a)}}).call(e,function(){return this}())},function(t){t.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},function(t,e){(function(e){function r(t){return e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer}t.exports=r}).call(e,function(){return this}())},function(t,e,r){"use strict";function n(t,e){return this instanceof n?(t&&"object"===("undefined"==typeof t?"undefined":o(t))&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new c.Encoder,this.decoder=new c.Decoder,this.autoConnect=e.autoConnect!==!1,void(this.autoConnect&&this.open())):new n(t,e)}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=r(18),s=r(44),a=r(35),c=r(7),u=r(46),h=r(47),p=r(3)("socket.io-client:manager"),f=r(42),l=r(48),d=Object.prototype.hasOwnProperty;t.exports=n,n.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var t in this.nsps)d.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},n.prototype.updateSocketIds=function(){for(var t in this.nsps)d.call(this.nsps,t)&&(this.nsps[t].id=this.engine.id)},a(n.prototype),n.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},n.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},n.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.prototype.open=n.prototype.connect=function(t){if(p("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;p("opening %s",this.uri),this.engine=i(this.uri,this.opts);var e=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var n=u(e,"open",function(){r.onopen(),t&&t()}),o=u(e,"error",function(e){if(p("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",e),t){var n=new Error("Connection error");n.data=e,t(n)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;p("connect attempt will timeout after %d",s);var a=setTimeout(function(){p("connect attempt timed out after %d",s),n.destroy(),e.close(),e.emit("error","timeout"),r.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(n),this.subs.push(o),this},n.prototype.onopen=function(){p("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(u(t,"data",h(this,"ondata"))),this.subs.push(u(t,"ping",h(this,"onping"))),this.subs.push(u(t,"pong",h(this,"onpong"))),this.subs.push(u(t,"error",h(this,"onerror"))),this.subs.push(u(t,"close",h(this,"onclose"))),this.subs.push(u(this.decoder,"decoded",h(this,"ondecoded")))},n.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},n.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},n.prototype.ondata=function(t){this.decoder.add(t)},n.prototype.ondecoded=function(t){this.emit("packet",t)},n.prototype.onerror=function(t){p("error",t),this.emitAll("error",t)},n.prototype.socket=function(t,e){function r(){~f(o.connecting,n)||o.connecting.push(n)}var n=this.nsps[t];if(!n){n=new s(this,t,e),this.nsps[t]=n;var o=this;n.on("connecting",r),n.on("connect",function(){n.id=o.engine.id}),this.autoConnect&&r()}return n},n.prototype.destroy=function(t){var e=f(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},n.prototype.packet=function(t){p("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(r){for(var n=0;n<r.length;n++)e.engine.write(r[n],t.options);e.encoding=!1,e.processPacketQueue()}))},n.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},n.prototype.cleanup=function(){p("cleanup");for(var t=this.subs.length,e=0;t>e;e++){var r=this.subs.shift();r.destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){p("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(t){p("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();p("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var r=setTimeout(function(){t.skipReconnect||(p("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(p("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(p("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(r)}})}},n.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,e,r){t.exports=r(19)},function(t,e,r){t.exports=r(20),t.exports.parser=r(27)},function(t,e,r){(function(e){function n(t,r){if(!(this instanceof n))return new n(t,r);r=r||{},t&&"object"==typeof t&&(r=t,t=null),t?(t=h(t),r.hostname=t.host,r.secure="https"===t.protocol||"wss"===t.protocol,r.port=t.port,t.query&&(r.query=t.query)):r.host&&(r.hostname=h(r.host).host),this.secure=null!=r.secure?r.secure:e.location&&"https:"===location.protocol,r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.agent=r.agent||!1,this.hostname=r.hostname||(e.location?location.hostname:"localhost"),this.port=r.port||(e.location&&location.port?location.port:this.secure?443:80),this.query=r.query||{},"string"==typeof this.query&&(this.query=f.decode(this.query)),this.upgrade=!1!==r.upgrade,this.path=(r.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!r.forceJSONP,this.jsonp=!1!==r.jsonp,this.forceBase64=!!r.forceBase64,this.enablesXDR=!!r.enablesXDR,this.timestampParam=r.timestampParam||"t",this.timestampRequests=r.timestampRequests,this.transports=r.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=r.policyPort||843,this.rememberUpgrade=r.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=r.onlyBinaryUpgrades,this.perMessageDeflate=!1!==r.perMessageDeflate?r.perMessageDeflate||{}:!1,!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=r.pfx||null,this.key=r.key||null,this.passphrase=r.passphrase||null,this.cert=r.cert||null,this.ca=r.ca||null,this.ciphers=r.ciphers||null,this.rejectUnauthorized=void 0===r.rejectUnauthorized?null:r.rejectUnauthorized,this.forceNode=!!r.forceNode;
var o="object"==typeof e&&e;o.global===o&&(r.extraHeaders&&Object.keys(r.extraHeaders).length>0&&(this.extraHeaders=r.extraHeaders),r.localAddress&&(this.localAddress=r.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function o(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}var i=r(21),s=r(35),a=r(3)("engine.io-client:socket"),c=r(42),u=r(27),h=r(2),p=r(43),f=r(36);t.exports=n,n.priorWebsocketSuccess=!1,s(n.prototype),n.protocol=u.protocol,n.Socket=n,n.Transport=r(26),n.transports=r(21),n.parser=r(27),n.prototype.createTransport=function(t){a('creating transport "%s"',t);var e=o(this.query);e.EIO=u.protocol,e.transport=t,this.id&&(e.sid=this.id);var r=new i[t]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:e,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders,forceNode:this.forceNode,localAddress:this.localAddress});return r},n.prototype.open=function(){var t;if(this.rememberUpgrade&&n.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(r){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},n.prototype.setTransport=function(t){a("setting transport %s",t.name);var e=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(t){e.onPacket(t)}).on("error",function(t){e.onError(t)}).on("close",function(){e.onClose("transport close")})},n.prototype.probe=function(t){function e(){if(f.onlyBinaryUpgrades){var e=!this.supportsBinary&&f.transport.supportsBinary;p=p||e}p||(a('probe transport "%s" opened',t),h.send([{type:"ping",data:"probe"}]),h.once("packet",function(e){if(!p)if("pong"===e.type&&"probe"===e.data){if(a('probe transport "%s" pong',t),f.upgrading=!0,f.emit("upgrading",h),!h)return;n.priorWebsocketSuccess="websocket"===h.name,a('pausing current transport "%s"',f.transport.name),f.transport.pause(function(){p||"closed"!==f.readyState&&(a("changing transport and sending upgrade packet"),u(),f.setTransport(h),h.send([{type:"upgrade"}]),f.emit("upgrade",h),h=null,f.upgrading=!1,f.flush())})}else{a('probe transport "%s" failed',t);var r=new Error("probe error");r.transport=h.name,f.emit("upgradeError",r)}}))}function r(){p||(p=!0,u(),h.close(),h=null)}function o(e){var n=new Error("probe error: "+e);n.transport=h.name,r(),a('probe transport "%s" failed because of error: %s',t,e),f.emit("upgradeError",n)}function i(){o("transport closed")}function s(){o("socket closed")}function c(t){h&&t.name!==h.name&&(a('"%s" works - aborting "%s"',t.name,h.name),r())}function u(){h.removeListener("open",e),h.removeListener("error",o),h.removeListener("close",i),f.removeListener("close",s),f.removeListener("upgrading",c)}a('probing transport "%s"',t);var h=this.createTransport(t,{probe:1}),p=!1,f=this;n.priorWebsocketSuccess=!1,h.once("open",e),h.once("error",o),h.once("close",i),this.once("close",s),this.once("upgrading",c),h.open()},n.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var t=0,e=this.upgrades.length;e>t;t++)this.probe(this.upgrades[t])}},n.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(p(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else a('packet received with socket readyState "%s"',this.readyState)},n.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},n.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!==e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},n.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){a("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},n.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})},n.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},n.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},n.prototype.write=n.prototype.send=function(t,e,r){return this.sendPacket("message",t,e,r),this},n.prototype.sendPacket=function(t,e,r,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){r=r||{},r.compress=!1!==r.compress;var o={type:t,data:e,options:r};this.emit("packetCreate",o),this.writeBuffer.push(o),n&&this.once("flush",n),this.flush()}},n.prototype.close=function(){function t(){n.onClose("forced close"),a("socket closing - telling transport to close"),n.transport.close()}function e(){n.removeListener("upgrade",e),n.removeListener("upgradeError",e),t()}function r(){n.once("upgrade",e),n.once("upgradeError",e)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var n=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():t()}):this.upgrading?r():t()}return this},n.prototype.onError=function(t){a("socket error %j",t),n.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},n.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){a('socket close with reason: "%s"',t);var r=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),r.writeBuffer=[],r.prevBufferLen=0}},n.prototype.filterUpgrades=function(t){for(var e=[],r=0,n=t.length;n>r;r++)~c(this.transports,t[r])&&e.push(t[r]);return e}}).call(e,function(){return this}())},function(t,e,r){(function(t){function n(e){var r,n=!1,a=!1,c=!1!==e.jsonp;if(t.location){var u="https:"===location.protocol,h=location.port;h||(h=u?443:80),n=e.hostname!==location.hostname||h!==e.port,a=e.secure!==u}if(e.xdomain=n,e.xscheme=a,r=new o(e),"open"in r&&!e.forceJSONP)return new i(e);if(!c)throw new Error("JSONP disabled");return new s(e)}var o=r(22),i=r(24),s=r(39),a=r(40);e.polling=n,e.websocket=a}).call(e,function(){return this}())},function(t,e,r){(function(e){var n=r(23);t.exports=function(t){var r=t.xdomain,o=t.xscheme,i=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!r||n))return new XMLHttpRequest}catch(s){}try{if("undefined"!=typeof XDomainRequest&&!o&&i)return new XDomainRequest}catch(s){}if(!r)try{return new(e[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(s){}}}).call(e,function(){return this}())},function(t){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(t,e,r){(function(e){function n(){}function o(t){if(c.call(this,t),this.requestTimeout=t.requestTimeout,e.location){var r="https:"===location.protocol,n=location.port;n||(n=r?443:80),this.xd=t.hostname!==e.location.hostname||n!==t.port,this.xs=t.secure!==r}else this.extraHeaders=t.extraHeaders}function i(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function s(){for(var t in i.requests)i.requests.hasOwnProperty(t)&&i.requests[t].abort()}var a=r(22),c=r(25),u=r(35),h=r(37),p=r(3)("engine.io-client:polling-xhr");t.exports=o,t.exports.Request=i,h(o,c),o.prototype.supportsBinary=!0,o.prototype.request=function(t){return t=t||{},t.uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new i(t)},o.prototype.doWrite=function(t,e){var r="string"!=typeof t&&void 0!==t,n=this.request({method:"POST",data:t,isBinary:r}),o=this;n.on("success",e),n.on("error",function(t){o.onError("xhr post error",t)}),this.sendXhr=n},o.prototype.doPoll=function(){p("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t},u(i.prototype),i.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var r=this.xhr=new a(t),n=this;try{p("xhr open %s: %s",this.method,this.uri),r.open(this.method,this.uri,this.async);try{if(this.extraHeaders){r.setDisableHeaderCheck(!0);for(var o in this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&r.setRequestHeader(o,this.extraHeaders[o])}}catch(s){}if(this.supportsBinary&&(r.responseType="arraybuffer"),"POST"===this.method)try{this.isBinary?r.setRequestHeader("Content-type","application/octet-stream"):r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(s){}try{r.setRequestHeader("Accept","*/*")}catch(s){}"withCredentials"in r&&(r.withCredentials=!0),this.requestTimeout&&(r.timeout=this.requestTimeout),this.hasXDR()?(r.onload=function(){n.onLoad()},r.onerror=function(){n.onError(r.responseText)}):r.onreadystatechange=function(){4===r.readyState&&(200===r.status||1223===r.status?n.onLoad():setTimeout(function(){n.onError(r.status)},0))},p("xhr data %s",this.data),r.send(this.data)}catch(s){return void setTimeout(function(){n.onError(s)},0)}e.document&&(this.index=i.requestsCount++,i.requests[this.index]=this)},i.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},i.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},i.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},i.prototype.cleanup=function(t){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,t)try{this.xhr.abort()}catch(r){}e.document&&delete i.requests[this.index],this.xhr=null}},i.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(r){}if("application/octet-stream"===e)t=this.xhr.response||this.xhr.responseText;else if(this.supportsBinary)try{t=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(r){for(var n=new Uint8Array(this.xhr.response),o=[],i=0,s=n.length;s>i;i++)o.push(n[i]);t=String.fromCharCode.apply(null,o)}else t=this.xhr.responseText}catch(r){this.onError(r)}null!=t&&this.onData(t)},i.prototype.hasXDR=function(){return"undefined"!=typeof e.XDomainRequest&&!this.xs&&this.enablesXDR},i.prototype.abort=function(){this.cleanup()},i.requestsCount=0,i.requests={},e.document&&(e.attachEvent?e.attachEvent("onunload",s):e.addEventListener&&e.addEventListener("beforeunload",s,!1))}).call(e,function(){return this}())},function(t,e,r){function n(t){var e=t&&t.forceBase64;(!h||e)&&(this.supportsBinary=!1),o.call(this,t)}var o=r(26),i=r(36),s=r(27),a=r(37),c=r(38),u=r(3)("engine.io-client:polling");t.exports=n;var h=function(){var t=r(22),e=new t({xdomain:!1});return null!=e.responseType}();a(n,o),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(t){function e(){u("paused"),r.readyState="paused",t()}var r=this;if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(u("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){u("pre-pause polling complete"),--n||e()})),this.writable||(u("we are currently writing - waiting to pause"),n++,this.once("drain",function(){u("pre-pause writing complete"),--n||e()}))}else e()},n.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(t){var e=this;u("polling got data %s",t);var r=function(t){return"opening"===e.readyState&&e.onOpen(),"close"===t.type?(e.onClose(),!1):void e.onPacket(t)};s.decodePayload(t,this.socket.binaryType,r),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},n.prototype.doClose=function(){function t(){u("writing close packet"),e.write([{type:"close"}])}var e=this;"open"===this.readyState?(u("transport open - closing"),t()):(u("transport not open - deferring close"),this.once("open",t))},n.prototype.write=function(t){var e=this;this.writable=!1;var r=function(){e.writable=!0,e.emit("drain")};s.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,r)})},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",r="";!1!==this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||t.sid||(t.b64=1),t=i.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(r=":"+this.port),t.length&&(t="?"+t);var n=-1!==this.hostname.indexOf(":");return e+"://"+(n?"["+this.hostname+"]":this.hostname)+r+this.path+t}},function(t,e,r){function n(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}var o=r(27),i=r(35);t.exports=n,i(n.prototype),n.prototype.onError=function(t,e){var r=new Error(t);return r.type="TransportError",r.description=e,this.emit("error",r),this},n.prototype.open=function(){return("closed"===this.readyState||""===this.readyState)&&(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this},n.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(t){var e=o.decodePacket(t,this.socket.binaryType);this.onPacket(e)},n.prototype.onPacket=function(t){this.emit("packet",t)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,e,r){(function(t){function n(t,r){var n="b"+e.packets[t.type]+t.data.data;return r(n)}function o(t,r,n){if(!r)return e.encodeBase64Packet(t,n);var o=t.data,i=new Uint8Array(o),s=new Uint8Array(1+o.byteLength);s[0]=v[t.type];for(var a=0;a<i.length;a++)s[a+1]=i[a];return n(s.buffer)}function i(t,r,n){if(!r)return e.encodeBase64Packet(t,n);var o=new FileReader;return o.onload=function(){t.data=o.result,e.encodePacket(t,r,!0,n)},o.readAsArrayBuffer(t.data)}function s(t,r,n){if(!r)return e.encodeBase64Packet(t,n);if(m)return i(t,r,n);var o=new Uint8Array(1);o[0]=v[t.type];var s=new w([o.buffer,t.data]);return n(s)}function a(t){try{t=d.decode(t)}catch(e){return!1}return t}function c(t,e,r){for(var n=new Array(t.length),o=l(t.length,r),i=function(t,r,o){e(r,function(e,r){n[t]=r,o(e,n)})},s=0;s<t.length;s++)i(s,t[s],o)}var u,h=r(28),p=r(29),f=r(30),l=r(31),d=r(32);t&&t.ArrayBuffer&&(u=r(33));var y="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),g="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),m=y||g;e.protocol=3;var v=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},b=h(v),k={type:"error",data:"parser error"},w=r(34);e.encodePacket=function(e,r,i,a){"function"==typeof r&&(a=r,r=!1),"function"==typeof i&&(a=i,i=null);var c=void 0===e.data?void 0:e.data.buffer||e.data;if(t.ArrayBuffer&&c instanceof ArrayBuffer)return o(e,r,a);if(w&&c instanceof t.Blob)return s(e,r,a);if(c&&c.base64)return n(e,a);var u=v[e.type];return void 0!==e.data&&(u+=i?d.encode(String(e.data)):String(e.data)),a(""+u)},e.encodeBase64Packet=function(r,n){var o="b"+e.packets[r.type];if(w&&r.data instanceof t.Blob){var i=new FileReader;return i.onload=function(){var t=i.result.split(",")[1];n(o+t)},i.readAsDataURL(r.data)}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(r.data))}catch(a){for(var c=new Uint8Array(r.data),u=new Array(c.length),h=0;h<c.length;h++)u[h]=c[h];s=String.fromCharCode.apply(null,u)}return o+=t.btoa(s),n(o)},e.decodePacket=function(t,r,n){if(void 0===t)return k;if("string"==typeof t){if("b"==t.charAt(0))return e.decodeBase64Packet(t.substr(1),r);if(n&&(t=a(t),t===!1))return k;var o=t.charAt(0);return Number(o)==o&&b[o]?t.length>1?{type:b[o],data:t.substring(1)}:{type:b[o]}:k}var i=new Uint8Array(t),o=i[0],s=f(t,1);return w&&"blob"===r&&(s=new w([s])),{type:b[o],data:s}},e.decodeBase64Packet=function(t,e){var r=b[t.charAt(0)];if(!u)return{type:r,data:{base64:!0,data:t.substr(1)}};var n=u.decode(t.substr(1));return"blob"===e&&w&&(n=new w([n])),{type:r,data:n}},e.encodePayload=function(t,r,n){function o(t){return t.length+":"+t}function i(t,n){e.encodePacket(t,s?r:!1,!0,function(t){n(null,o(t))})}"function"==typeof r&&(n=r,r=null);var s=p(t);return r&&s?w&&!m?e.encodePayloadAsBlob(t,n):e.encodePayloadAsArrayBuffer(t,n):t.length?void c(t,i,function(t,e){return n(e.join(""))}):n("0:")},e.decodePayload=function(t,r,n){if("string"!=typeof t)return e.decodePayloadAsBinary(t,r,n);"function"==typeof r&&(n=r,r=null);var o;if(""==t)return n(k,0,1);for(var i,s,a="",c=0,u=t.length;u>c;c++){var h=t.charAt(c);if(":"!=h)a+=h;else{if(""==a||a!=(i=Number(a)))return n(k,0,1);if(s=t.substr(c+1,i),a!=s.length)return n(k,0,1);if(s.length){if(o=e.decodePacket(s,r,!0),k.type==o.type&&k.data==o.data)return n(k,0,1);var p=n(o,c+i,u);if(!1===p)return}c+=i,a=""}}return""!=a?n(k,0,1):void 0},e.encodePayloadAsArrayBuffer=function(t,r){function n(t,r){e.encodePacket(t,!0,!0,function(t){return r(null,t)})}return t.length?void c(t,n,function(t,e){var n=e.reduce(function(t,e){var r;return r="string"==typeof e?e.length:e.byteLength,t+r.toString().length+r+2},0),o=new Uint8Array(n),i=0;return e.forEach(function(t){var e="string"==typeof t,r=t;if(e){for(var n=new Uint8Array(t.length),s=0;s<t.length;s++)n[s]=t.charCodeAt(s);r=n.buffer}o[i++]=e?0:1;for(var a=r.byteLength.toString(),s=0;s<a.length;s++)o[i++]=parseInt(a[s]);o[i++]=255;for(var n=new Uint8Array(r),s=0;s<n.length;s++)o[i++]=n[s]}),r(o.buffer)}):r(new ArrayBuffer(0))},e.encodePayloadAsBlob=function(t,r){function n(t,r){e.encodePacket(t,!0,!0,function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var n=new Uint8Array(t.length),o=0;o<t.length;o++)n[o]=t.charCodeAt(o);t=n.buffer,e[0]=0}for(var i=t instanceof ArrayBuffer?t.byteLength:t.size,s=i.toString(),a=new Uint8Array(s.length+1),o=0;o<s.length;o++)a[o]=parseInt(s[o]);if(a[s.length]=255,w){var c=new w([e.buffer,a.buffer,t]);r(null,c)}})}c(t,n,function(t,e){return r(new w(e))})},e.decodePayloadAsBinary=function(t,r,n){"function"==typeof r&&(n=r,r=null);for(var o=t,i=[],s=!1;o.byteLength>0;){for(var a=new Uint8Array(o),c=0===a[0],u="",h=1;255!=a[h];h++){if(u.length>310){s=!0;break}u+=a[h]}if(s)return n(k,0,1);o=f(o,2+u.length),u=parseInt(u);var p=f(o,0,u);if(c)try{p=String.fromCharCode.apply(null,new Uint8Array(p))}catch(l){var d=new Uint8Array(p);p="";for(var h=0;h<d.length;h++)p+=String.fromCharCode(d[h])}i.push(p),o=f(o,u)}var y=i.length;i.forEach(function(t,o){n(e.decodePacket(t,r,!0),o,y)})}}).call(e,function(){return this}())},function(t){t.exports=Object.keys||function(t){var e=[],r=Object.prototype.hasOwnProperty;for(var n in t)r.call(t,n)&&e.push(n);return e}},function(t,e,r){(function(e){function n(t){function r(t){if(!t)return!1;if(e.Buffer&&e.Buffer.isBuffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer||e.Blob&&t instanceof Blob||e.File&&t instanceof File)return!0;if(o(t)){for(var n=0;n<t.length;n++)if(r(t[n]))return!0}else if(t&&"object"==typeof t){t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON());for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&r(t[i]))return!0}return!1}return r(t)}var o=r(15);t.exports=n}).call(e,function(){return this}())},function(t){t.exports=function(t,e,r){var n=t.byteLength;if(e=e||0,r=r||n,t.slice)return t.slice(e,r);if(0>e&&(e+=n),0>r&&(r+=n),r>n&&(r=n),e>=n||e>=r||0===n)return new ArrayBuffer(0);for(var o=new Uint8Array(t),i=new Uint8Array(r-e),s=e,a=0;r>s;s++,a++)i[a]=o[s];return i.buffer}},function(t){function e(t,e,n){function o(t,r){if(o.count<=0)throw new Error("after called too many times");--o.count,t?(i=!0,e(t),e=n):0!==o.count||i||e(null,r)}var i=!1;return n=n||r,o.count=t,0===t?e():o}function r(){}t.exports=e},function(t,e,r){var n;(function(t,o){!function(i){function s(t){for(var e,r,n=[],o=0,i=t.length;i>o;)e=t.charCodeAt(o++),e>=55296&&56319>=e&&i>o?(r=t.charCodeAt(o++),56320==(64512&r)?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),o--)):n.push(e);return n}function a(t){for(var e,r=t.length,n=-1,o="";++n<r;)e=t[n],e>65535&&(e-=65536,o+=b(e>>>10&1023|55296),e=56320|1023&e),o+=b(e);return o}function c(t,e){return b(t>>e&63|128)}function u(t){if(0==(4294967168&t))return b(t);var e="";return 0==(4294965248&t)?e=b(t>>6&31|192):0==(4294901760&t)?(e=b(t>>12&15|224),e+=c(t,6)):0==(4292870144&t)&&(e=b(t>>18&7|240),e+=c(t,12),e+=c(t,6)),e+=b(63&t|128)}function h(t){for(var e,r=s(t),n=r.length,o=-1,i="";++o<n;)e=r[o],i+=u(e);return i}function p(){if(v>=m)throw Error("Invalid byte index");var t=255&g[v];if(v++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function f(){var t,e,r,n,o;if(v>m)throw Error("Invalid byte index");if(v==m)return!1;if(t=255&g[v],v++,0==(128&t))return t;if(192==(224&t)){var e=p();if(o=(31&t)<<6|e,o>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&t)){if(e=p(),r=p(),o=(15&t)<<12|e<<6|r,o>=2048)return o;throw Error("Invalid continuation byte")}if(240==(248&t)&&(e=p(),r=p(),n=p(),o=(15&t)<<18|e<<12|r<<6|n,o>=65536&&1114111>=o))return o;throw Error("Invalid WTF-8 detected")}function l(t){g=s(t),m=g.length,v=0;for(var e,r=[];(e=f())!==!1;)r.push(e);return a(r)}var d="object"==typeof e&&e,y=("object"==typeof t&&t&&t.exports==d&&t,"object"==typeof o&&o);(y.global===y||y.window===y)&&(i=y);var g,m,v,b=String.fromCharCode,k={version:"1.0.0",encode:h,decode:l};n=function(){return k}.call(e,r,e,t),!(void 0!==n&&(t.exports=n))}(this)}).call(e,r(12)(t),function(){return this}())},function(t,e){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(256),n=0;n<t.length;n++)r[t.charCodeAt(n)]=n;e.encode=function(e){var r,n=new Uint8Array(e),o=n.length,i="";for(r=0;o>r;r+=3)i+=t[n[r]>>2],i+=t[(3&n[r])<<4|n[r+1]>>4],i+=t[(15&n[r+1])<<2|n[r+2]>>6],i+=t[63&n[r+2]];return o%3===2?i=i.substring(0,i.length-1)+"=":o%3===1&&(i=i.substring(0,i.length-2)+"=="),i},e.decode=function(t){var e,n,o,i,s,a=.75*t.length,c=t.length,u=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var h=new ArrayBuffer(a),p=new Uint8Array(h);for(e=0;c>e;e+=4)n=r[t.charCodeAt(e)],o=r[t.charCodeAt(e+1)],i=r[t.charCodeAt(e+2)],s=r[t.charCodeAt(e+3)],p[u++]=n<<2|o>>4,p[u++]=(15&o)<<4|i>>2,p[u++]=(3&i)<<6|63&s;return h}}()},function(t,e){(function(e){function r(t){for(var e=0;e<t.length;e++){var r=t[e];if(r.buffer instanceof ArrayBuffer){var n=r.buffer;if(r.byteLength!==n.byteLength){var o=new Uint8Array(r.byteLength);o.set(new Uint8Array(n,r.byteOffset,r.byteLength)),n=o.buffer}t[e]=n}}}function n(t,e){e=e||{};var n=new i;r(t);for(var o=0;o<t.length;o++)n.append(t[o]);return e.type?n.getBlob(e.type):n.getBlob()}function o(t,e){return r(t),new Blob(t,e||{})}var i=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,s=function(){try{var t=new Blob(["hi"]);return 2===t.size}catch(e){return!1}}(),a=s&&function(){try{var t=new Blob([new Uint8Array([1,2])]);return 2===t.size}catch(e){return!1}}(),c=i&&i.prototype.append&&i.prototype.getBlob;t.exports=function(){return s?a?e.Blob:o:c?n:void 0}()}).call(e,function(){return this}())},function(t){function e(t){return t?r(t):void 0}function r(t){for(var r in e.prototype)t[r]=e.prototype[r];return t}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var n,o=0;o<r.length;o++)if(n=r[o],n===e||n.fn===e){r.splice(o,1);break}return this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks["$"+t];if(r){r=r.slice(0);for(var n=0,o=r.length;o>n;++n)r[n].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e){e.encode=function(t){var e="";for(var r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e},e.decode=function(t){for(var e={},r=t.split("&"),n=0,o=r.length;o>n;n++){var i=r[n].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}},function(t){t.exports=function(t,e){var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t){"use strict";function e(t){var e="";do e=i[t%s]+e,t=Math.floor(t/s);while(t>0);return e}function r(t){var e=0;for(u=0;u<t.length;u++)e=e*s+a[t.charAt(u)];return e}function n(){var t=e(+new Date);return t!==o?(c=0,o=t):t+"."+e(c++)}for(var o,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s=64,a={},c=0,u=0;s>u;u++)a[i[u]]=u;n.encode=e,n.decode=r,t.exports=n},function(t,e,r){(function(e){function n(){}function o(t){i.call(this,t),this.query=this.query||{},a||(e.___eio||(e.___eio=[]),a=e.___eio),this.index=a.length;var r=this;a.push(function(t){r.onData(t)}),this.query.j=this.index,e.document&&e.addEventListener&&e.addEventListener("beforeunload",function(){r.script&&(r.script.onerror=n)},!1)}var i=r(25),s=r(37);t.exports=o;var a,c=/\n/g,u=/\\n/g;s(o,i),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),i.prototype.doClose.call(this)},o.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(e,r):(document.head||document.body).appendChild(e),this.script=e;var n="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);n&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},o.prototype.doWrite=function(t,e){function r(){n(),e()}function n(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(t){o.onError("jsonp polling iframe removal error",t)}try{var e='<iframe src="javascript:0" name="'+o.iframeId+'">';i=document.createElement(e)}catch(t){i=document.createElement("iframe"),i.name=o.iframeId,i.src="javascript:0"}i.id=o.iframeId,o.form.appendChild(i),o.iframe=i}var o=this;if(!this.form){var i,s=document.createElement("form"),a=document.createElement("textarea"),h=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=h,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),n(),t=t.replace(u,"\\\n"),this.area.value=t.replace(c,"\\n");try{this.form.submit()}catch(p){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===o.iframe.readyState&&r()}:this.iframe.onload=r}}).call(e,function(){return this}())},function(t,e,r){(function(e){function n(t){var e=t&&t.forceBase64;e&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=p&&!t.forceNode,this.usingBrowserWebSocket||(l=o),i.call(this,t)}var o,i=r(26),s=r(27),a=r(36),c=r(37),u=r(38),h=r(3)("engine.io-client:websocket"),p=e.WebSocket||e.MozWebSocket;if("undefined"==typeof window)try{o=r(41)}catch(f){}var l=p;l||"undefined"!=typeof window||(l=o),t.exports=n,c(n,i),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=void 0,r={agent:this.agent,perMessageDeflate:this.perMessageDeflate};r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?new l(t):new l(t,e,r)}catch(n){return this.emit("error",n)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},n.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()
},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},n.prototype.write=function(t){function r(){n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0)}var n=this;this.writable=!1;for(var o=t.length,i=0,a=o;a>i;i++)!function(t){s.encodePacket(t,n.supportsBinary,function(i){if(!n.usingBrowserWebSocket){var s={};if(t.options&&(s.compress=t.options.compress),n.perMessageDeflate){var a="string"==typeof i?e.Buffer.byteLength(i):i.length;a<n.perMessageDeflate.threshold&&(s.compress=!1)}}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,s)}catch(c){h("websocket closed before onclose event")}--o||r()})}(t[i])},n.prototype.onClose=function(){i.prototype.onClose.call(this)},n.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",r="";this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(r=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=u()),this.supportsBinary||(t.b64=1),t=a.encode(t),t.length&&(t="?"+t);var n=-1!==this.hostname.indexOf(":");return e+"://"+(n?"["+this.hostname+"]":this.hostname)+r+this.path+t},n.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===n.prototype.name)}}).call(e,function(){return this}())},function(){},function(t){var e=[].indexOf;t.exports=function(t,r){if(e)return t.indexOf(r);for(var n=0;n<t.length;++n)if(t[n]===r)return n;return-1}},function(t,e){(function(e){var r=/^[\],:{}\s]*$/,n=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;t.exports=function(t){return"string"==typeof t&&t?(t=t.replace(s,"").replace(a,""),e.JSON&&JSON.parse?JSON.parse(t):r.test(t.replace(n,"@").replace(o,"]").replace(i,""))?new Function("return "+t)():void 0):null}}).call(e,function(){return this}())},function(t,e,r){"use strict";function n(t,e,r){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,r&&r.query&&(this.query=r.query),this.io.autoConnect&&this.open()}var o=r(7),i=r(35),s=r(45),a=r(46),c=r(47),u=r(3)("socket.io-client:socket"),h=r(29);t.exports=e=n;var p={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=i.prototype.emit;i(n.prototype),n.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[a(t,"open",c(this,"onopen")),a(t,"packet",c(this,"onpacket")),a(t,"close",c(this,"onclose"))]}},n.prototype.open=n.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},n.prototype.send=function(){var t=s(arguments);return t.unshift("message"),this.emit.apply(this,t),this},n.prototype.emit=function(t){if(p.hasOwnProperty(t))return f.apply(this,arguments),this;var e=s(arguments),r=o.EVENT;h(e)&&(r=o.BINARY_EVENT);var n={type:r,data:e};return n.options={},n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),delete this.flags,this},n.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},n.prototype.onopen=function(){u("transport is open - connecting"),"/"!==this.nsp&&this.packet(this.query?{type:o.CONNECT,query:this.query}:{type:o.CONNECT})},n.prototype.onclose=function(t){u("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},n.prototype.onpacket=function(t){if(t.nsp===this.nsp)switch(t.type){case o.CONNECT:this.onconnect();break;case o.EVENT:this.onevent(t);break;case o.BINARY_EVENT:this.onevent(t);break;case o.ACK:this.onack(t);break;case o.BINARY_ACK:this.onack(t);break;case o.DISCONNECT:this.ondisconnect();break;case o.ERROR:this.emit("error",t.data)}},n.prototype.onevent=function(t){var e=t.data||[];u("emitting event %j",e),null!=t.id&&(u("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?f.apply(this,e):this.receiveBuffer.push(e)},n.prototype.ack=function(t){var e=this,r=!1;return function(){if(!r){r=!0;var n=s(arguments);u("sending ack %j",n);var i=h(n)?o.BINARY_ACK:o.ACK;e.packet({type:i,id:t,data:n})}}},n.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(u("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):u("bad ack %s",t.id)},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},n.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)f.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},n.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},n.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:o.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},n.prototype.compress=function(t){return this.flags=this.flags||{},this.flags.compress=t,this}},function(t){function e(t,e){var r=[];e=e||0;for(var n=e||0;n<t.length;n++)r[n-e]=t[n];return r}t.exports=e},function(t){"use strict";function e(t,e,r){return t.on(e,r),{destroy:function(){t.removeListener(e,r)}}}t.exports=e},function(t){var e=[].slice;t.exports=function(t,r){if("string"==typeof r&&(r=t[r]),"function"!=typeof r)throw new Error("bind() requires a function");var n=e.call(arguments,2);return function(){return r.apply(t,n.concat(e.call(arguments)))}}},function(t){function e(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=e,e.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-r:t+r}return 0|Math.min(t,this.max)},e.prototype.reset=function(){this.attempts=0},e.prototype.setMin=function(t){this.ms=t},e.prototype.setMax=function(t){this.max=t},e.prototype.setJitter=function(t){this.jitter=t}}])})});
define("lego_modules/impush-client/1.0.3/index",function(e,o,t){"use strict";function n(e,o){return function(){var t=this,n=arguments;setTimeout(function(){o[e].apply(t,n)},0)}}function r(e,o,t,n){u[o]?u[o][n]=t:(u[o]={},u[o][n]=t,e.on(o,function(e){u[o][e.seq](e),delete u[o][e.seq]}))}function i(e,o){function t(o){p.emit("pulse",{cmd:"AttendHeartbeat",app_id:i.appId,mod_id:i.modId,data:{term_id:+e,action:o,platform:3}})}if(!e||"string"!=typeof e&&"number"!=typeof e)throw new Error("roomId is required and must be a string or a number");if("object"!==("undefined"==typeof o?"undefined":d(o)))throw new Error("option is required and must be a object");if(!o.appId||"string"!=typeof o.appId)throw new Error("option.appId is required and must be a string");if(!o.modId||"string"!=typeof o.modId)throw new Error("option.modId is required and must be a string");e=+e;var i=this;if(i.appId=o.appId,i.modId=o.modId,i._pulsePointer=null,c[e])return c[e];var a={};a.fetch=n("fetch",a),a.sendMessage=n("sendMessage",a),a.pulse=n("pulse",a),c[e]=a;var u={path:"/impush/socket.io"};window.WebSocket&&(u.transports=["websocket","polling"]);var p=null,m="/?roomId="+e+"&appId="+i.appId;return p=s(m,u),a.config=function(e){e&&(e.appId&&(i.appId=e.appId),e.modId&&(i.modId=e.modId))},a.on=function(e,o){if("string"!=typeof e)throw new Error("event is required and must be a string");if(!(o instanceof Function))throw new Error("callback is required and must be a function");p.on(e,o)},a.off=function(e,o){if("string"!=typeof e)throw new Error("event is required and must be a string");if(!(o instanceof Function))throw new Error("callback is required and must be a function");var t="evt-"+e;p.off(t,o)},p.on("connect",function(){console.log("socket connect ok"),"function"==typeof o.succ&&o.succ(),a.pulse=t,a.fetch=function(e,o){var t="",n={};if("string"==typeof e)t=e;else{if("object"!==("undefined"==typeof e?"undefined":d(e)))throw new Error('The "fetch" function requires a url string or an option object as argument');if(!e.url||"string"!=typeof e.url)throw new Error("url is required and must be a string");t=e.url,n.data=e.data||{}}console.log("fetch cgi: "+t),n.app_id=e.appId||i.appId,n.mod_id=e.modId||i.modId,n.seq=f++,n.cmd=t,r(p,"cgi",o,n.seq),p.emit("cgi",n)},a.sendMessage=function(e,o){var t={};if("string"==typeof e||"number"==typeof e)t.data=e;else{if("object"!==("undefined"==typeof e?"undefined":d(e)))throw new Error('The "sendMessage" function requires a msg or an option object as argument');t.data=e.data||""}console.log("sendMessage"),t.cmd="webclassChat",t.app_id=e.appId||i.appId,t.mod_id=e.modId||i.modId,t.seq=f++,o&&r(p,"message",o,t.seq),p.emit("message",t)}}),p.on("error",function(){"function"==typeof o.err&&o.err(),delete c[e]}),window.socket=p,a}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=e("lego_modules/socket.io-client/1.7.2/dist/socket.io"),a={connect:i},u={},f=0,c={};t.exports=a});
define("pages/index/push/main",function(t,n,e){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function o(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}function r(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}var u=t("lego_modules/imweb-base-qjs/0.1.1/src/controller"),c=s(u),a=t("lego_modules/impush-client/1.0.3/index"),d=s(a),_=t("pages/index/report.index"),p="tencentedu",m="webclass",h=$.bom.getHash("term_id"),l=function(t){function n(){i(this,n);var e=o(this,t.call(this));return e.components={keSign:"#ke-sign",keExamcard:"#ke-examcard"},e}return r(n,t),n.prototype._bindEvent=function(){var t=this,n=this.model;n.$on("sign.sent-sign",function(){t.sentSign()}),n.$on("examcard.sent-answer",function(n){t.sentAnswer(n)})},n.prototype.handleExamCard=function(t){if(t)if(1===t.uint32_sub_cmd){var n=t.msg_subcmd0x1_startanswer||{},e=n.uint32_answer_time||30,s=n.uint32_options_count||3,i=n.uint32_option_style||1,o=n.uint32_seq||0;this.keExamcard.showExamCard({seconds:e,choicesNum:s,examType:i,seq:o})}else 2===t.uint32_sub_cmd&&this.keExamcard.showStop()},n.prototype.handleSign=function(t){if(t){var n=t.msg_subcmd0x1_startsign||{},e=n.uint32_lastseconds||30;this.keSign.showSign(e)}},n.prototype.onPush=function(){var t=this;this.PushClient&&this.PushClient.on("push",function(n){if(n.app_id!==p&&n.mod_id!==m&&n.room_id!==h)return void console.log("other msg",n);var e=n.data.body;1===e.uint32_sub_cmd?t.handleExamCard(e.msg_subcmd0x1_answersheet):2===e.uint32_sub_cmd&&t.handleSign(e.msg_subcmd0x2_signsheet)})},n.prototype.sentSign=function(){this.PushClient.fetch({url:"webclassOpt",data:{uint32_sub_cmd:2,msg_subcmd0x2_req_sign:{uint32_sub_cmd:2,msg_subcmd0x2_req_sign:{uint32_tid:parseInt(h)}}}},function(){console.log("sign response")})},n.prototype.sentAnswer=function(t){var n=t.list,e=t.seq;this.PushClient.fetch({url:"webclassOpt",data:{uint32_sub_cmd:1,msg_subcmd0x1_req_answersheet:{uint32_sub_cmd:3,msg_subcmd0x3_req_studentanswer:{uint32_course_id:parseInt(h),uint32_seq:e,rpt_uint32_answers:n}}}},function(){console.log("examcard response")})},n.prototype.connect=function(){if(h){_.reportMonitor("impush连接次数",2632622);var t=0;this.PushClient=d["default"].connect(h,{appId:p,modId:m,succ:function(){0===t?_.reportMonitor("impush连接成功",2632623):_.reportMonitor("impush重连成功",2635732)},err:function(){0===t&&_.reportMonitor("impush连接失败",2632644),t++}}),this.onPush()}},n.prototype.init=function(t){this._init(t),this.connect()},n}(c["default"]),f=new l;e.exports={data:{},filters:{},directives:{},methods:{},ready:function(){f.init(this)}}});
define("pages/index/sign/main",function(t,n,s){"use strict";function e(t){return t&&t.__esModule?t:{"default":t}}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function o(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}function c(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}function u(t,n){f({action:t,obj1:n,ver1:a})}var h=t("lego_modules/imweb-base-qjs/0.1.1/src/controller"),r=e(h),l=t("modules/lib/report.tdw").tdw,f=function(t){return l($.extend(t,{module:"WebClass"}))},a=$.bom.getHash("course_id"),w=function(t){function n(){i(this,n);var s=o(this,t.call(this));return s.components={countDown:"#sign-countdown"},s}return c(n,t),n.prototype._bindEvent=function(){var t=this,n=this.model;n.$on("sign.end-count-down",function(){t.countDown.stop()}),n.$on("countdownbar.end",function(){n.hide()})},n.prototype.init=function(t){this._init(t)},n}(r["default"]),d=new w;s.exports={data:{isShow:!1,isShowCloseBtn:!0,title:"",cancelText:"",isShowCancelBtn:!1,isSuccess:!1},filters:{},directives:{},methods:{closeWindow:function(){this.isSuccess?u("click","signin_succ_close"):(this.$emit("sign.sent-sign"),this.countDown.stop(),u("click","signin_close")),this.hide()},"!":function(t){return!t},show:function(){this.$set("isShow",!0)},hide:function(){this.$set("isShow",!1)},confirmBtnClick:function(){this.isSuccess?(this.hide(),u("click","signin_succ_yes")):(this.$emit("sign.sent-sign"),this.showSuccess(),this.countDown.stop(),u("click","signin_yes"))},showSign:function(t){this.$set("isSuccess",!1),this.$set("title","请在倒计时结束前，完成课堂签到"),this.$set("cancelText","签到"),this.showCancelBtn(),this.countDown.start(t||30),this.show(),u("exposure","signin")},showSuccess:function(){this.$set("isSuccess",!0),this.$set("title","签到成功"),this.$set("cancelText","确认"),this.showCancelBtn(),this.show()},showCloseBtn:function(){this.$set("isShowCloseBtn",!0)},hideCloseBtn:function(){this.$set("isShowCloseBtn",!1)},showCancelBtn:function(){this.$set("isShowCancelBtn",!0)},hideCancelBtn:function(){this.$set("isShowCancelBtn",!1)}},ready:function(){d.init(this),this.countDown=d.countDown}}});
define("components/mask/main",function(i,t,e){"use strict";e.exports={data:{isShow:!0},filters:{},directives:{},methods:{hide:function(){this.$set("isShow",!1)}},ready:function(){}}});
define("components/countdownbar/main",function(t,s,n){"use strict";function e(t){var s=10>t?"0":"";return s+t}function i(t){var s=parseInt(t/60),t=t%60;return e(s)+":"+e(t)}n.exports={data:{isShow:!0,seconds:0,totalSeconds:1,timer:null},filters:{getTextTime:function(t){return i(t)}},directives:{"set-width":function(t){var s=$(this.el);s.css("width",Math.min(t/this.vm.totalSeconds*100,100)+"%")}},methods:{show:function(){this.$set("isShow",!0)},hide:function(){this.$set("isShow",!1)},start:function(t){this.show(),this.$emit("countdownbar.start");var s=this;this.$set("seconds",t),this.$set("totalSeconds",t),this.timer=setInterval(function(){var t=s.seconds;0>=t?s.stop(!0):s.$set("seconds",s.seconds-1)},1e3)},stop:function(t){this.$set("seconds",0),clearInterval(this.timer),t&&this.$emit("countdownbar.end")}},ready:function(){}}});
define("pages/index/examcard/main",function(t,e,n){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t){for(var e=[],n="ABCDEFGHIJKLMN",s=0;t>s;s++)e.push({text:n[s],isChosen:!1});return e}function h(t,e){f({action:t,obj1:e,ver1:m})}var a=t("lego_modules/imweb-base-qjs/0.1.1/src/controller"),u=s(a),l=t("modules/lib/report.tdw").tdw,f=function(t){return l($.extend(t,{module:"WebClass"}))},w=function(t){function e(){o(this,e);var n=i(this,t.call(this));return n.components={countDown:"#examcard-countdown"},n}return c(e,t),e.prototype._bindEvent=function(){var t=this,e=this.model;e.$on("sign.end-count-down",function(){t.countDown.stop()}),e.$on("countdownbar.end",function(){e.showStop()})},e.prototype.init=function(t){this._init(t)},e}(u["default"]),d=new w,p=null,m=$.bom.getHash("course_id");n.exports={data:{isShow:!1,isShowCloseBtn:!1,isShowCancelBtn:!0,cancelText:"确定",content:"",examType:"multi",state:"doing",seq:0,choices:[{isChosen:!1,text:"A"},{isChosen:!1,text:"B"},{isChosen:!1,text:"C"}]},filters:{getHead:function(t){var e={single:"单选题",multi:"多选题"};return e[t]||"选择题"},getIsResult:function(t){return"result"===t},getChoiceGroupIsShow:function(t){return"doing"===t||"result"===t},getDisabled:function(t){var e=!0;return t.forEach(function(t){t.isChosen&&(e=!1)}),e},isDoing:function(t){return"doing"===t}},directives:{},methods:{closeWindow:function(){this.hide(),clearInterval(p)},"!":function(t){return!t},show:function(){this.$set("isShow",!0)},hide:function(){this.$set("isShow",!1)},showExamCard:function(t){var e=t.choicesNum,n=t.examType,s=t.seconds,o=t.seq;clearInterval(p),this.$set("title",""),this.$set("content",""),this.$set("isShowCancelBtn",!0),this.$set("isShowCloseBtn",!1),this.$set("state","doing"),this.$set("seq",o),this.$set("choices",r(e)),this.$set("examType",1===n?"single":"multi"),this.show(),this.countDown.start(s||90),h("expo","answersheet")},confirmBtnClick:function(t){if(!$(t.target).hasClass("btn-disabled")){var e=[];this.choices.forEach(function(t,n){t.isChosen&&e.push(n)}),this.$emit("examcard.sent-answer",{list:e,seq:this.seq}),h("click","answersheet_submmit"),this.showResult()}},showResult:function(){this.countDown.stop(),clearInterval(p),this.$set("title","你的答案："),this.$set("content",""),this.$set("isShowCancelBtn",!1),this.$set("isShowCloseBtn",!0),this.$set("state","result"),h("expo","answersheet_answer")},showStop:function(){var t=this;if(this.isShow){this.countDown.stop(),this.show(),this.$set("state","stop"),this.$set("title","答题已结束"),this.$set("isShowCancelBtn",!1),this.$set("isShowCloseBtn",!0);var e=5;clearInterval(p),t.$set("content",e+"秒后关闭窗口"),p=setInterval(function(){0===e?t.hide():(e--,t.$set("content",e+"秒后关闭窗口"))},1e3),h("expo","answersheet_finish")}},clickChoice:function(t){"doing"===this.state&&("single"===this.examType&&this.choices.forEach(function(t){t.$set("isChosen",!1)}),t.$set("isChosen",!t.isChosen))}},ready:function(){d.init(this),this.countDown=d.countDown;var t=this,e=$(t.$el).find(".xq_container");e.find(".dialog-head").drag(e,{opacity:1}),$(window).on("resize",function(){var t=e.offset();if(t){var n=e.offset().left,s=e.offset().top;n-$(window).width()>10&&e.css("left",$(window).width()-100),s-$(window).height()>10&&e.css("top",$(window).height()-100)}})}}});
define("pages/index/pagelive/main",function(e,t,i){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=e("lego_modules/imweb-base-qjs/0.1.1/src/controller"),h=o(a),c=e("pages/index/db.index"),l=e("lego_modules/observer/0.0.1/observer"),f=e("modules/lib/login"),u=function(e){function t(){n(this,t);var i=s(this,e.call(this));return i.isRtmp=!1,i.components={keChat:"#ke-chat",kePlayer:"#ke-player",keTcPlayer:"#ke-tcplayer",kePush:"#ke-push"},i}return r(t,e),t.prototype.init=function(e){this._init(e)},t.prototype.setChat=function(){var e=this,t=this.keChat;if(t.hide(),t.setLiveType(e.isRtmp),this.checkIsShowNotPay())this.kePlayer.hide(),this.keTcPlayer.hide();else{if(this.updateChatInfo(),!this._isInitChat){this._isInitChat=!0,t.setCourseInfo(this.courseInfo),t.setTermInfo(this.term),t.setTaskInfo(this.taskInfo),t.init(),t.$off("notice.toggle").$on("notice.toggle",function(){e._setStyle()}),t.$on("login.logout",function(){t.hide()});var i=!1;$(window).resize(function(){i!==!1&&clearTimeout(i),i=setTimeout(e._setStyle.bind(e),10)})}this.keChat.show(),this._setStyle()}},t.prototype._setStyle=function(){if(this.keChat.setHeight){var e=$("#player-container"),t=e.height(),i=e.width();this.keChat.setHeight(t),this.setPlayerSize(i,t);var o=this.keChat.isShow?i-this.keChat.getWidth():i;this.keCover.setPlayerStyle({height:t+"px",width:o+"px"})}},t.prototype.setPlayerSize=function(e,t){var i=this;i.isRtmp?i.keTcPlayer.setPlayerSize({height:t,width:e-i.keChat.getWidth()}):i.kePlayer.setPlayerStyle({height:t+"px",width:e-i.keChat.getWidth()+"px"})},t.prototype.setAttendTime=function(e){var t=this;t.isRtmp?t.keTcPlayer.setAttendTime(e):t.kePlayer.setAttendTime(e)},t.prototype._bindEvent=function(){var e=this;e.keChat.$on("noticeToggle",function(){e._setStyle()}).$on("chat.attendClass",function(t){e.$parent.setCover(!1),e.updateChatInfo(),1===t?e.getAttend().done(function(t){e.setAttendTime(t.attendts)}):(e.keTcPlayer.hide(),e.setAttendTime(0))}).$on("chat.enterRoom",function(t,i){t?e.enterRoomSucc(i):e.keChat.$emit("enterRoomFail",i)}).$on("chat.attendRoom",function(){console.log("chat.attendRoom"),e.$parent.setCover(),e.updateChatInfo()}),l.get("onlineFlash").listen("changeStatus",function(t){1===t?e.kePlayer.showPauseDialog():e.kePlayer.hidePauseDialog()}),this.kePlayer.$on("flash.log",function(t){618===t.code&&e.keCover.hide()})},t.prototype.updateChatInfo=function(){var e=this;e.taskInfo&&1===e.taskInfo.type&&c.getLiveInfo({course_id:e.courseId,term_id:e.termId}).done(function(t){e.getLiveInfoSucc(t)}).fail(function(){e._fail(5)})},t.prototype.getAttend=function(){return c.getAttend({term_id:this.termId})},t.prototype.isEndClass=function(){var e=this,t=e.keCover,i=t.liveInfo,o=t.taskInfo;return i&&o.endTime<i.serverTime&&1!==i.offlineStatus&&i.leaveTime},t.prototype.enterRoomSucc=function(e){var t=this;!t.isRtmp&&!t.isEndClass()&&function(){t.reportIndex.beforeSetFlashvars(),t.kePlayer.setTcpListVars("tcp_list="+e.tcpList.join(",")+"&key="+e.key+"&uid="+f.uin())}(),t.getAttend().done(function(e){t.setAttendTime(e.attendts)}).fail(function(){t.keChat.$emit("getAttend.fail")})},t.prototype.showPlayer=function(){var e=this;e.isRtmp?(e.kePlayer.hide(),e.keTcPlayer.show()):(e.keTcPlayer.hide(),e.kePlayer.show())},t.prototype.getLiveInfoSucc=function(e){!this.isRtmp&&this.kePlayer.$emit("flash.web2liveTime"),this.keCover.setLiveInfo(e),1===e.offlineStatus?(window._T[6]=window._T[5]?new Date-+window._T[5]:0,window._Tlive=(new Date).getTime(),this.keCover.hide(),this.showPlayer()):(window._T[5]=(new Date).getTime(),this.keCover.show(),!this.isRtmp&&this.kePlayer.$emit("flash.offlineStatus",e.offlineStatus)),this.$parent.keLoading.hide()},t.prototype._fail=function(){},t}(h["default"]),d=new u;i.exports={data:{isShow:!1},filters:{},directives:{},methods:{show:function(e,t){var i=this;i.isShow&&d.isRtmp==t||(i.$set("isShow",!0),d.term=e.term,d.taskInfo=e.taskInfo,d.courseInfo=e.courseInfo,d.courseId=e.courseId,d.termId=e.termId,d.reportIndex=e.reportIndex,d.reportEduLog=e.reportEduLog,d.checkIsShowNotPay=e.checkIsShowNotPay,d.keCover=e.keCover,d.$parent=e,d.isRtmp=t,d.kePlayer.setPrice(e.term.price),d.setChat())},hide:function(){this.$set("isShow",!1)},hidePlayer:function(){this.kePlayer.hide(),this.keTcPlayer.hide()},isPlayerShow:function(){return this.keTcPlayer.isShow||this.kePlayer.isShow}},ready:function(){d.init(this),this.keChat=d.keChat,this.kePlayer=d.kePlayer,this.keTcPlayer=d.keTcPlayer}}});
define("pages/index/cover/main",function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=t("lego_modules/imweb-base-qjs/0.1.1/src/controller"),a=s(h),c=t("jquery"),u=t("modules/lib/util"),l=function(t){function e(){return o(this,e),n(this,t.apply(this,arguments))}return r(e,t),e.prototype.init=function(t){this._init(t)},e.prototype.isNotOnTime=function(){var t=this.model.liveInfo,e=this.model.taskInfo;return t&&e.startTime&&e.startTime<t.serverTime&&4===t.offlineStatus&&!t.leaveTime},e.prototype.isFinishClass=function(){var t=this.model.liveInfo,e=this.model.taskInfo;return t&&2===t.offlineStatus&&t.leaveTime&&t.serverTime<e.endTime},e.prototype.isEndClass=function(){var t=this.model.liveInfo,e=this.model.taskInfo;return t&&e.endTime<t.serverTime&&1!==t.offlineStatus&&t.leaveTime},e.prototype.checkCourseTime=function(){var t=this.model.taskInfo.startTime-this.model.liveInfo.serverTime;this.countTime(t)},e.prototype.countTime=function(t){var e=Math.floor(t/864e5),i=Math.floor((t-864e5*e)/36e5),s=Math.floor((t-36e5*i-864e5*e)/6e4);this.model.setTime(e,i,s)},e.prototype.getCoverClass=function(){return this.isFinishClass()?"finish-class":this.isEndClass()?"end-class":this.isNotOnTime()?"not-ontime":void 0},e.prototype.getCoverClassTips=function(){return this.isFinishClass()?"老师已经下课了！":this.isEndClass()?"该直播任务已结束！":this.isNotOnTime()?"老师未能按时上课！":void 0},e}(a["default"]),f=new l;i.exports={data:{isShow:!1,isShowTime:!1,day:0,hour:0,min:0,name:"",liveInfo:{},taskInfo:{},price:0,notPay:!1,forbidden:!1,showNext:!1,showCoverClass:!1,showNextDom:c(""),coverClass:"",coverClassTips:"",playerStyle:{width:"0px",height:"0px"},timeCountDown:5,signCountDown:!0,taidCountDown:"",signNoJump:!1,countDownPointer:null,liveInfoPointer:null,QIE8Bug:!0,QIE8BugCountDown:-1},filters:{name:function(t){return"《"+t.replace(/^《*|》*$/g,"")+"》"},price:function(t){return"￥"+(t/100).toFixed(2)},payHref:function(t){return"//ke.qq.com/cgi-bin/courseDetail?course_id="+t},getQRCodeClass:function(t){return"not-ontime"===t?"first":t?"second":void 0},getQRCodeText:function(t){switch(t){case"not-ontime":return"老师迟到了？先体验一把手机上课！";case"finish-class":return"错过了课程？扫码下载App看课程回放";case"end-class":return"意犹未尽想复习？扫码下载App看课程回放"}},isShowLiveCover:function(t){return this.showCoverClass&&!t&&!this.showNext&&!this.notPay},hasNextTask:function(){var t=this.getNextDom();return t&&t.length>0},payedShowNext:function(t){return t&&!this.notPay},getNextName:function(){var t="下节任务："+c(this.getNextDom()).text();return t},countDown:function(){var t=this;if(!t.showNext)return"";t.signCountDown&&t.$set("signCountDown",!1);var e,i=t.timeCountDown-1;return i>=0?e=setTimeout(function(){t.$set("timeCountDown",i)},1e3):(t.$set("signCountDown",!0),t.gotoNextTask&&t.gotoNextTask()),t.$set("countDownPointer",e),t.timeCountDown},setPayTipsHtml:function(){return 1===this.taskInfo.type&&f.isEndClass()?"该课程已结束":"请付费后学习完整内容"},getCourseDetailUrl:function(){var t=u.getUrlParam("term_id"),e=u.getUrlParam("course_id");return"/course/"+e+"#term_id="+t}},directives:{},methods:{show:function(){var t=this;t.$set("isShow",!0)},hide:function(){this.$set("isShow",!1),clearInterval(this.liveInfoPointer)},setPlayerStyle:function(t){this.$set("playerStyle",t),c("#ke-cover").css({width:t.width,height:t.height})},setName:function(t){this.$set("name",t)},setTime:function(t,e,i){t&&(i=0),this.$set({day:t,hour:e,min:i})},setLiveInfo:function(t){this.$set("liveInfo",t),f.checkCourseTime()},setPrice:function(t){this.$set("price",t)},setCourseId:function(t){this.$set("courseId",t)},checkShowTime:function(){this.$set("isShowTime",this.day>=0&&this.hour>=0&&this.min>=0),this.$set("showNext",!1)},setNotPay:function(t){t&&(this.$set("isShowTime",!1),this.$set("showNext",!1)),this.$set("notPay",t),t&&this.$emit("cover.getChatInfo")},setForbidden:function(t,e){t&&(this.$set("isShowTime",!1),this.$set("showNext",!1)),e!==!1&&this.show(),this.$set("forbidden",t)},setShowNext:function(t){this.show(),this.$set("showNext",t),t&&5!==this.timeCountDown&&this.$set("timeCountDown",5),t?this.$set("isShowTime",!1):(this.$set("isShowTime",!this.isShowTime),this.$set("isShowTime",!this.isShowTime))},setTaskInfo:function(t){this.$set("taskInfo",t)},getNextDom:function(){var t=c("#play-list").find(".js-course-list-header"),e=!1,i=[];return c(t).each(function(t,s){var o;return c(s).hasClass("js-active")?(e=!0,!0):e?(o=~~c(s).attr("tasktype"),o?(i=c(s),!1):void 0):!0}),i},gotoNextTask:function(){clearTimeout(this.countDownPointer),this.$set("signCountDown",!0);var t=this.getNextDom();if(t&&t.next){this.hide(),t.triggerHandler&&t.triggerHandler("click");var e=t.next();e&&e.length>0&&"span"===e[0].tagName.toLowerCase()&&(t=e.find("span").eq(0),t&&t.triggerHandler&&t.triggerHandler("click"))}},doReplay:function(){clearTimeout(this.countDownPointer),this.$set("signCountDown",!0),this.$emit("doReplay")},onlineContract:function(){this.$emit("cover.onlineContract")},payButtonClick:function(){this.$emit("cover.payButtonClick")}},ready:function(){var t=this;f.init(this),this.$watch("day",t.checkShowTime).$watch("hour",t.checkShowTime).$watch("min",t.checkShowTime).$watch("price",function(e){e&&t.$set({isShow:!0,isShowTime:!1})}).$watch("liveInfo",function(){t.$set("coverClass",f.getCoverClass()),t.$set("coverClassTips",f.getCoverClassTips()),t.$set("showCoverClass",!!t.coverClassTips),t.$set("isShowTime",!t.isShowTime),t.$set("isShowTime",!t.isShowTime)}).$watch("taskInfo",function(){t.$set("coverClass",f.getCoverClass()),t.$set("coverClassTips",f.getCoverClassTips()),t.$set("showCoverClass",!!t.coverClassTips),t.$set("isShowTime",!t.isShowTime),t.$set("isShowTime",!t.isShowTime)})}}});
define("components/loading/main",function(i,t,s){"use strict";s.exports={data:{isShow:!0},filters:{},directives:{},methods:{show:function(){this.$set("isShow",!0)},hide:function(){this.$set("isShow",!1)}},ready:function(){}}});
define("pages/index/vplayer/config",function(e,a,s){"use strict";s.exports={width:1060,height:596,autoplay:!0,flashWmode:"opaque",playerType:"html5hd",showHTML5Switch:!0,removePluginsList:["UiFavorite"],businessId:"201",authfrom:"260001",flashvar:{pay:1,showend:0,searchbar:0,searchpanel:0,playertype:11,follow:0}}});
define("pages/index/vplayer/db.vplayer",function(e,r,t){"use strict";var d=e("modules/lib/db");t.exports={report_study_record:d.httpMethod({url:"/cgi-bin/user/report_study_record",type:"POST"})}});
define("pages/index/vplayer/report",function(e,r,t){"use strict";var o=e("jquery"),i=e("modules/lib/report.tdw").tdw;e("lego_modules/report.cookie/0.0.2/report.cookie");var n,d=e("pages/index/vplayer/db.vplayer"),a=e("modules/lib/login"),u=e("lego_modules/observer/0.0.1/observer"),c=o(document);u.get("login").listen("statusChanged",function(e){n=e});var s=5,l=30,v={},_=null,p=function(e){return i(o.extend(e,{module:"Play"}))},g=function(){return parseInt(Date.now()/1e3,10)},f=g(),m=function(){var e=g()-f,r=0;try{r=parseInt(_.getCurrentTime(),10)}catch(t){}e>0&&r>0&&a.isLogin()&&n&&n.logined&&d.report_study_record({data:{flag:0,vid:v.vid,taid:v.taid,duration:e,watch_pos:r,term_id:v.term_id,source:v.source||0,course_id:v.course_id,href:location.href},success:function(e){console.log("success",e)},error:function(e){console.log("error",e)}}),e>0&&r>0&&p({action:"report_study_record",obj1:location.href,ver1:v.course_id,ver2:v.term_id,ver9:v.taid}),p({action:"time_duration",obj1:v.agency_type,ver1:v.course_id,ver2:v.term_id,ver9:v.taid,ver3:Math.round(e),ver7:v.needSign?a.isLogin()?"0":"2":"1"}),f+=e,c.trigger("vplayer.play_data",{vid:v.vid,taid:v.taid,duration:e,watch_pos:r,term_id:v.term_id})},y=0,h=function x(e){y=setTimeout(function(){m(),x(l)},1e3*e)},b=function(){clearTimeout(y),m()},w=function(e,r){_=e||_,v=r||v||{},b(),h(s),f=g()};t.exports={start:w,stop:b}});
define("modules/lib/base32",function(t,u,n){function e(){var t=0,u=0;this.output="",this.readByte=function(n){return"string"==typeof n&&(n=n.charCodeAt(0)),0>t?u|=n>>-t:u=n<<t&248,t>3?(t-=8,1):(4>t&&(this.output+=r[u>>3],t+=5),0)},this.finish=function(n){var e=this.output+(0>t?r[u>>3]:"")+(n?"$":"");return this.output="",e}}function i(t){var u=new e,n=u.update(t,!0);return n}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";e.prototype.update=function(t,u){for(var n=0;n<t.length;)n+=this.readByte(t[n]);var e=this.output;return this.output="",u&&(e+=this.finish()),e};var o={Encoder:e,encode:i};n.exports=o});
define("pages/index/vplayer/marquee",function(t,i,e){"use strict";function o(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var n=t("jquery"),s=function(){function t(){o(this,t),this.top=0,this.left=0,this.speed=0,this.timer=null,this.$dom=null,this.width=0,this.height=20}return t.prototype.hide=function(){this.$dom&&this.$dom.hide(),this.stop()},t.prototype.show=function(t,i){this.speed=i||.7,this.$dom=n(".vplayer_marquee"),this.$dom.text(t),this.width=this.$dom.width(),this.rendomStartPoint(),this.start()},t.prototype.start=function(){var t=this,i=function(){t.render(),t.start()};this.timer=window.requestAnimationFrame?window.requestAnimationFrame(i):setTimeout(i,20)},t.prototype.stop=function(){window.cancelAnimationFrame?window.cancelAnimationFrame(this.timer):clearTimeout(this.timer)},t.prototype.rendomStartPoint=function(){var t=60,i=50,e=n(window).width(),o=n(window).height(),s=o-t-i-this.height;this.left=e,this.top=Math.floor(Math.random()*s)},t.prototype.render=function(){this.left-=this.speed,this.$dom&&this.$dom.css({left:this.left,top:this.top}),this.left+this.width<0&&this.rendomStartPoint()},t}();e.exports=new s});
define("pages/index/vplayer/main",function(e,i,t){"use strict";function r(e){e.player&&e.player.getCurrentTime?(void 0===l&&(l=e.player.getCurrentTime()),clearTimeout($),$=setTimeout(function(){e.player&&l!==e.player.getCurrentTime()?(l=void 0,e.$emit("vplayer.resumed")):r(e)},200)):e.$emit("vplayer.resumed")}function a(){0===n(".ke_overlay_loading").length&&(n(".txp_player").append('<div class="ke_overlay_loading"><div class="ke_overlay_content"><div class="ke_loading"></div><div class="txp_support">技术支持： <i class="txp_logo"></i> 腾讯视频</div></div></div>'),T=n(".ke_overlay_loading"))}var n=e("jquery"),o=e("modules/lib/util"),s=e("modules/lib/report.tdw").tdw;e("lego_modules/report.cookie/0.0.2/report.cookie");var l,d=e("pages/index/vplayer/config"),y=e("pages/index/vplayer/report"),u=e("lego_modules/local.data/0.0.1/local.data"),p=e("lego_modules/observer/0.0.1/observer"),c=(e("badjs"),e("modules/lib/base32")),h=e("pages/index/report.index"),v=e("pages/index/vplayer/marquee"),g=e("modules/lib/login"),f=h.reportMonitor,m=h.monitor,_=o.getHash("course_id")||o.query("course_id"),w=0,k={},T=null,x=function(e){return s(n.extend(e,{module:"Play",ver1:_,obj1:""+w}))},b=function(e){return function(){var i=window.require.attrs;window.require.attrs={};var t=e.apply(this,arguments);return window.require.attrs=i,t}},P=b(function(i,t){t=t||function(){},e.loadJs(i,t)}),$=null,L=new Image;L.src="//8.url.cn/edu/webcourse/loading-font_e5db9da.gif",t.exports={data:{isShow:!1,playType:null,isTryListen:!1},filters:{},directives:{},methods:{config:function(){var e=this;return n.extend(!0,d,e.size())},eduext:function(){var e=["uid_uin","uid_a2","uid_type","_guest_type","uuid","uin","luin","skey","lskey","pSkey","p_skey","p_uin","uid_appid"],i=function(){var i=document.cookie,t=new RegExp("(^| )("+e.join("|")+")=([^;]*)(;|$)","g"),r=i.match(t)||[];return n.trim(r.join(""))},t={course_id:parseInt(this.course_id,10),term_id:parseInt(this.term_id,10),type:2,action:0,cookie:i()},r=c.encode(JSON.stringify(t));return r},videoTryListen:function(e,i,t,r){var a=this,o=!1,s=0;n(r).each(function(t,r){r.taid!==i||r.vid!==e||1!==r.tryListenType&&2!==r.tryListenType||(o=!0,s=r.tryListenTime)}),a.$el.innerHTML+='<p class="xd_video-try-tips">可试看5分钟，<span class="xd_nor-link">购买课程</span>后看完整版</p>'},isTryListenFunc:function(e,i,t,r){var a=!1;return n(r).each(function(t,r){r.taid!==i||r.vid!==e||1!==r.tryListenType&&2!==r.tryListenType||(a=!0)}),a},getPrice:function(e){var i=0;return n(e.terms).each(function(e,t){i=t.price}),i},play:function(e,i,t,r,a){var s=[];a=a._up||{},this.$set("playType",t),this.$set("isTryListen",this.isTryListenFunc(e,i,t,r,a)),a.length&&n.each(a._keys,function(e,i){i=a[i],i&&5===i.type&&i.vid&&s.push(i.vid)});var l=this;l.playing=!0,w=2===(r||{}).agencytype?1:0;var d=function(){var a=l.config();l.$el.innerHTML='<div id="'+(a.containerId="vplayer_"+e)+'"></div><div class="vplayer_marquee"></div>',l.getPrice(r)>0?v.show(n.cookie.uin()+"正在观看视频"):v.hide(),a.vid=e,a.authext=l.eduext(),a.flashvar=a.flashvar||{},a.flashvar.eduext=a.authext,a.flashvar.loadingswf="http://vm.gtimg.cn/minivideo_v1/vd/res/skins/ke_loading.swf",l.history_key=["vplayer","history",n.cookie.uin(),e,i,t].join("_");var d=parseInt(u.get(l.history_key),10);d>0&&(a.connectionPlayTime=d),l.txplayerPlay(a);var p=o.getHash("taid")||o.query("taid"),c=function(){y&&y.start(l.player,{vid:e,taid:p,term_id:l.term_id,agency_type:""+w,course_id:l.course_id,needSign:l.needSign,source:1===t?1:0})};c(),l.autoplay=function(){var t=s.indexOf(e),r=s.length;return r>1&&r-1>t?(e=s[++t],l.$emit("autoplay",e,i),a.vid=e,l.player.play(a),c(),!0):!1},l.multiVideo=s.length>0};window.Txplayer?d(window.Txplayer):l.loadTVP("//vm.gtimg.cn/tencentvideo/txp/js/txplayer.js",d)},txplayerPlay:function(e){this.player&&this.player.destroy(),this.player=null,this.player=new Txplayer(e),this.registEventListen(this.player),k=e,this.show()},registEventListen:function(e){e.videoOK=!1;var i=this;e.on("ready",function(){if(n(".txp_overlay_loading_content").hide(),"flash"!==e.getPlayerType()){T.show();var t=function(){1===e.getPlayerState()&&i.$emit("vplayer.paused")};n(".txp_btn_play").on("click",t),n(".txp_shadow").on("click",t)}}),e.on("playStateChange",function(t){switch(t.state){case-1:a();break;case 0:if(e.isWindowFullscreen())break;var o=!1;i.playend=!0,i.sethistory(!0),y&&y.stop(),i.$emit("vplayer.allend"),o=i.autoplay(),i.multiVideo||(i.$emit("vplayer.nexttask"),setTimeout(function(){i.hide()},20));break;case 1:e.videoOK||(e.videoOK=!0,i.playend=!1,x({action:"Play_clk"}),i.$emit("vplayer.videoOK"),f("播放成功总量",2722706)),"flash"!==e.getPlayerType()&&T.hide(),y&&y.start();break;case 2:i.sethistory(),y&&y.stop(),x({action:"Pause_clk"}),"flash"===e.getPlayerType()&&i.$emit("vplayer.paused"),r(i);break;case 3:"flash"!==e.getPlayerType()&&(n(".txp_overlay_loading").hide(),T.show());break;default:console.log("playStateChange other state",t)}}),e.on("windowFullscreenChange",function(e){e&&x({action:"FullScreen_clk"})}),e.on("timeupdate",function(){i.sethistory()}),e.on("error",function(e){i.handleError(e),i.isTryListen?f("试听失败",2563448):2===i.playType?f("录播失败",2563446):5===i.playType&&f("回放失败",2563447),g.isLogin()?e&&101===e.exem?f("录播鉴权失败（未报名）",2810132):(f("播放失败总量",2722707),m(2810287)):f("视频播放失败，用户未登录",2730167),e&&-700===e.code&&f("播放失败-700错误码",2722847),window.BJ_REPORT.info({msg:"tvpOnError, "+JSON.stringify(e),ext:{msid:2118575}}),x({action:"video_play_error",obj1:_,obj2:n.cookie.uin(),ver3:o.getUrlParam("vid"),ver5:JSON.stringify(e)}),i.$emit("vplayer.videoErr",e)}),e.on("showUIVipGuide",function(e){e&&e.trialFinish&&p.get("flash").trigger("showPay")})},handleError:function(){g.isLogin()||g.show()},loadTVP:function(e,i){var t=this;P(e,function(){i(window.Txplayer)},function(){var r="//vm.gtimg.cn/tencentvideo/txp/js/txplayer.js";e!=r?t.loadTVP(r,i):f("tvp 拉取失败",2893523)},function(){return window.Txplayer})},size:function(){var e=this.$header.outerWidth(),i=Math.max(n(window).height()-60,300);return n("body").css(window.innerHeight<=380?{"overflow-y":"auto"}:{"overflow-y":"hidden"}),{width:e,height:i}},resize:function(){var e=this.size();this.player&&this.player.resize&&this.player.resize(e)},sethistory:function(e){var i=this;e?u.remove(i.history_key):i.player&&i.player.getCurrentTime&&u.set(i.history_key,i.player.getCurrentTime())},gethistory:function(){return this.player&&this.player.getCurrentTime?this.player.getCurrentTime()||0:0},unplay:function(){var e=this;e.sethistory(),e.hide(),e.playing=!1,e.$el.innerHTML="",y&&y.stop()},pause:function(){this.playing=!1,this.player&&this.player.pause&&this.player.pause()},replay:function(){this.sethistory(!0),k.connectionPlayTime=0,this.txplayerPlay(k),this.resize()},show:function(){this.$set("isShow",!0),this.$emit("vplayer.show")},hide:function(){this.$emit("vplayer.hide"),this.player&&n.isFunction(this.player.destroy)&&this.player.destroy(),this.player=null,this.$set("isShow",!1),v.hide()}},ready:function(){var e=this;e.$header=n("#ke-header"),e.term_id=o.getHash("term_id")||o.query("term_id"),e.course_id=_,window.__tenplay_showPayTips=function(e){var i="(errCode: "+e.em+"."+e.exem+")";if(83===e.em)switch(e.exem){case 12:n.modal.alert("参数错误"+i);break;case 13:case 19:n.modal.alert("超时"+i);break;case 14:n.modal.alert("后台服务错误"+i);break;case 101:p.get("flash").trigger("showPay");break;case 107:n.modal.alert("课程不存在"+i);break;case 111:case 112:n.modal.alert("黑名单"+i);break;case 200:g.isLogin()?n.modal.alert("登录态失效，请退出重新登录"+i):(g.show(),f("视频播放失败，用户未登录",2730167));break;case 201:n.modal.alert("试听失败"+i);break;case 203:n.modal.alert("禁止下载"+i);break;default:n.modal.alert("播放失败"+i)}else e&&"previewover"===e.type?p.get("flash").trigger("showPay"):n.modal.alert("播放失败"+i)},n(window).on("resize",o.throttleV2(function(){e.playing&&e.resize()},20,50)).on("beforeunload",function(){!e.playend&&e.sethistory()}),x({action:"Exposure",ver1:e.course_id})}}});
define("pages/index/paused/main",function(e,t,o){"use strict";var s=e("lego_modules/local.data/0.0.1/local.data"),i=e("modules/lib/cookie"),n=e("jquery"),a=["有事走不开？手机也能轻松上课！","看电脑太累？走到哪学到哪！"],c=i.uin()+":paused_noMoreShow";o.exports={data:{isShow:!1,time:0,noMoreShow:!!s.get(c),noMoreShowSign:!1,qrcodeItem:0},methods:{show:function(e){this.$set({isShow:!0,time:e}),this.$emit("paused.show")},hide:function(){this.$set("isShow",!1)},close:function(){this.hide(),this.$emit("paused.close"),this.noMoreShowSign?(s.set(c,!0),this.$set("noMoreShow",!0),this.$emit("noMoreShow.enable")):(s.remove(c),this.$set("noMoreShow",!1))},setNoMoreShow:function(e){var t=e||window.event,o=t.target||t.srcElement,s=o.className.indexOf("checked");s>-1?o.className=o.className.replace(/\s*checked\s*/," ").replace(/\s*$/,""):o.className+=" checked",s=o.className.indexOf("checked")>-1,this.$set("noMoreShowSign",s)},switchItem:function(e){var t=0+n(e.target).data("index");t!==this.qrcodeItem&&this.$set("qrcodeItem",t)}},filters:{word:function(e){return 300>e?a[0]:a[1]},tabActive:function(e,t){return e===~~t}}}});
define("pages/index/error/main",function(r,e,s){"use strict";s.exports={data:{isShow:!1,errorMsg:"",errorCode:"",errorClassName:"",ERROR_TEXT:{NETWORK_ERROR:"您的网速不给力，请刷新试试哦",OTHER_ERROR:"抱歉，因系统出错无法播放视频，请刷新试试哦"}},filters:{},directives:{},methods:{show:function(r){this.$set("isShow",!0),r=r||{};var e=[14001,14002,14003,14004,15001,15002,15003,15104,11104,11106,11109,11204,17004,17005,17013,19004,19005,19013],s="OTHER_ERROR",t=r.errCode||"",o=t.split("."),i=parseInt(o[1]||0,10),R="error-container";-1!==e.indexOf(i)?(s="NETWORK_ERROR",R+=" network-error"):R+=" other-error";var n=this.ERROR_TEXT[s]||"";this.$set("errorClassName",R),this.$set("errorMsg",n),this.$set("errorCode",t)},hide:function(){this.$set("isShow",!1)}},ready:function(){}}});
define("pages/index/pagerecorded/main",function(e,r,t){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function s(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function i(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function n(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}var a=e("lego_modules/imweb-base-qjs/0.1.1/src/controller"),l=o(a),h=e("modules/lib/login"),d=e("lego_modules/observer/0.0.1/observer"),u=e("lego_modules/local.data/0.0.1/local.data"),c=e("modules/lib/util"),p=function(e){function r(){s(this,r);var t=i(this,e.call(this));return t.components={keVplayer:"#ke-vplayer",kePaused:"#ke-paused",keError:"#ke-error"},t}return n(r,e),r.prototype.init=function(e){this._init(e)},r.prototype._bindEvent=function(){var e=this;this.keVplayer.$on("autoplay",function(r,t){e.keHeader.$.playList.$set("currentVid",r),e.keHeader.$.playList.$set("currentTaid",t),$(".course-list-header, .part-title").removeClass("js-active"),$("#"+r).addClass("js-active"),e.keError&&e.keError.hide()}).$on("vplayer.videoErr",function(r){e.keError&&e.keError.show(r)}).$on("vplayer.show",function(r){e.keError&&e.keError.hide(r)}).$on("vplayer.hide",function(r){e.keError&&e.keError.hide(r)}).$on("vplayer.paused",function(){e.kePaused.show&&e.kePaused.show(this.gethistory())}).$on("vplayer.resumed",function(){e.kePaused.hide&&e.kePaused.hide(),e.keError&&e.keError.hide()}).$on("vplayer.allend",function(){var r=$(".js-course-list-header.js-active .js-expr-tag").length>0;r&&d.get("flash").trigger("showPay"),e.keError&&e.keError.hide()}).$on("vplayer.nexttask",function(){$(window).resize(),e.setStyle(),e.keCover.setShowNext(!0),e.keCover.show(),e.keError&&e.keError.hide()}),d.get("flash").listen("showPay",function(){e.keError&&e.keError.hide(),e.keVplayer.hide(),$(window).resize(),e.setStyle(),e.keCover.show(),e.keCover.setNotPay(!0);var r=$(".js-course-list-header.js-active .js-expr-tag").length>0,t=e.keCover.notPay;r&&e.reportIndex.exprReport(t,c.getUrlParam("vid"))})},r.prototype.setStyle=function(){var e=$("#ke-pagerecorded"),r=e.height(),t=e.width();this.keCover.setPlayerStyle({height:r+"px",width:t+"px"})},r.prototype.setVPlayer=function(){this.checkIsShowNotPay()?this.keVplayer.hide():(this.keVplayer.show(),this.keVplayer.$emit("vplayer.web2ReplayTime"))},r.prototype._storagePlayInfo=function(e,r){u.set(h.uin(),JSON.stringify({vid:e,taid:r}))},r}(l["default"]),y=new p;t.exports={data:{isShow:!1},filters:{},directives:{},methods:{show:function(e){var r=this;r.isShow||(r.$set("isShow",!0),y.term=e.term,y.taskInfo=e.taskInfo,y.courseInfo=e.courseInfo,y.courseId=e.courseId,y.termId=e.termId,y.reportIndex=e.reportIndex,y.reportEduLog=e.reportEduLog,y.checkIsShowNotPay=e.checkIsShowNotPay,y.keHeader=e.keHeader,y.keCover=e.keCover,y.setVPlayer())},hide:function(){this.$set("isShow",!1),this.keVplayer&&this.keVplayer.hide()}},ready:function(){y.init(this),this.keVplayer=y.keVplayer,this.kePaused=y.kePaused,this._storagePlayInfo=y._storagePlayInfo}}});
define("pages/index/exam/main",function(i,t,n){"use strict";n.exports={data:{isShow:!1,url:""},methods:{show:function(){this.$set("isShow",!0)},hide:function(){this.$set("isShow",!1)},setUrl:function(i){this.$set("url",i)}},filters:{},ready:function(){function i(){window.__exam_close=function(){}}i()}}});
define("pages/index/pageexam/main",function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=e("lego_modules/imweb-base-qjs/0.1.1/src/controller"),c=o(a),u=function(e){function t(){i(this,t);var n=r(this,e.call(this));return n.components={keExam:"#ke-exam"},n}return s(t,e),t.prototype.init=function(e){this._init(e)},t}(c["default"]),f=new u;n.exports={data:{isShow:!1},filters:{},directives:{},methods:{show:function(){this.$set("isShow",!0)},hide:function(){this.$set("isShow",!1)}},ready:function(){f.init(this),this.keExam=f.keExam}}});
define("pages/index/material/main",function(e,t,i){"use strict";var s=e("lego_modules/util.bom/0.0.1/util.bom");i.exports={data:{isShow:!1,file:null,name:"",type:"",url:"javascript:void(0);",hasNextTask:!1},methods:{show:function(){this.$set("isShow",!0)},hide:function(){this.$set("isShow",!1)},setFile:function(e,t){if(e){var i=this.getFileInfo(e),n=this.getNextDom();this.$set("name",i.name),this.$set("size",i.size),this.$set("type",i.type),this.$set("url",t),this.$set("file",e);var a=1===parseInt(s.query("client"));n&&n.length>0&&!a?this.$set("hasNextTask",!0):this.$set("hasNextTask",!1)}},getFileInfo:function(e){var t=/\.(\w+)$/,i=e.cw_name.match(t),s={};return i.length>1&&(s.type=i[1]),s.name="【资料】"+e.cw_name.replace(t,""),s.size=this.getFileSizeText(e.cw_size),s},getFileSizeText:function(e){if(e>1048576)return(e/1024/1024).toFixed(1)+"MB";var t=(e/1024).toFixed(1)+"KB";return"0.0KB"===t?"0.1KB":t},getNextDom:function(){var e=$("#play-list").find(".js-course-list-header"),t=!1,i=[];return $(e).each(function(e,s){var n;return $(s).hasClass("js-active")?(t=!0,!0):t?(n=~~$(s).attr("tasktype"),n?(i=$(s),!1):void 0):!0}),i},gotoNextTask:function(){var e=this.getNextDom();if(e&&e.next){var t=e.next();e&&e.triggerHandler&&e.triggerHandler("click"),t&&t.length>0&&"span"===t[0].tagName.toLowerCase()&&(e=t.find("span").eq(0),e&&e.triggerHandler&&e.triggerHandler("click"))}}},filters:{getFileInfoStr:function(){return"("+this.type+"，"+this.size+")"}},ready:function(){}}});
define("pages/index/pagematerial/main",function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=e("lego_modules/imweb-base-qjs/0.1.1/src/controller"),c=i(a),u=function(e){function t(){o(this,t);var n=r(this,e.call(this));return n.components={keMaterial:"#ke-material"},n}return s(t,e),t.prototype.init=function(e){this._init(e)},t}(c["default"]),f=new u;n.exports={data:{isShow:!1},filters:{},directives:{},methods:{show:function(){this.$set("isShow",!0)},hide:function(){this.$set("isShow",!1)}},ready:function(){f.init(this),this.keMaterial=f.keMaterial}}});
define("pages/index/guide/main",function(e,t,i){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=e("lego_modules/imweb-base-qjs/0.1.1/src/controller"),c=o(u),h=e("modules/lib/util.cookie"),a=e("lego_modules/local.data/0.0.1/local.data"),f=e("lego_modules/observer/0.0.1/observer"),l=e("modules/lib/platform"),d=function(e){function t(){return n(this,t),s(this,e.call(this))}return r(t,e),t.prototype.init=function(e){this._init(e)},t}(c["default"]),p=new d;i.exports={data:{isShow:!1,nowIndex:0,isShowPIP:!1},filters:{whichStep:function(e,t){return e===+t},isShowGuide:function(){return this.isShow||this.isShowPIP}},directives:{},methods:{show:function(){var e=h.uin();if(e){var t=a.get("guide-"+e)||!1;t||(this.$set("isShow",!0),a.set("guide-"+e,!0))}},hide:function(){this.$set("isShow",!1)},next:function(){var e=this.nowIndex;e++,2===e&&l.isMac()&&e++,e>4&&(e=4,this.hide(),f.get("guide").trigger("guide.over")),this.$set("nowIndex",e)},showPIP:function(){var e,t=this;if(this.isShow===!0)return void f.get("guide").one("guide.over",function(){t.showPIP()});if(e=h.uin()){var i=a.get("guide-pip-"+e)||!1;i||(a.set("guide-pip-"+e,!0),this.$set("isShowPIP",!0))}},nextPIP:function(){this.$set("isShowPIP",!1)}},ready:function(){var e=this;p.init(this),window.__keplayer_pip__=function(){e.showPIP()}}}});
define("components/dialogmsg/main",function(t,n,i){"use strict";i.exports={data:{isShow:!1,isShowCloseBtn:!0,head:"",title:"",content:"",cancelText:"",isShowCancelBtn:!1},filters:{},directives:{},methods:{closeWindow:function(){this.hide()},show:function(){this.$set("isShow",!0)},hide:function(){this.$set("isShow",!1)},dialogCancel:function(){this._dialogCancel&&this._dialogCancel()},setMsg:function(t,n,i,e,s){this.$set({head:t,title:n,content:i,cancelText:e}),this._dialogCancel=s},showCloseBtn:function(){this.$set("isShowCloseBtn",!0)},hideCloseBtn:function(){this.$set("isShowCloseBtn",!1)},showCancelBtn:function(){this.$set("isShowCancelBtn",!0)},hideCancelBtn:function(){this.$set("isShowCancelBtn",!1)}},ready:function(){}}});
